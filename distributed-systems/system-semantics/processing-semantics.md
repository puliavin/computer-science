# Processing Semantics (–°–µ–º–∞–Ω—Ç–∏–∫–∞ –û–±—Ä–∞–±–æ—Ç–∫–∏)

## –í–≤–µ–¥–µ–Ω–∏–µ

**Processing Semantics** (—Å–µ–º–∞–Ω—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏) ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –≥–∞—Ä–∞–Ω—Ç–∏–π –∏ —Å–≤–æ–π—Å—Ç–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–±—ã—Ç–∏—è –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç **Delivery Semantics** (—Å–µ–º–∞–Ω—Ç–∏–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏), –∫–æ—Ç–æ—Ä–∞—è —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ç–æ–º, *—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è*, processing semantics –æ–ø–∏—Å—ã–≤–∞–µ—Ç *–∫–∞–∫ –∏–º–µ–Ω–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è* –∫–∞–∂–¥–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞.

–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ? –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: –¥–∞–∂–µ –µ—Å–ª–∏ Kafka –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç exactly-once delivery, —ç—Ç–æ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–∞—à –∫–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–ø–∏—Å—ã–≤–∞–µ—Ç –¥–µ–Ω—å–≥–∏ —Å–æ —Å—á–µ—Ç–∞, —Ç–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ (retry –ø–æ—Å–ª–µ —Å–±–æ—è) –¥–µ–Ω—å–≥–∏ —Å–ø–∏—à—É—Ç—Å—è –¥–≤–∞–∂–¥—ã ‚Äî –µ—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ **idempotent** (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è).

–í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –º—ã —Ä–∞–∑–±–µ—Ä–µ–º –∫–ª—é—á–µ–≤—ã–µ —Ç–∏–ø—ã —Å–µ–º–∞–Ω—Ç–∏–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∏—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è.

---

## 1. Idempotent Processing (–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –û–±—Ä–∞–±–æ—Ç–∫–∞)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**Idempotent processing** (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞) ‚Äî —ç—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ–¥–Ω–∏–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É, —á—Ç–æ –∏ –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

–ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è: **"–°–¥–µ–ª–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑ = —Å–¥–µ–ª–∞—Ç—å N —Ä–∞–∑"**

### üéØ –ß—Ç–æ —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç

- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –°–∏—Å—Ç–µ–º—É –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏–π
- Retries (–ø–æ–≤—Ç–æ—Ä—ã) –Ω–µ —Å–æ–∑–¥–∞—é—Ç –ø—Ä–æ–±–ª–µ–º

### ‚ö†Ô∏è –ß—Ç–æ —ç—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç

- –ß—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑ (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑)
- –ß—Ç–æ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π (–ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- –ß—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä–æ–π –∏–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

**–ê–Ω–∞–ª–æ–≥–∏—è —Å –ª–∏—Ñ—Ç–æ–º**: –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—ã–∑–æ–≤–∞ –ª–∏—Ñ—Ç–∞ ‚Äî –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. –ù–∞–∂–∞–ª–∏ –æ–¥–∏–Ω —Ä–∞–∑ ‚Äî –ª–∏—Ñ—Ç –µ–¥–µ—Ç. –ù–∞–∂–∞–ª–∏ 10 —Ä–∞–∑ (–ø–æ–∫–∞ –∂–¥–µ—Ç–µ) ‚Äî –ª–∏—Ñ—Ç –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—Ä–∏–µ–¥–µ—Ç –æ–¥–∏–Ω —Ä–∞–∑. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π.

**–ü—Ä–∏–º–µ—Ä 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞**
- –°–æ–æ–±—â–µ–Ω–∏–µ: "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ #12345 = 'DELIVERED'"
- –ü–µ—Ä–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è PENDING ‚Üí DELIVERED
- –í—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (retry): —Å—Ç–∞—Ç—É—Å –æ—Å—Ç–∞–µ—Ç—Å—è DELIVERED
- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–¥–µ–Ω—Ç–∏—á–µ–Ω: —Å—Ç–∞—Ç—É—Å = DELIVERED

**–ü—Ä–∏–º–µ—Ä 2: –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID**
- –°–æ–æ–±—â–µ–Ω–∏–µ: "–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Å—á–µ—Ç userId=100 –Ω–∞ 1000‚ÇΩ, transactionId=abc-123"
- –ü–µ—Ä–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: –±–∞–ª–∞–Ω—Å 5000‚ÇΩ ‚Üí 6000‚ÇΩ, –∑–∞–ø–∏—Å—ã–≤–∞–µ–º transactionId –≤ —Ç–∞–±–ª–∏—Ü—É –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –í—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: –ø—Ä–æ–≤–µ—Ä—è–µ–º transactionId –≤ —Ç–∞–±–ª–∏—Ü–µ ‚Üí —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω ‚Üí –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–∞–ª–∞–Ω—Å 6000‚ÇΩ (–Ω–µ 7000‚ÇΩ)

**–ü—Ä–∏–º–µ—Ä 3: HTTP PUT vs POST**
- `PUT /users/123 {"name": "Ivan"}` ‚Äî –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–º—è)
- `POST /users {"name": "Ivan"}` ‚Äî –ù–ï –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ (—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–æ–≤—ã–π ID)

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –î–≤–æ–π–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ**
- –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "—Å–ø–∏—Å–∞—Ç—å 100‚ÇΩ —Å –∫–∞—Ä—Ç—ã"
- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç network timeout –ø–æ—Å–ª–µ —Å–ø–∏—Å–∞–Ω–∏—è, –Ω–æ –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- Kafka –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ (at-least-once delivery)
- –°–∏—Å—Ç–µ–º–∞ —Å–ø–∏—Å—ã–≤–∞–µ—Ç –µ—â–µ 100‚ÇΩ
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ—Ç–µ—Ä—è–ª 200‚ÇΩ –≤–º–µ—Å—Ç–æ 100‚ÇΩ

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**
- –°–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ email –Ω–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω
- –ü—Ä–∏ retry –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç 5 –∫–æ–ø–∏–π –æ–¥–Ω–æ–≥–æ –ø–∏—Å—å–º–∞
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –∂–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–∞, –ø–æ–ø–∞–¥–∞–Ω–∏–µ –≤ —Å–ø–∞–º

### –ö–∞–∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É

**–ü–æ–¥—Ö–æ–¥ 1: Deduplication table (—Ç–∞–±–ª–∏—Ü–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏)**
- –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
- –ü–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–≤–µ—Ä—è–µ–º: –±—ã–ª –ª–∏ —ç—Ç–æ—Ç ID —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω?
- –ï—Å–ª–∏ –¥–∞ ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º ID

```
–ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏:
1. –ù–∞—á–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
2. SELECT * FROM processed_messages WHERE message_id = 'abc-123'
3. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí COMMIT –∏ –≤—ã—Ö–æ–¥
4. –í—ã–ø–æ–ª–Ω–∏—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
5. INSERT INTO processed_messages (message_id) VALUES ('abc-123')
6. COMMIT
```

**–ü–æ–¥—Ö–æ–¥ 2: Natural idempotency (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)**
- –û–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ —Å–≤–æ–µ–π –ø—Ä–∏—Ä–æ–¥–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã
- –ü—Ä–∏–º–µ—Ä—ã: SET –∑–Ω–∞—á–µ–Ω–∏—è, UPDATE —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º (–Ω–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º)
- Redis: `SET user:123:status "active"` ‚Äî –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ
- SQL: `UPDATE orders SET status = 'COMPLETED' WHERE id = 123` ‚Äî –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ

**–ü–æ–¥—Ö–æ–¥ 3: Conditional updates (—É—Å–ª–æ–≤–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∂–∏–¥–∞–µ–º–æ–µ
- SQL: `UPDATE orders SET status = 'SHIPPED' WHERE id = 123 AND status = 'PAID'`
- –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å —É–∂–µ SHIPPED ‚Äî –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è (0 rows affected)

**–ü–æ–¥—Ö–æ–¥ 4: Compare-and-swap (CAS)**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Redis, Cassandra
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –æ–∂–∏–¥–∞–µ–º—ã–º
- Redis: `SET user:balance 6000 XX GET` (–æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª—é—á —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã —Å–±–æ–µ–≤

1. **Network retries** ‚Äî —Ç–∞–π–º–∞—É—Ç —Å–µ—Ç–∏ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –Ω–æ –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
2. **Process crashes** ‚Äî –ø—Ä–æ—Ü–µ—Å—Å —É–ø–∞–ª –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏, –Ω–æ –¥–æ –∫–æ–º–º–∏—Ç–∞ offset –≤ Kafka
3. **Rebalancing** ‚Äî –≤ Kafka consumer rebalance –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ
4. **Manual replays** ‚Äî –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –ö–æ–≥–¥–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–∞

- ‚úÖ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø–ª–∞—Ç–µ–∂–∏, –ø–µ—Ä–µ–≤–æ–¥—ã)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –≤ e-commerce
- ‚úÖ –°–∏—Å—Ç–µ–º—ã —É—á–µ—Ç–∞ (inventory, —Å–∫–ª–∞–¥—ã)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (–∑–∞–∫–∞–∑–æ–≤, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

### –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ (–Ω–µ–±–æ–ª—å—à–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –¥–æ–ø—É—Å—Ç–∏–º–∞)
- Cache warming (–ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- Best-effort –æ–ø–µ—Ä–∞—Ü–∏–∏

---

## 2. Non-Idempotent Processing (–ù–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –û–±—Ä–∞–±–æ—Ç–∫–∞)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**Non-idempotent processing** (–Ω–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞) ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã, –æ—Ç–ª–∏—á–Ω—ã–µ –æ—Ç –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: **"–°–¥–µ–ª–∞—Ç—å –¥–≤–∞–∂–¥—ã ‚â† —Å–¥–µ–ª–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑"**

### üéØ –ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç

- –ö–∞–∂–¥–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —ç—Ñ—Ñ–µ–∫—Ç
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –¢—Ä–µ–±—É–µ—Ç—Å—è –æ—Å–æ–±–∞—è –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏ retries

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

**–ê–Ω–∞–ª–æ–≥–∏—è —Å –ø–æ–∫—É–ø–∫–æ–π –±–∏–ª–µ—Ç–∞**
- –ö–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–∞–∂–∏–º–∞—è "–ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç", –≤—ã –ø–æ–∫—É–ø–∞–µ—Ç–µ –ù–û–í–´–ô –±–∏–ª–µ—Ç
- –ù–∞–∂–∞–ª–∏ –ø–æ –æ—à–∏–±–∫–µ 3 —Ä–∞–∑–∞ ‚Üí –∫—É–ø–∏–ª–∏ 3 –±–∏–ª–µ—Ç–∞
- –≠—Ç–æ –Ω–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

**–ü—Ä–∏–º–µ—Ä 1: –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞**
- –û–ø–µ—Ä–∞—Ü–∏—è: `UPDATE stats SET page_views = page_views + 1 WHERE page = 'home'`
- –ü–µ—Ä–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: 100 ‚Üí 101
- –í—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: 101 ‚Üí 102
- –ö–∞–∂–¥—ã–π retry –¥–æ–±–∞–≤–ª—è–µ—Ç +1

**–ü—Ä–∏–º–µ—Ä 2: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞**
- POST –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑
- –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞: —Å–æ–∑–¥–∞–Ω –∑–∞–∫–∞–∑ #001
- Retry (–∏–∑-–∑–∞ timeout): —Å–æ–∑–¥–∞–Ω –∑–∞–∫–∞–∑ #002
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 2 –∑–∞–∫–∞–∑–∞ –≤–º–µ—Å—Ç–æ 1

**–ü—Ä–∏–º–µ—Ä 3: –û—Ç–ø—Ä–∞–≤–∫–∞ SMS**
- –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ API –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é SMS
- Retry ‚Üí –¥—É–±–ª–∏—Ä—É—é—â–∞—è—Å—è SMS
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä 4: Append to log**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥-—Ñ–∞–π–ª
- –ö–∞–∂–¥—ã–π retry –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–µ

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ú–∞—Å—Å–æ–≤–æ–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤**
- E-commerce –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π "–∫–æ—Ä–∑–∏–Ω–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞"
- Network glitch –≤—ã–∑–≤–∞–ª –º–∞—Å—Å–æ–≤—ã–µ retries
- –ö–∞–∂–¥—ã–π retry —Å–æ–∑–¥–∞–≤–∞–ª –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 10,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–ª—É—á–∏–ª–∏ –ø–æ 2-5 –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∑–∞–∫–∞–∑–æ–≤
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç—ã, –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ö–∞–æ—Å, –ø–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: SMS-–±–æ–º–±–∞—Ä–¥–∏—Ä–æ–≤–∫–∞**
- –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —É–ø–∞–ª –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª—Å—è
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –Ω–∞—á–∞–ª –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞–Ω–æ–≤–æ (offset –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è)
- –ù–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ SMS
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 50,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–ª—É—á–∏–ª–∏ –ø–æ 3-4 SMS —Å –∫–æ–¥–æ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ SMS-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º, –∂–∞–ª–æ–±—ã, —Ä–∞—Å—Ö–æ–¥—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ü–µ—Ä–µ–ø–ª–∞—Ç–∞ –∫–æ–º–∏—Å—Å–∏–π**
- –°–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∫–æ–º–∏—Å—Å–∏–π –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º
- –û–ø–µ—Ä–∞—Ü–∏—è: "–ù–∞—á–∏—Å–ª–∏—Ç—å 5% –æ—Ç —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂–∏"
- Kafka consumer –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª—Å—è –±–µ–∑ –∫–æ–º–º–∏—Ç–∞ offset
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º –Ω–∞—á–∏—Å–ª–∏–ª–∏ –∫–æ–º–∏—Å—Å–∏–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏, —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Å–ø–æ—Ä—ã

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—É—é**
- –î–æ–±–∞–≤–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º: "—É–∂–µ –¥–µ–ª–∞–ª–∏?"
- –ü—Ä–∏–º–µ—Ä: `POST /orders` —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Idempotency-Key: abc-123`

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: Exactly-once —Å–µ–º–∞–Ω—Ç–∏–∫–∞**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ Kafka (Kafka transactions)
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑
- –°–ª–æ–∂–Ω–µ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 3: Manual deduplication**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –≤—Ä—É—á–Ω—É—é
- –¢—Ä–µ–±—É–µ—Ç —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 4: Compensating transactions (–∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)**
- –ï—Å–ª–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –ª–∏—à–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü—Ä–∏–º–µ—Ä: –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –∑–∞–∫–∞–∑–æ–≤ –∏ –æ—Ç–º–µ–Ω–∏—Ç—å –∏—Ö
- –°–ª–æ–∂–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º

1. **At-least-once delivery** –≤ Kafka/RabbitMQ
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ deduplication** –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
3. **–ù–µ—Ç Idempotency-Key** –≤ API
4. **Network timeouts** –±–µ–∑ proper retry logic
5. **Process crashes** –º–µ–∂–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∏ –∫–æ–º–º–∏—Ç–æ–º

### –ö–æ–≥–¥–∞ –Ω–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–æ–ø—É—Å—Ç–∏–º–∞

- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–º–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –Ω–µ–±–æ–ª—å—à—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å)
- –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- Best-effort —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–ª—É—á—à–µ –¥–≤–∞–∂–¥—ã, —á–µ–º –Ω–æ–ª—å —Ä–∞–∑)

### –ö–æ–≥–¥–∞ –Ω–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–ø–∞—Å–Ω–∞

- ‚ùå –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚ùå –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞–∫–∞–∑—ã)
- ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è/—Å–∫–ª–∞–¥—Å–∫–∏—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤
- ‚ùå –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞–º

---

## 3. Deterministic Processing (–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –û–±—Ä–∞–±–æ—Ç–∫–∞)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**Deterministic processing** (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞) ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–æ—Ä—è–¥–∫–∞ –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ø—ã—Ç–æ–∫.

–ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø: **"–¢–æ—Ç –∂–µ –≤—Ö–æ–¥ ‚Üí —Ç–æ—Ç –∂–µ –≤—ã—Ö–æ–¥"**

### üéØ –ß—Ç–æ —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç

- –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å replay (–ø–µ—Ä–µ–∏–≥—Ä–∞—Ç—å) –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª—É—á–∏–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)

### ‚ö†Ô∏è –ß—Ç–æ —ç—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç

- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–π)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ side effects (–≤–Ω–µ—à–Ω–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤)
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

**–ê–Ω–∞–ª–æ–≥–∏—è —Å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–º**
- –í–≤–æ–¥–∏—Ç–µ "2 + 2" ‚Äî –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç–µ "4"
- –ù–µ –≤–∞–∂–Ω–æ –∫–æ–≥–¥–∞, –≥–¥–µ, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π
- –≠—Ç–æ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

**–ü—Ä–∏–º–µ—Ä 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –í—Ö–æ–¥: email = "invalid-email"
- –û–±—Ä–∞–±–æ—Ç–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º
- –í—ã—Ö–æ–¥: –≤—Å–µ–≥–¥–∞ "–Ω–µ–≤–∞–ª–∏–¥–Ω–æ"
- –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫

**–ü—Ä–∏–º–µ—Ä 2: –†–∞—Å—á–µ—Ç —Å—É–º–º—ã –∑–∞–∫–∞–∑–∞**
- –í—Ö–æ–¥: `[{price: 100, qty: 2}, {price: 50, qty: 1}]`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: `sum(item.price * item.qty)`
- –í—ã—Ö–æ–¥: –≤—Å–µ–≥–¥–∞ 250
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç

**–ü—Ä–∏–º–µ—Ä 3: –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–æ–ª—å—é**
- –í—Ö–æ–¥: –ø–∞—Ä–æ–ª—å "password123" + —Å–æ–ª—å –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è "salt456"
- –û–±—Ä–∞–±–æ—Ç–∫–∞: `SHA256(password + salt)`
- –í—ã—Ö–æ–¥: –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ö–µ—à
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ (–Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–ª—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–ª—É—á–∞–π–Ω–æ–π!)

**–ü—Ä–∏–º–µ—Ä 4: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –í—Ö–æ–¥ JSON: `{"name": "IVAN"}`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: lowercase + trim
- –í—ã—Ö–æ–¥: `{"name": "ivan"}`
- –í—Å–µ–≥–¥–∞ —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä—ã (–Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏**
- –û–ø–µ—Ä–∞—Ü–∏—è: "–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ —Å timestamp = NOW()"
- –ü–µ—Ä–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–≤ 10:00): `{orderId: 1, timestamp: "2025-01-15T10:00:00"}`
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–≤ 10:05): `{orderId: 1, timestamp: "2025-01-15T10:05:00"}`
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–∑–Ω—ã–µ!

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ ID**
- –û–ø–µ—Ä–∞—Ü–∏—è: "–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å ID = UUID()"
- –ö–∞–∂–¥–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π UUID
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä 3: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–π —Å–∏—Å—Ç–µ–º—ã**
- –û–ø–µ—Ä–∞—Ü–∏—è: "–ü–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å –≤–∞–ª—é—Ç—ã –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API –∏ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É"
- –ö—É—Ä—Å –≤–∞–ª—é—Ç—ã –º–µ–Ω—è–µ—Ç—Å—è ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–µ–Ω—è–µ—Ç—Å—è
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è)

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä 4: –ü–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ HashMap**
- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —è–∑—ã–∫–∞—Ö –ø–æ—Ä—è–¥–æ–∫ –ø–µ—Ä–µ–±–æ—Ä–∞ HashMap –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω
- –û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–æ—Ä—è–¥–∫–∞ ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ù–µ—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–ø–ª–∏–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö**
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ë–î —Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π
- –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `RAND()` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID
- Master –∏ replica –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏ —Ä–∞–∑–Ω—ã–µ ID –ø—Ä–∏ replay
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ä–µ–ø–ª–∏–∫–∞—Ö —Ä–∞—Å—Ö–æ–¥–∏–ª–∏—Å—å
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–ø–ª–∏–∫–∏ –¥–ª—è —á—Ç–µ–Ω–∏—è

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ù–µ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–µ –±–∞–≥–∏**
- Bug –≤ production, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö
- –ü—Ä–∏—á–∏–Ω–∞: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–∏—Å–µ–ª–∞ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- –í —Ç–µ—Å—Ç–∞—Ö –≤—Ä–µ–º—è = "–º–æ–∫–æ–≤–æ–µ", –≤ production = —Ä–µ–∞–ª—å–Ω–æ–µ
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –Ω–µ–¥–µ–ª–∏ –æ—Ç–ª–∞–¥–∫–∏, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –†–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏ replay Kafka**
- Event sourcing —Å–∏—Å—Ç–µ–º–∞
- –ü—Ä–∏ replay —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—É—á–∞–ª–∏ –¥—Ä—É–≥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –ü—Ä–∏—á–∏–Ω–∞: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `System.currentTimeMillis()`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö, downtime

### –ö–∞–∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É

**–ü—Ä–∏–Ω—Ü–∏–ø 1: –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏**
- Timestamp, ID, —Å–ª—É—á–∞–π–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–∞–º–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ù–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
- –ü—Ä–∏–º–µ—Ä: —Å–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `{"timestamp": "2025-01-15T10:00:00", "orderId": "abc-123"}`

**–ü—Ä–∏–Ω—Ü–∏–ø 2: –ò–∑–±–µ–≥–∞—Ç—å –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏**
- –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `NOW()`, `CURRENT_TIMESTAMP`, `System.currentTimeMillis()`
- –ë—Ä–∞—Ç—å timestamp –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—Ä–µ–º—è ‚Äî producer –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è

**–ü—Ä–∏–Ω—Ü–∏–ø 3: –ò–∑–±–µ–≥–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**
- UUID, random numbers ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ producer, –Ω–µ consumer
- –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å seed –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏)

**–ü—Ä–∏–Ω—Ü–∏–ø 4: –ò–∑–±–µ–≥–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º**
- –ù–µ –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º API –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫—É—Ä—Å—ã –≤–∞–ª—é—Ç, —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏) ‚Äî –≤ —Å–∞–º–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
- –ò–ª–∏: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å snapshot –≤–Ω–µ—à–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏

**–ü—Ä–∏–Ω—Ü–∏–ø 5: –Ø–≤–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏**
- –ï—Å–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Å —è–≤–Ω—ã–º–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏
- –ù–µ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ (HashMap iteration)

**–ü—Ä–∏–Ω—Ü–∏–ø 6: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏**
- –í–∫–ª—é—á–∞—Ç—å –≤–µ—Ä—Å–∏—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ü—Ä–∏ replay –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ –≤–µ—Ä—Å–∏—é –ª–æ–≥–∏–∫–∏
- –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –¥–∞–∂–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞

### –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º vs –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

| –°–≤–æ–π—Å—Ç–≤–æ | –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º | –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å |
|----------|-------------|-----------------|
| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ | –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –≤—Ö–æ–¥ ‚Üí –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –≤—ã—Ö–æ–¥ | –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ = –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–º—É |
| –§–æ–∫—É—Å | –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ |
| –ü—Ä–∏–º–µ—Ä | `sum([1,2,3])` –≤—Å–µ–≥–¥–∞ –¥–∞—Å—Ç 6 | `SET status='ACTIVE'` –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑ |
| –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º? | ‚úÖ –î–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç) | ‚ùå –ù–µ—Ç |
| –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º? | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å —Å `NOW()`) |

**–ü—Ä–∏–º–µ—Ä –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π, –Ω–æ –Ω–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- `counter += input.value` (–≥–¥–µ input.value –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏)
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ: –ø—Ä–∏ —Ç–æ–º –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–∏ –≤—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –ù–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ: –∫–∞–∂–¥–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫

**–ü—Ä–∏–º–µ—Ä –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–π, –Ω–æ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- `SET user:timestamp = NOW()` —Å deduplication –ø–æ message ID
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ: –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å —Ç–µ–º –∂–µ message ID –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ: –µ—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–Ω–æ–≤–æ (–Ω–æ–≤—ã–π message ID), –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥—Ä—É–≥–∏–º

### –ö–æ–≥–¥–∞ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –∫—Ä–∏—Ç–∏—á–µ–Ω

- ‚úÖ Event sourcing (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ —Å–æ–±—ã—Ç–∏–π)
- ‚úÖ –†–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ë–î (master-slave)
- ‚úÖ Distributed ledgers (blockchain)
- ‚úÖ –ê—É–¥–∏—Ç –∏ compliance (–Ω—É–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –ø—Ä–æ—à–ª—ã–µ —Ä–∞—Å—á–µ—Ç—ã)
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω—É–∂–Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å)

### –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞

- –õ–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏ (timestamp –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è)
- Cache invalidation (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏)
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –≥–¥–µ replay –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

---

## 4. Non-Deterministic Processing (–ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –û–±—Ä–∞–±–æ—Ç–∫–∞)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**Non-deterministic processing** (–Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞) ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å —Ç–µ–º–∏ –∂–µ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑-–∑–∞ –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤: –≤—Ä–µ–º–µ–Ω–∏, —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏, —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º.

–ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫: **"–¢–æ—Ç –∂–µ –≤—Ö–æ–¥ ‚Üí —Ä–∞–∑–Ω—ã–µ –≤—ã—Ö–æ–¥—ã"**

### üéØ –ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç

- –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ—á–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ replay
- –£—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ç—Ä—É–¥–Ω–æ—É–ª–æ–≤–∏–º—ã—Ö –±–∞–≥–æ–≤

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

**–ê–Ω–∞–ª–æ–≥–∏—è —Å –ø—Ä–æ–≥–Ω–æ–∑–æ–º –ø–æ–≥–æ–¥—ã**
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç–µ "–ü–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ"
- –í –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: "+5¬∞C, –æ–±–ª–∞—á–Ω–æ"
- –í –ø—è—Ç–Ω–∏—Ü—É: "-10¬∞C, —Å–Ω–µ–≥"
- –¢–æ—Ç –∂–µ –∑–∞–ø—Ä–æ—Å ‚Üí —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ)

**–ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π timestamp**
- –°–æ–æ–±—â–µ–Ω–∏–µ: `{"userId": 123, "items": [...]}`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `createdAt = NOW()`
- –ü–µ—Ä–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (10:00): `{orderId: 1, createdAt: "2025-01-15T10:00:00"}`
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (10:05): `{orderId: 1, createdAt: "2025-01-15T10:05:00"}`
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ

**–ü—Ä–∏–º–µ—Ä 2: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API**
- –°–æ–æ–±—â–µ–Ω–∏–µ: `{"address": "Moscow, Red Square"}`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: –∑–∞–ø—Ä–æ—Å –∫ –≥–µ–æ–∫–æ–¥–∏–Ω–≥ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- –°–µ–≥–æ–¥–Ω—è: `{lat: 55.7539, lon: 37.6208}`
- –ß–µ—Ä–µ–∑ –≥–æ–¥ (API –æ–±–Ω–æ–≤–∏–ª—Å—è): `{lat: 55.7540, lon: 37.6209}` (—á—É—Ç—å —Ç–æ—á–Ω–µ–µ)
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ

**–ü—Ä–∏–º–µ—Ä 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è UUID**
- –°–æ–æ–±—â–µ–Ω–∏–µ: `{"username": "ivan"}`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å `id = UUID()`
- –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞: `id = "123e4567-e89b-12d3-a456-426614174000"`
- Retry: `id = "987fcdeb-51a2-43f7-8c9d-123456789abc"`
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ

**–ü—Ä–∏–º–µ—Ä 4: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º**
- –î–∞–Ω–Ω—ã–µ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∫–ª—é—á–∞–º–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å —Ä–∞–∑–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ

**–ü—Ä–∏–º–µ—Ä 5: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫—É—Ä—Å–∞ –≤–∞–ª—é—Ç—ã**
- –°–æ–æ–±—â–µ–Ω–∏–µ: `{"amountUSD": 100}`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä—É–±–ª–∏ –ø–æ —Ç–µ–∫—É—â–µ–º—É –∫—É—Ä—Å—É –¶–ë
- –°–µ–≥–æ–¥–Ω—è (–∫—É—Ä—Å 75): `{amountRUB: 7500}`
- –ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é (–∫—É—Ä—Å 80): `{amountRUB: 8000}`
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞

**1. –í—Ä–µ–º—è (Time)**
- `NOW()`, `CURRENT_TIMESTAMP`, `System.currentTimeMillis()`
- TTL, expiration –ø—Ä–æ–≤–µ—Ä–∫–∏
- Timezone-–∑–∞–≤–∏—Å–∏–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**2. –°–ª—É—á–∞–π–Ω–æ—Å—Ç—å (Randomness)**
- `RANDOM()`, `UUID()`, `Math.random()`
- –°–ª—É—á–∞–π–Ω—ã–µ seed –±–µ–∑ —Ñ–∏–∫—Å–∞—Ü–∏–∏
- Shuffle –±–µ–∑ —è–≤–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞

**3. –í–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (External systems)**
- HTTP API calls (–¥–∞–Ω–Ω—ã–µ –º–µ–Ω—è—é—Ç—Å—è)
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏)
- –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
- –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã (payment gateways, –≥–µ–æ–∫–æ–¥–∏–Ω–≥)

**4. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º (Concurrency)**
- Race conditions
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç timing

**5. –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Environment state)**
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –í–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ (–µ—Å–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è)

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ retry**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è `userId = UUID()`
- –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞: —Å–æ–∑–¥–∞–Ω user —Å id="aaa", –∑–∞—Ç–µ–º timeout
- Retry: —Å–æ–∑–¥–∞–Ω user —Å id="bbb" (–Ω–æ–≤—ã–π UUID!)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¥–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º email
- **–ü—Ä–∏—á–∏–Ω–∞**: –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ID
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –ø—Ä–æ–±–ª–µ–º—ã —Å –ª–æ–≥–∏–Ω–æ–º, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∞–∑–µ

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –∏–∑-–∑–∞ –∫—É—Ä—Å–∞ –≤–∞–ª—é—Ç**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –≤ USD —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –≤ RUB
- –ü—Ä–∏ retry –∫—É—Ä—Å –≤–∞–ª—é—Ç—ã –∏–∑–º–µ–Ω–∏–ª—Å—è
- –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞: 100 USD = 7500 RUB
- Retry: 100 USD = 8000 RUB
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—É–¥–∏—Ç–æ–º, –Ω–∞–ª–æ–≥–æ–≤–æ–π

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ù–µ—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Ä–µ–ø–ª–µ–π–µ —Å–æ–±—ã—Ç–∏–π**
- Event sourcing —Å–∏—Å—Ç–µ–º–∞
- –°–æ–±—ã—Ç–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥—ã, –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ü—Ä–∏ replay –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º —Å–∏—Å—Ç–µ–º–∞–º
- –í–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å ‚Üí –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: "–º–∞–≥–∏—á–µ—Å–∫–∏–µ" –±–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –ø–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–æ–º

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: Capture inputs (–∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)**
- Producer –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ
- Timestamp –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è producer'–æ–º, –Ω–µ consumer'–æ–º
- –í–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ (–∫—É—Ä—Å—ã –≤–∞–ª—é—Ç, –≥–µ–æ–¥–∞–Ω–Ω—ã–µ) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–æ–±—ã—Ç–∏–∏

```
–ü–ª–æ—Ö–æ (–Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ):
{"command": "convert", "amount": 100, "currency": "USD"}
‚Üí consumer —Å–∞–º –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫—É—Ä—Å

–•–æ—Ä–æ—à–æ (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ):
{"command": "convert", "amount": 100, "currency": "USD",
 "rate": 75.5, "timestamp": "2025-01-15T10:00:00Z"}
‚Üí –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: Deterministic IDs**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é ID
- –ü—Ä–∏–º–µ—Ä: `ID = hash(userId + timestamp + sequenceNumber)`
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã hash –±–µ—Ä—É—Ç—Å—è –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 3: Snapshot external state**
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å snapshot —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
- –ü—Ä–∏–º–µ—Ä: –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Å–æ–±—ã—Ç–∏–µ
- –ü—Ä–∏ replay –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 4: Command-Query separation**
- –ö–æ–º–∞–Ω–¥—ã (writes) ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã
- –ó–∞–ø—Ä–æ—Å—ã (reads) ‚Äî –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏, –Ω–æ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –í–Ω–µ—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã –¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 5: Accept non-determinism**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–ª—É—á–∞–∏: timestamp –æ–±—Ä–∞–±–æ—Ç–∫–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏
- –í–∞–∂–Ω–æ: —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –≤–ª–∏—è—Ç—å –Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
- –ü—Ä–∏–º–µ—Ä: –º–æ–∂–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, –Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ timestamp –∏–∑ —Å–æ–±—ã—Ç–∏—è

### –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –≤ —Ä–∞–∑–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞—Ö

**Event Sourcing**
- –¢—Ä–µ–±—É–µ—Ç —Å—Ç—Ä–æ–≥–æ–≥–æ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞
- –°–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º = –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**Stream Processing (Kafka Streams, Flink)**
- –ñ–µ–ª–∞—Ç–µ–ª–µ–Ω –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –¥–ª—è exactly-once semantics
- –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º —É—Å–ª–æ–∂–Ω—è–µ—Ç –æ—Ç–ª–∞–¥–∫—É –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç "process time" vs "event time"

**CQRS (Command Query Responsibility Segregation)**
- Commands ‚Äî –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏
- Queries ‚Äî –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ (read models)

**Microservices**
- –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—ã–µ –≤—ã–∑–æ–≤—ã ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞
- –°—Ç—Ä–∞—Ç–µ–≥–∏—è: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–∑–æ–≤–æ–≤ –≤ —Å–æ–±—ã—Ç–∏—è
- –ò–ª–∏: –¥–µ–ª–∞—Ç—å –≤—ã–∑–æ–≤—ã –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏ —Å deduplication

### –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è: –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞ –∏ —Ä–µ—à–µ–Ω–∏—è

| –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|----------|---------|
| `NOW()` | –†–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–∞—Ö | Timestamp –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ—Ç producer |
| `UUID()` | –†–∞–∑–Ω—ã–µ ID –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–∞—Ö | –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ID –∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ ID –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ |
| –í–Ω–µ—à–Ω–∏–π API | –î–∞–Ω–Ω—ã–µ –º–µ–Ω—è—é—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º | Snapshot —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —Å–æ–±—ã—Ç–∏–µ |
| Random() | –†–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è | –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π seed –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ |
| DB state | –°–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î –º–µ–Ω—è–µ—Ç—Å—è | –í–∫–ª—é—á–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–±—ã—Ç–∏–µ |
| Race conditions | –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ | –£–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏–µ –∏–ª–∏ partition key –≤ Kafka |

### –ö–æ–≥–¥–∞ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –¥–æ–ø—É—Å—Ç–∏–º

- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (timestamp –æ–±—Ä–∞–±–æ—Ç–∫–∏)
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (approximate ‚Äî –¥–æ–ø—É—Å—Ç–∏–º–æ)
- ‚úÖ Cache warming (—Ç–æ—á–Ω–æ—Å—Ç—å –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞)
- ‚úÖ Best-effort –æ–ø–µ—Ä–∞—Ü–∏–∏

### –ö–æ–≥–¥–∞ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –æ–ø–∞—Å–µ–Ω

- ‚ùå Event sourcing (–Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω replay)
- ‚ùå –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ —Ä–µ–ø–ª–∏–∫)
- ‚ùå –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã (–ø—Ä–æ–±–ª–µ–º—ã —Å –∞—É–¥–∏—Ç–æ–º)
- ‚ùå Compliance –∏ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–∏–∫–∞ (–Ω–µ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å)

---

## 5. Replayable Processing (–ü–µ—Ä–µ–∏–≥—Ä—ã–≤–∞–µ–º–∞—è –û–±—Ä–∞–±–æ—Ç–∫–∞)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**Replayable processing** (–ø–µ—Ä–µ–∏–≥—Ä—ã–≤–∞–µ–º–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞) ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ –∂–µ —Å–∞–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è/—Å–æ–±—ã—Ç–∏—è –∏ –ø–æ–ª—É—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∏ –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. Replay (–ø–µ—Ä–µ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ) –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ—è, –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤ –∏–ª–∏ –∞—É–¥–∏—Ç–∞.

–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è: **"–ú–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–Ω–æ–≤–æ"**

### üéØ –ß—Ç–æ —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç

- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –±–∞–≥–æ–≤ (–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–Ω–æ–≤–æ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ read models –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π
- –ê—É–¥–∏—Ç –∏ compliance (–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏)

### ‚ö†Ô∏è –ß—Ç–æ —ç—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç

- –ß—Ç–æ replay –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä—ã–º (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è)
- –ß—Ç–æ external side effects –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—Å—è (email, –ø–ª–∞—Ç–µ–∂–∏)
- –ß—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –ø–æ–±–∏—Ç–æ–≤–æ –∏–¥–µ–Ω—Ç–∏—á–µ–Ω (–Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º)

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

**–ê–Ω–∞–ª–æ–≥–∏—è —Å –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å—å—é —Ñ—É—Ç–±–æ–ª—å–Ω–æ–≥–æ –º–∞—Ç—á–∞**
- –ú–∞—Ç—á –±—ã–ª —Å—ã–≥—Ä–∞–Ω –≤—á–µ—Ä–∞
- –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å—å —Å–µ–≥–æ–¥–Ω—è, –∑–∞–≤—Ç—Ä–∞, —á–µ—Ä–µ–∑ –≥–æ–¥
- –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ –±—É–¥–µ—Ç —Ç–æ—Ç –∂–µ (replay –≤–æ–∑–º–æ–∂–µ–Ω)
- –ù–æ: –Ω–µ –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞ (side effects –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è)

**–ü—Ä–∏–º–µ—Ä 1: Event Sourcing ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–∫–∞–∑–∞**
- –°–æ–±—ã—Ç–∏—è: `[OrderCreated, ItemAdded, ItemAdded, OrderPaid, OrderShipped]`
- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–æ–≤–æ–π —Ä–µ–ø–ª–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –∑–∞–Ω–æ–≤–æ (replay)
- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `{status: "SHIPPED", items: 2, paid: true}`
- Replayable processing

**–ü—Ä–∏–º–µ—Ä 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞ –∏ –ø–µ—Ä–µ—Å—á–µ—Ç**
- –í –∫–æ–¥–µ —Ä–∞—Å—á–µ—Ç–∞ —Å–∫–∏–¥–æ–∫ –±—ã–ª –±–∞–≥ (—Å—á–∏—Ç–∞–ª–∏ 5% –≤–º–µ—Å—Ç–æ 10%)
- –ò—Å–ø—Ä–∞–≤–∏–ª–∏ –∫–æ–¥
- –°–¥–µ–ª–∞–ª–∏ replay –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π "–∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω" –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü
- –ü–µ—Ä–µ—Å—á–∏—Ç–∞–ª–∏ —Å–∫–∏–¥–∫–∏ –∏ –æ–±–Ω–æ–≤–∏–ª–∏ –∑–∞–∫–∞–∑—ã
- Replayable processing –ø–æ–∑–≤–æ–ª–∏–ª –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–∏–º–µ—Ä 3: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ read model**
- –ï—Å—Ç—å stream —Å–æ–±—ã—Ç–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `[UserRegistered, ProfileUpdated, ...]`
- –†–µ—à–∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç: "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –¥–Ω—è–º"
- –°–æ–∑–¥–∞–ª–∏ –Ω–æ–≤—ã–π consumer, —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ offset –Ω–∞ –Ω–∞—á–∞–ª–æ
- Replay –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π ‚Üí –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç
- Replayable processing

**–ü—Ä–∏–º–µ—Ä 4: Kafka ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è**
- Consumer –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–æ —É–ø–∞–ª
- Offset –Ω–µ –±—ã–ª –∑–∞–∫–æ–º–º–∏—á–µ–Ω
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ consumer —á–∏—Ç–∞–µ—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω–æ–≥–æ offset
- Replay –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- Replayable processing (–µ—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è)

### –£—Å–ª–æ–≤–∏—è –¥–ª—è replayable processing

**–£—Å–ª–æ–≤–∏–µ 1: –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π
- –ò–Ω–∞—á–µ replay –¥–∞—Å—Ç –¥—Ä—É–≥–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –≤ —Å–æ–±—ã—Ç–∏—è—Ö

**–£—Å–ª–æ–≤–∏–µ 2: –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (–¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞–µ–≤)**
- –ï—Å–ª–∏ replay –≤–∫–ª—é—á–∞–µ—Ç —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è at-least-once delivery

**–£—Å–ª–æ–≤–∏–µ 3: –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π/—Å–æ–æ–±—â–µ–Ω–∏–π**
- Kafka: —Å–æ–±—ã—Ç–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è —Å retention period
- Event Store: —Å–æ–±—ã—Ç–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
- –ë–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è replay –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω

**–£—Å–ª–æ–≤–∏–µ 4: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ external side effects**
- Email, SMS, –ø–ª–∞—Ç–µ–∂–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è –ø—Ä–∏ replay
- –ù—É–∂–Ω—ã –º–µ—Ö–∞–Ω–∏–∑–º—ã: deduplication, idempotency keys
- –ò–ª–∏: side effects –¥–µ–ª–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º

**–£—Å–ª–æ–≤–∏–µ 5: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã —Å–æ–±—ã—Ç–∏–π**
- –°–æ–±—ã—Ç–∏—è –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
- –ù—É–∂–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º
- –ò–Ω–∞—á–µ —Å—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–µ —Å–º–æ–≥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å—Å—è –Ω–æ–≤—ã–º –∫–æ–¥–æ–º

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ú–∞—Å—Å–æ–≤–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ email –ø—Ä–∏ replay**
- –°–µ—Ä–≤–∏—Å —É–ø–∞–ª, –Ω—É–∂–µ–Ω –±—ã–ª replay –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–ª email –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ–±—ã—Ç–∏–∏ "–∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω"
- Replay 100,000 —Å–æ–±—ã—Ç–∏–π ‚Üí 100,000 email –∑–∞–Ω–æ–≤–æ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –Ω–µ –±—ã–ª–æ deduplication –¥–ª—è email
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –ø–∏—Å—å–º–∞
- **–†–µ—à–µ–Ω–∏–µ**: deduplication –Ω–∞ –æ—Å–Ω–æ–≤–µ event ID + –æ—Ç–¥–µ–ª–µ–Ω–∏–µ side effects

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å replay –∏–∑-–∑–∞ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞**
- Event sourcing —Å–∏—Å—Ç–µ–º–∞, —Å–æ–±—ã—Ç–∏—è —Ö—Ä–∞–Ω–∏–ª–∏ —Ç–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥—ã
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–µ–ª–∞–ª –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–µ–º—É API (–∫—É—Ä—Å –≤–∞–ª—é—Ç—ã)
- –ß–µ—Ä–µ–∑ –≥–æ–¥ –ø–æ–ø—ã—Ç–∞–ª–∏—Å—å replay –¥–ª—è –∞—É–¥–∏—Ç–∞
- API –≤–µ—Ä–Ω—É–ª –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ ‚Üí –¥—Ä—É–≥–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- **–ü—Ä–æ–±–ª–µ–º–∞**: –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- **–†–µ—à–µ–Ω–∏–µ**: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–æ–±—ã—Ç–∏—è

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: Replay —É–ø–∞–ª –∏–∑-–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã**
- –û–±–Ω–æ–≤–∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç —Å–æ–±—ã—Ç–∏–π (breaking change)
- –°—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–µ –ø–∞—Ä—Å—è—Ç—Å—è –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
- –ü—Ä–∏ replay ‚Äî –æ—à–∏–±–∫–∞ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ü—Ä–æ–±–ª–µ–º–∞**: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ö–µ–º
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è
- **–†–µ—à–µ–Ω–∏–µ**: –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è

### –ö–∞–∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å replayable processing

**–ü–æ–¥—Ö–æ–¥ 1: Event Sourcing pattern**
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Äî –∫–∞–∫ —Å–æ–±—ã—Ç–∏—è
- –°–æ–±—ã—Ç–∏—è immutable (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ) –∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–µ—á–Ω–æ
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è replay —Å–æ–±—ã—Ç–∏–π
- –ü—Ä–∏–º–µ—Ä: –±–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å—á–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏–∑ `[Deposited(100), Withdrawn(50)]`

**–ü–æ–¥—Ö–æ–¥ 2: Kafka —Å –¥–ª–∏–Ω–Ω—ã–º retention**
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å retention period = –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å (–∏–ª–∏ –æ—á–µ–Ω—å –¥–æ–ª–≥–æ)
- –ü–æ–∑–≤–æ–ª—è–µ—Ç consumer'–∞–º replay —Å –ª—é–±–æ–≥–æ offset
- –ü—Ä–∏–º–µ—Ä: `retention.ms = -1` (–±–µ—Å–∫–æ–Ω–µ—á–Ω–æ) –∏–ª–∏ 1 –≥–æ–¥

**–ü–æ–¥—Ö–æ–¥ 3: Separation of concerns ‚Äî –æ—Ç–¥–µ–ª–∏—Ç—å side effects**
- Pure processing (—á–∏—Å—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞): –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è, –±–µ–∑ side effects
- Side effects (email, API calls): –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å deduplication
- Replay –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ pure processing

```
–°—Ö–µ–º–∞:
Event ‚Üí Pure Processor ‚Üí State Update + Side Effect Command
                            ‚Üì                      ‚Üì
                         Database           Side Effect Processor
                                              (—Å deduplication)
```

**–ü–æ–¥—Ö–æ–¥ 4: Idempotency –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã (—Å deduplication table)
- Replay –±–µ–∑–æ–ø–∞—Å–µ–Ω, –¥–∞–∂–µ –µ—Å–ª–∏ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç

**–ü–æ–¥—Ö–æ–¥ 5: Snapshots –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è replay**
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å snapshot —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü—Ä–∏ replay: –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π snapshot + –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –ø–æ—Å–ª–µ –Ω–µ–≥–æ
- –£—Å–∫–æ—Ä—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (–Ω–µ –Ω—É–∂–Ω–æ replay –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å–æ–±—ã—Ç–∏–π)

**–ü–æ–¥—Ö–æ–¥ 6: Schema evolution –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –∏–º–µ–µ—Ç –≤–µ—Ä—Å–∏—é —Å—Ö–µ–º—ã
- –ö–æ–¥ —É–º–µ–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- –ò–ª–∏: –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ replay

**–ü–æ–¥—Ö–æ–¥ 7: Test replay —Ä–µ–≥—É–ª—è—Ä–Ω–æ**
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å replay –≤ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –í—ã—è–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –¥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞

### –¢–∏–ø—ã replay

**1. Full replay (–ø–æ–ª–Ω—ã–π)**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö read models, –º–∏–≥—Ä–∞—Ü–∏–π
- –ú–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å —á–∞—Å—ã/–¥–Ω–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

**2. Partial replay (—á–∞—Å—Ç–∏—á–Ω—ã–π)**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- –ü—Ä–∏–º–µ—Ä: replay –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–∞
- –ë—ã—Å—Ç—Ä–µ–µ, –Ω–æ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**3. Point-in-time replay**
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: –∞–Ω–∞–ª–∏–∑–∞, –∞—É–¥–∏—Ç–∞ ("–∫–∞–∫ –≤—ã–≥–ª—è–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã–µ 3 –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥?")
- –¢—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ —Å–æ–±—ã—Ç–∏—è—Ö

**4. Selective replay**
- Replay —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
- –ü—Ä–∏–º–µ—Ä: replay —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è #12345
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –°–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

**–°–ª–æ–∂–Ω–æ—Å—Ç—å 1: –í—Ä–µ–º—è replay**
- Replay –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å–æ–±—ã—Ç–∏–π –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å —á–∞—Å—ã
- –†–µ—à–µ–Ω–∏–µ: snapshots, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞, –∫–æ–º–ø–∞–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π

**–°–ª–æ–∂–Ω–æ—Å—Ç—å 2: External side effects**
- Email, SMS, –ø–ª–∞—Ç–µ–∂–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è
- –†–µ—à–µ–Ω–∏–µ: idempotency keys, deduplication, separate side effect processors

**–°–ª–æ–∂–Ω–æ—Å—Ç—å 3: Schema evolution**
- –°—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è –º–æ–≥—É—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–æ–≤–æ–π —Å—Ö–µ–º–µ
- –†–µ—à–µ–Ω–∏–µ: –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, –º–∏–≥—Ä–∞—Ü–∏—è

**–°–ª–æ–∂–Ω–æ—Å—Ç—å 4: –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º**
- –ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∞, replay –¥–∞—Å—Ç –¥—Ä—É–≥–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –†–µ—à–µ–Ω–∏–µ: –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–±—ã—Ç–∏—è—Ö

**–°–ª–æ–∂–Ω–æ—Å—Ç—å 5: –ü–æ—Ä—è–¥–æ–∫ —Å–æ–±—ã—Ç–∏–π**
- –ü–æ—Ä—è–¥–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
- –†–µ—à–µ–Ω–∏–µ: Kafka partitioning –ø–æ –∫–ª—é—á—É, sequence numbers –≤ —Å–æ–±—ã—Ç–∏—è—Ö

**–°–ª–æ–∂–Ω–æ—Å—Ç—å 6: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏**
- –ö–æ–¥ –∏–∑–º–µ–Ω–∏–ª—Å—è, —Å—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ-–Ω–æ–≤–æ–º—É
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –∂–µ–ª–∞–µ–º—ã–º (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞) –∏–ª–∏ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–º
- –†–µ—à–µ–Ω–∏–µ: –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, temporal queries

### –ö–æ–≥–¥–∞ replayability –∫—Ä–∏—Ç–∏—á–Ω–∞

- ‚úÖ Event Sourcing –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚úÖ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (–∞—É–¥–∏—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ)
- ‚úÖ –°–∏—Å—Ç–µ–º—ã —Å –∂–µ—Å—Ç–∫–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é
- ‚úÖ Analytics –∏ reporting (–ø–µ—Ä–µ—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫)
- ‚úÖ Machine learning (–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö)

### –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ replayability

- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫–µ—à, —Å–µ—Å—Å–∏–∏)
- Fire-and-forget –æ–ø–µ—Ä–∞—Ü–∏–∏
- –î–∞–Ω–Ω—ã–µ —Å –∫–æ—Ä–æ—Ç–∫–∏–º lifecycle

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

**Kafka**
- –°–æ–æ–±—â–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è —Å retention period
- Consumer –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å offset –Ω–∞ –ª—é–±—É—é –ø–æ–∑–∏—Ü–∏—é
- Replay = reset offset + reread messages
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç replayable processing –∏–∑ –∫–æ—Ä–æ–±–∫–∏

**Event Store (–Ω–∞–ø—Ä–∏–º–µ—Ä, EventStoreDB)**
- –°–æ–±—ã—Ç–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ (append-only log)
- Projections –º–æ–≥—É—Ç replay —Å–æ–±—ã—Ç–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- Snapshots —É—Å–∫–æ—Ä—è—é—Ç replay

**Debezium (CDC)**
- Change Data Capture –∏–∑ –ë–î –≤ Kafka
- –°–æ–±—ã—Ç–∏—è –º–æ–∂–Ω–æ replay –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ù–æ: —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –ë–î —Ö—Ä–∞–Ω–∏–ª–∞ binlog –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ

---

## 6. Side-Effect-Free Processing (–û–±—Ä–∞–±–æ—Ç–∫–∞ –ë–µ–∑ –ü–æ–±–æ—á–Ω—ã—Ö –≠—Ñ—Ñ–µ–∫—Ç–æ–≤)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**Side-effect-free processing** (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤) ‚Äî —ç—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ –≤–Ω–µ—à–Ω–µ–º –º–∏—Ä–µ, –∫—Ä–æ–º–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –¢–∞–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –Ω–µ –ø–∏—à–µ—Ç –≤ –ë–î, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–µ –¥–µ–ª–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã.

–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏: **"–ß–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –≤—Ö–æ–¥–∞, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ –º–∏—Ä–∞"**

### üéØ –ß—Ç–æ —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç

- –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º
- –ü—Ä–æ—Å—Ç–æ—Ç—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–µ –Ω—É–∂–Ω—ã –º–æ–∫–∏)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ (–º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ä–∞–∑)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏ –±–µ–∑ race conditions
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–∫–∏

### ‚ö†Ô∏è –ß—Ç–æ —ç—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç

- –ß—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω (—ç—Ç–æ –¥–µ–ª–∞–µ—Ç –≤—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥)
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Ä–æ–≥–æ)
- –ü–æ–ª–µ–∑–Ω–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ (–≤ –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤ –Ω—É–∂–Ω—ã side effects)

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

**–ê–Ω–∞–ª–æ–≥–∏—è —Å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–º**
- –í–≤–æ–¥–∏—Ç–µ "5 + 3"
- –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "8"
- –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç –Ω–∏—á–µ–≥–æ –≤ –º–∏—Ä–µ (–Ω–µ –ø–∏—à–µ—Ç –≤ —Ñ–∞–π–ª, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email)
- –ß–∏—Å—Ç–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –±–µ–∑ side effects

**–ü—Ä–∏–º–µ—Ä 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –í—Ö–æ–¥: `{"email": "test@example.com", "age": 25}`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ regex –¥–ª—è email, –ø—Ä–æ–≤–µ—Ä–∫–∞ age > 0
- –í—ã—Ö–æ–¥: `{valid: true}` –∏–ª–∏ `{valid: false, errors: [...]}`
- –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ë–î, –Ω–∏–∫–∞–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî side-effect-free

**–ü—Ä–∏–º–µ—Ä 2: –†–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏**
- –í—Ö–æ–¥: `{totalAmount: 1000, userLevel: "gold"}`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: —Ä–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º
- –í—ã—Ö–æ–¥: `{discount: 100, finalAmount: 900}`
- –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É ‚Äî —Ç–æ–ª—å–∫–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä 3: –ü–∞—Ä—Å–∏–Ω–≥ JSON**
- –í—Ö–æ–¥: —Å—Ç—Ä–æ–∫–∞ JSON
- –û–±—Ä–∞–±–æ—Ç–∫–∞: —Ä–∞–∑–±–æ—Ä –≤ –æ–±—ä–µ–∫—Ç
- –í—ã—Ö–æ–¥: –æ–±—ä–µ–∫—Ç –∏–ª–∏ –æ—à–∏–±–∫–∞
- –ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä 4: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞**
- –í—Ö–æ–¥: `[{name: "Alice", age: 30}, {name: "Bob", age: 17}]`
- –û–±—Ä–∞–±–æ—Ç–∫–∞: —Ñ–∏–ª—å—Ç—Ä age >= 18
- –í—ã—Ö–æ–¥: `[{name: "Alice", age: 30}]`
- –ù–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤, –Ω–µ –ø–∏—à–µ—Ç –≤ –ë–î

### –ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä—ã (side-effectful –æ–ø–µ—Ä–∞—Ü–∏–∏)

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä 1: –ó–∞–ø–∏—Å—å –≤ –ë–î**
- –û–ø–µ—Ä–∞—Ü–∏—è: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–∫–∞–∑ –≤ Postgres
- Side effect: —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- –ù–µ side-effect-free

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä 2: –û—Ç–ø—Ä–∞–≤–∫–∞ email**
- –û–ø–µ—Ä–∞—Ü–∏—è: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- Side effect: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª email, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- –ù–µ side-effect-free

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä 3: –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Kafka**
- –û–ø–µ—Ä–∞—Ü–∏—è: –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤ topic
- Side effect: Kafka topic —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ù–µ side-effect-free

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä 4: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –û–ø–µ—Ä–∞—Ü–∏—è: –∑–∞–ø–∏—Å–∞—Ç—å –ª–æ–≥ –≤ —Ñ–∞–π–ª
- Side effect: —Ñ–∞–π–ª –∏–∑–º–µ–Ω–∏–ª—Å—è
- –°—Ç—Ä–æ–≥–æ –≥–æ–≤–æ—Ä—è, –Ω–µ side-effect-free (–Ω–æ —á–∞—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π)

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ side-effect-free –æ–±—Ä–∞–±–æ—Ç–∫–∏

**1. –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**
- –ù–µ –Ω—É–∂–Ω—ã –º–æ–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
- –ü—Ä–æ—Å—Ç–æ: input ‚Üí function ‚Üí assert output
- –ë—ã—Å—Ç—Ä—ã–µ unit —Ç–µ—Å—Ç—ã

**2. –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º**
- –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –≤—Ö–æ–¥–∞
- –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏, —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î, –≤–Ω–µ—à–Ω–∏—Ö API
- –õ–µ–≥–∫–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ

**3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–æ–≤**
- –ú–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ä–∞–∑
- –ù–µ –±—É–¥–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è side effects (–∏—Ö –Ω–µ—Ç)
- –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è retry –ª–æ–≥–∏–∫–∏

**4. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è**
- –ú–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –ù–µ—Ç race conditions (–Ω–µ—Ç –æ–±—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è)
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

**5. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ–º–æ–∏–∑–∞—Ü–∏—è**
- –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –≤—Ö–æ–¥–∞
- –ú–æ–∂–Ω–æ –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤—Ö–æ–¥–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**6. –ö–æ–º–ø–æ–∑–∏—Ü–∏—è**
- –õ–µ–≥–∫–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ side-effect-free —Ñ—É–Ω–∫—Ü–∏–π
- –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–Ω–æ–π ‚Üí –≤—Ö–æ–¥ –¥—Ä—É–≥–æ–π
- Functional programming

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**–ü–∞—Ç—Ç–µ—Ä–Ω 1: Pure core, imperative shell**
- –Ø–¥—Ä–æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ ‚Äî —á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (side-effect-free)
- "–û–±–æ–ª–æ—á–∫–∞" (shell) ‚Äî –¥–µ–ª–∞–µ—Ç IO, side effects
- –°—Ö–µ–º–∞: `Input ‚Üí Shell ‚Üí Pure Core ‚Üí Shell ‚Üí Output`

```
–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–∞:
1. Shell: –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–∞–∫–∞–∑ –∏–∑ –ë–î
2. Pure Core: –≤–∞–ª–∏–¥–∞—Ü–∏—è, —Ä–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤
3. Shell: –∑–∞–ø–∏—Å–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑ –≤ –ë–î, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å email
```

**–ü–∞—Ç—Ç–µ—Ä–Ω 2: Command-Query Separation (CQS)**
- Commands ‚Äî –∏–∑–º–µ–Ω—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ (side-effectful), –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- Queries ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ (side-effect-free), –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å side effects

**–ü–∞—Ç—Ç–µ—Ä–Ω 3: Functional Core, Imperative Shell (Hexagonal Architecture)**
- –°–ª–æ–∏:
  - Domain layer ‚Äî side-effect-free (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
  - Application layer ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è, –º–æ–∂–µ—Ç –∏–º–µ—Ç—å side effects
  - Infrastructure layer ‚Äî IO, –ë–î, –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–Ω—É—Ç—Ä—å (–∫ domain)

**–ü–∞—Ç—Ç–µ—Ä–Ω 4: Event Sourcing + Projections**
- Event handlers ‚Äî side-effect-free (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å–æ–±—ã—Ç–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- Projections ‚Äî –º–æ–≥—É—Ç –∏–º–µ—Ç—å side effects (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ read model)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –±–µ–∑ –ë–î

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

**–ü—Ä–∏–º–µ—Ä 1: –°–µ—Ä–≤–∏—Å —Ä–∞—Å—á–µ—Ç–∞ –Ω–∞–ª–æ–≥–æ–≤**
- Side-effect-free —Ñ—É–Ω–∫—Ü–∏—è:
  - –í—Ö–æ–¥: `{amount: 1000, country: "US", state: "CA"}`
  - –õ–æ–≥–∏–∫–∞: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–ª–æ–≥–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª
  - –í—ã—Ö–æ–¥: `{tax: 95, total: 1095}`
- –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥ (side-effectful):
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î
  - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—á–µ—Ç –∫–ª–∏–µ–Ω—Ç—É

**–ü—Ä–∏–º–µ—Ä 2: Kafka Streams ‚Äî stateless transformations**
- `map()`, `filter()`, `flatMap()` ‚Äî side-effect-free
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É—é—Ç –¥–∞–Ω–Ω—ã–µ, –Ω–µ –¥–µ–ª–∞—é—Ç IO
- –ü—Ä–∏–º–µ—Ä: `stream.map(msg => msg.toUpperCase())`
- Side effects –¥–µ–ª–∞—é—Ç—Å—è –≤ `foreach()` –∏–ª–∏ sink

**–ü—Ä–∏–º–µ—Ä 3: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã**
- Side-effect-free:
  - –í—Ö–æ–¥: –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
  - –õ–æ–≥–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª
  - –í—ã—Ö–æ–¥: —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ –∏–ª–∏ "valid"
- –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥:
  - –ï—Å–ª–∏ valid ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î
  - –ï—Å–ª–∏ errors ‚Üí –≤–µ—Ä–Ω—É—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1: –†–µ–∞–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ç—Ä–µ–±—É—é—Ç side effects**
- –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç
- Side-effect-free –æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚Äî —á–∞—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã, –Ω–µ –≤—Å—è —Å–∏—Å—Ç–µ–º–∞
- –í–∞–∂–Ω–æ: –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å side-effect-free —á–∞—Å—Ç–∏ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ (—Å–æ–∑–¥–∞—é—Ç –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã, –Ω–µ –º—É—Ç–∏—Ä—É—é—Ç)
- –ò–Ω–æ–≥–¥–∞ –º—É—Ç–∞—Ü–∏—è –±—ã—Å—Ç—Ä–µ–µ
- –ö–æ–º–ø—Ä–æ–º–∏—Å—Å: —á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ª–æ–≥–∏–∫–∏, –º—É—Ç–∞—Ü–∏—è –¥–ª—è hot paths

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 3: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî side effect
- –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ: –æ–±—ã—á–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, —Å—á–∏—Ç–∞–µ—Ç—Å—è "–¥–æ–ø—É—Å—Ç–∏–º—ã–º" side effect
- –ò–ª–∏: –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ª–æ–≥–∏ –∫–∞–∫ —á–∞—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 4: –°–ª—É—á–∞–π–Ω–æ—Å—Ç—å –∏ –≤—Ä–µ–º—è**
- –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `random()` –∏–ª–∏ `now()`
- –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –£—Å–ª–æ–∂–Ω—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ñ—É–Ω–∫—Ü–∏–∏

### Side-effect-free –≤ —Ä–∞–∑–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö

**Kafka Streams**
- Stateless operations (map, filter) ‚Äî side-effect-free
- Stateful operations (aggregate, reduce) ‚Äî –∏–º–µ—é—Ç state, –Ω–æ –æ–±—ã—á–Ω–æ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
- Side effects (–∑–∞–ø–∏—Å—å –≤ –ë–î, API calls) ‚Äî —á–µ—Ä–µ–∑ Processor API –∏–ª–∏ sinks

**Redis**
- Lua scripts –º–æ–≥—É—Ç –±—ã—Ç—å side-effect-free (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)
- –ò–ª–∏ side-effectful (–∑–∞–ø–∏—Å—å, –≤—ã–∑–æ–≤ –∫–æ–º–∞–Ω–¥)
- –í–∞–∂–Ω–æ –¥–ª—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏: side-effectful —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏

**PostgreSQL Functions**
- IMMUTABLE —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ side-effect-free, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω
- STABLE ‚Äî side-effect-free, –Ω–æ –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- VOLATILE ‚Äî –º–æ–∂–µ—Ç –∏–º–µ—Ç—å side effects

### –ö–∞–∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å side-effect-free –æ–±—Ä–∞–±–æ—Ç–∫—É

**–ü—Ä–∏–Ω—Ü–∏–ø 1: –í—ã–¥–µ–ª–∏—Ç—å —á–∏—Å—Ç—É—é –ª–æ–≥–∏–∫—É**
- –û—Ç–¥–µ–ª–∏—Ç—å —Ä–∞—Å—á–µ—Ç—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—é, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç IO
- –ü—Ä–∏–º–µ—Ä: —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ —Å–∫–∏–¥–∫–∏ –Ω–µ –¥–æ–ª–∂–Ω–∞ —á–∏—Ç–∞—Ç—å –∏–∑ –ë–î
- –î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î ‚Äî –ø–µ—Ä–µ–¥–∞—Ç—å –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä

**–ü—Ä–∏–Ω—Ü–∏–ø 2: Dependency Injection –¥–ª—è side effects**
- –ß–∏—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç IO —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞–ø—Ä—è–º—É—é
- –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥ –∏–Ω–∂–µ–∫—Ç–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –£–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–æ–∫–∏)

**–ü—Ä–∏–Ω—Ü–∏–ø 3: –í–æ–∑–≤—Ä–∞—â–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã, –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å side effects**
- –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "—á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å", –Ω–µ –¥–µ–ª–∞–µ—Ç —Å–∞–º–∞
- –ü—Ä–∏–º–µ—Ä: –≤–µ—Ä–Ω—É—Ç—å `{action: "sendEmail", to: "user@example.com"}`
- –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç action
- –§—É–Ω–∫—Ü–∏—è –æ—Å—Ç–∞–µ—Ç—Å—è side-effect-free

**–ü—Ä–∏–Ω—Ü–∏–ø 4: Immutability**
- –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –º—É—Ç–∏—Ä—É—é—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ side effects

### –ö–æ–≥–¥–∞ side-effect-free –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞

- ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Ä–∞—Å—á–µ—Ç—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ø—Ä–∞–≤–∏–ª–∞)
- ‚úÖ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–ø–∞—Ä—Å–∏–Ω–≥, –º–∞–ø–ø–∏–Ω–≥)
- ‚úÖ –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- ‚úÖ Unit-—Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ö–æ–≥–¥–∞ side effects –Ω–µ–∏–∑–±–µ–∂–Ω—ã

- –ó–∞–ø–∏—Å—å –≤ –ë–î –∏–ª–∏ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (email, SMS, Kafka)
- HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º API
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–π (Redis)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª—ã

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è**: –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å side-effect-free —á–∞—Å—Ç–∏ –∏ side-effectful —á–∞—Å—Ç–∏, –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±–ª–∞—Å—Ç—å side effects.

---

## 7. Side-Effectful Processing (–û–±—Ä–∞–±–æ—Ç–∫–∞ –° –ü–æ–±–æ—á–Ω—ã–º–∏ –≠—Ñ—Ñ–µ–∫—Ç–∞–º–∏)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**Side-effectful processing** (–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –ø–æ–±–æ—á–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏) ‚Äî —ç—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ –º–∏—Ä–∞: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ë–î, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –¥–µ–ª–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã, –∏–∑–º–µ–Ω—è–µ—Ç —Ñ–∞–π–ª—ã.

–ö–ª—é—á–µ–≤–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞: **"–û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–Ω—è–µ—Ç —á—Ç–æ-—Ç–æ –≤–Ω–µ —Å–≤–æ–µ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏"**

### üéØ –ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç

- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–º–µ–µ—Ç –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –≤–æ –≤–Ω–µ—à–Ω–µ–º –º–∏—Ä–µ
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
- –¢—Ä–µ–±—É–µ—Ç—Å—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ side effects –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
- –£—Å–ª–æ–∂–Ω—è–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫—É

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

**–ê–Ω–∞–ª–æ–≥–∏—è —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø–∏—Å—å–º–∞**
- –í—ã –ø–∏—à–µ—Ç–µ –ø–∏—Å—å–º–æ –∏ –æ–ø—É—Å–∫–∞–µ—Ç–µ –≤ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫
- Side effect: –ø–∏—Å—å–º–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, –ø–æ–ª—É—á–∞—Ç–µ–ª—å –µ–≥–æ –ø–æ–ª—É—á–∏—Ç
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ–ø—É—Å–∫–∞–Ω–∏–µ –ø–∏—Å—å–º–∞ ‚Üí –ø–æ–ª—É—á–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç
- –ù–µ–ª—å–∑—è "–æ—Ç–º–µ–Ω–∏—Ç—å" –æ—Ç–ø—Ä–∞–≤–∫—É

**–ü—Ä–∏–º–µ—Ä 1: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –≤ –ë–î**
- –û–±—Ä–∞–±–æ—Ç–∫–∞: `INSERT INTO orders VALUES (...)`
- Side effect: –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–æ—è–≤–∏–ª–∞—Å—å –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- Side-effectful

**–ü—Ä–∏–º–µ—Ä 2: –û—Ç–ø—Ä–∞–≤–∫–∞ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
- –û–±—Ä–∞–±–æ—Ç–∫–∞: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ —á–µ—Ä–µ–∑ SMTP
- Side effect: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª email, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- –ù–µ–ª—å–∑—è "–æ—Ç–æ–∑–≤–∞—Ç—å" –ø–∏—Å—å–º–æ
- Side-effectful

**–ü—Ä–∏–º–µ—Ä 3: –°–ø–∏—Å–∞–Ω–∏–µ –¥–µ–Ω–µ–≥ —Å–æ —Å—á–µ—Ç–∞**
- –û–±—Ä–∞–±–æ—Ç–∫–∞: –≤—ã–∑–æ–≤ API –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- Side effect: –±–∞–ª–∞–Ω—Å —Å—á–µ—Ç–∞ —É–º–µ–Ω—å—à–∏–ª—Å—è
- –ö—Ä–∏—Ç–∏—á–Ω—ã–π side effect (—Ñ–∏–Ω–∞–Ω—Å—ã)
- Side-effectful

**–ü—Ä–∏–º–µ—Ä 4: –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è –≤ Kafka**
- –û–±—Ä–∞–±–æ—Ç–∫–∞: `producer.send(topic, message)`
- Side effect: Kafka topic —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –î—Ä—É–≥–∏–µ consumers –ø–æ–ª—É—á–∞—Ç —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
- Side-effectful

**–ü—Ä–∏–º–µ—Ä 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ –≤ Redis**
- –û–±—Ä–∞–±–æ—Ç–∫–∞: `SET user:123:profile "{...}"`
- Side effect: —Å–æ—Å—Ç–æ—è–Ω–∏–µ Redis –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- –î—Ä—É–≥–∏–µ –∫–ª–∏–µ–Ω—Ç—ã —É–≤–∏–¥—è—Ç –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- Side-effectful

### –¢–∏–ø—ã side effects

**1. Database side effects (–ë–î)**
- INSERT, UPDATE, DELETE
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ persistent —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –û–±—ã—á–Ω–æ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö (–º–æ–≥—É—Ç –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è)

**2. Message/Event side effects (—Å–æ–æ–±—â–µ–Ω–∏—è)**
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Kafka, RabbitMQ
- –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –æ—á–µ—Ä–µ–¥–∏
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ, —Ç—Ä—É–¥–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å

**3. External API side effects (–≤–Ω–µ—à–Ω–∏–µ API)**
- HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º
- –ü–ª–∞—Ç–µ–∂–∏, –≥–µ–æ–∫–æ–¥–∏–Ω–≥, –æ—Ç–ø—Ä–∞–≤–∫–∞ SMS
- –ù–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é, –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏

**4. File system side effects (—Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)**
- –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª—ã, –ª–æ–≥–∏
- –°–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**5. In-memory state side effects (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏)**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–µ—à–µ–π
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ shared state
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ race conditions

**6. User-facing side effects (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)**
- –û—Ç–ø—Ä–∞–≤–∫–∞ email, SMS, push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ü–æ–∫–∞–∑ UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –í–∏–¥–∏–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –≤–ª–∏—è—é—Ç –Ω–∞ UX

### –ü—Ä–æ–±–ª–µ–º—ã side-effectful –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞ 1: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ retry**
- Retry –ø–æ—Å–ª–µ —Å–±–æ—è ‚Üí side effect –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã
- –ü—Ä–∏–º–µ—Ä: –¥–≤–∞ email, –¥–≤–æ–π–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ
- –†–µ—à–µ–Ω–∏–µ: –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, deduplication

**–ü—Ä–æ–±–ª–µ–º–∞ 2: –ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (partial failure)**
- –ß–∞—Å—Ç—å side effects –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, —á–∞—Å—Ç—å ‚Äî –Ω–µ—Ç
- –ü—Ä–∏–º–µ—Ä: –¥–µ–Ω—å–≥–∏ —Å–ø–∏—Å–∞–Ω—ã, –Ω–æ –∑–∞–∫–∞–∑ –Ω–µ —Å–æ–∑–¥–∞–Ω
- –†–µ—à–µ–Ω–∏–µ: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Å–∞–≥–∏, –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ side effects –Ω–µ–æ–±—Ä–∞—Ç–∏–º—ã (–æ—Ç–ø—Ä–∞–≤–∏–ª–∏ email)
- –ù–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫–∞—Ç–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
- –†–µ—à–µ–Ω–∏–µ: compensating transactions, idempotency

**–ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º**
- Side effects –º–æ–≥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ‚Üí –¥—Ä—É–≥–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –†–µ—à–µ–Ω–∏–µ: capture –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–æ–±–ª–µ–º–∞ 5: –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
- –ù—É–∂–Ω—ã –º–æ–∫–∏ –¥–ª—è –ë–î, –≤–Ω–µ—à–Ω–∏—Ö API
- Integration —Ç–µ—Å—Ç—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∏ —Å–ª–æ–∂–Ω—ã–µ
- –†–µ—à–µ–Ω–∏–µ: –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å side effects –æ—Ç —á–∏—Å—Ç–æ–π –ª–æ–≥–∏–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞ 6: Race conditions**
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ side effects –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å
- –ü—Ä–∏–º–µ—Ä: –¥–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—ã—Ç–∞—é—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å –æ–¥–Ω—É –∑–∞–ø–∏—Å—å
- –†–µ—à–µ–Ω–∏–µ: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, ordering

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –î–≤–æ–π–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–ª–∞—Ç–µ–∂–∞**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- –í—ã–∑–æ–≤ API –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞ (side effect)
- Network timeout, –Ω–æ –ø–ª–∞—Ç–µ–∂ –ø—Ä–æ—à–µ–ª
- Retry ‚Üí –≤—Ç–æ—Ä–æ–π –ø–ª–∞—Ç–µ–∂
- **–ü—Ä–æ–±–ª–µ–º–∞**: –Ω–µ—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è API call
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¥–µ–Ω—å–≥–∏ —Å–ø–∏—Å–∞–Ω—ã –¥–≤–∞–∂–¥—ã
- **–†–µ—à–µ–Ω–∏–µ**: Idempotency-Key –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞**
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞: (1) INSERT –≤ –ë–î, (2) —Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ —Å—á–µ—Ç–∞, (3) –æ—Ç–ø—Ä–∞–≤–∫–∞ email
- –ü–æ—Å–ª–µ (1) ‚Äî —É–ø–∞–ª —Å–µ—Ä–≤–∏—Å
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ: –∑–∞–∫–∞–∑ –≤ –ë–î, –Ω–æ –¥–µ–Ω—å–≥–∏ –Ω–µ —Å–ø–∏—Å–∞–Ω—ã, email –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
- **–ü—Ä–æ–±–ª–µ–º–∞**: –Ω–µ–∞—Ç–æ–º–∞—Ä–Ω—ã–µ side effects
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: inconsistent —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **–†–µ—à–µ–Ω–∏–µ**: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ), —Å–∞–≥–∏, –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –°–ø–∞–º email –∏–∑-–∑–∞ retry**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"
- Side effect: –æ—Ç–ø—Ä–∞–≤–∫–∞ welcome email
- Kafka consumer rebalance ‚Üí –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª 3 welcome emails
- **–†–µ—à–µ–Ω–∏–µ**: deduplication table –¥–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö emails

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç: –ö–æ–Ω–∫—É—Ä–∏—Ä—É—é—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –ë–î**
- –î–≤–∞ consumer'–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å–æ–±—ã—Ç–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –û–±–∞ —á–∏—Ç–∞—é—Ç –±–∞–ª–∞–Ω—Å = 1000, –¥–æ–±–∞–≤–ª—è—é—Ç 100
- –û–±–∞ –ø–∏—à—É—Ç –±–∞–ª–∞–Ω—Å = 1100
- **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 1200
- **–†–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 1100 (–ø–æ—Ç–µ—Ä—è–ª–∏ –æ–¥–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- **–ü—Ä–æ–±–ª–µ–º–∞**: race condition
- **–†–µ—à–µ–Ω–∏–µ**: Kafka partitioning –ø–æ userId (—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è), –∏–ª–∏ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### –ö–∞–∫ —É–ø—Ä–∞–≤–ª—è—Ç—å side-effectful –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**
- –î–µ–ª–∞—Ç—å side effects –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏
- –ü—Ä–∏–º–µ—Ä: `UPDATE SET status='COMPLETED'` ‚Äî –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ
- –ü—Ä–∏–º–µ—Ä: API –∑–∞–ø—Ä–æ—Å —Å Idempotency-Key

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (ACID)**
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å side effects –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –ë–î
- Atomic: –≤—Å–µ –∏–ª–∏ –Ω–∏—á–µ–≥–æ
- Rollback –ø—Ä–∏ –æ—à–∏–±–∫–µ
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–π –ë–î (–æ–±—ã—á–Ω–æ)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 3: Distributed transactions (–¥–≤—É—Ö—Ñ–∞–∑–Ω—ã–π –∫–æ–º–º–∏—Ç, 2PC)**
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º
- –°–ª–æ–∂–Ω–æ, –º–µ–¥–ª–µ–Ω–Ω–æ, —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã: —Å–∞–≥–∏ (—Å–º. –Ω–∏–∂–µ)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 4: Saga pattern**
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –ö–∞–∂–¥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ
- –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (rollback)
- Eventual consistency

```
–ü—Ä–∏–º–µ—Ä Saga –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞:
1. –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä ‚Üí OrderReserved
2. –°–ø–∏—Å–∞—Ç—å –¥–µ–Ω—å–≥–∏ ‚Üí PaymentCompleted
3. –°–æ–∑–¥–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É ‚Üí DeliveryScheduled

–ü—Ä–∏ –æ—à–∏–±–∫–µ –Ω–∞ —à–∞–≥–µ 2:
‚Üí –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è: –æ—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—é —Ç–æ–≤–∞—Ä–∞
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 5: Outbox pattern**
- Side effects (–ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Kafka) –¥–µ–ª–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ outbox —Ç–∞–±–ª–∏—Ü—É
- –í –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: (1) –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, (2) INSERT –≤ outbox
- –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —á–∏—Ç–∞–µ—Ç outbox –∏ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å (–¥–∞–Ω–Ω—ã–µ + —Å–æ–±—ã—Ç–∏–µ)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 6: Deduplication**
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å: "—É–∂–µ –¥–µ–ª–∞–ª–∏ —ç—Ç–æ—Ç side effect?"
- Deduplication table: —Ö—Ä–∞–Ω–∏—Ç—å ID –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–∏–º–µ—Ä: –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π email –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ª–∏ —É–∂–µ

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 7: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ side effects**
- –ù–µ –¥–µ–ª–∞—Ç—å side effects –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É/—Å–æ–±—ã—Ç–∏–µ –¥–ª—è side effect
- –û—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç side effect
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 8: Retry —Å backoff**
- Side effects –º–æ–≥—É—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–±–æ–∏—Ç—å (network timeout)
- Retry —Å exponential backoff
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ø—ã—Ç–æ–∫
- –í–∞–∂–Ω–æ: side effects –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏ –¥–ª—è retry

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 9: Compensating transactions**
- –ï—Å–ª–∏ side effect –Ω–µ–ª—å–∑—è –æ—Ç–∫–∞—Ç–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é
- –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
- –ü—Ä–∏–º–µ—Ä: —Å–ø–∏—Å–∞–ª–∏ –¥–µ–Ω—å–≥–∏ ‚Üí –≤–µ—Ä–Ω—É—Ç—å –¥–µ–Ω—å–≥–∏
- –ù–µ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–º–æ–∂–Ω–æ (email –Ω–µ "–æ—Ç–æ–∑–≤–∞—Ç—å")

### Side effects –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–æ–¥–Ω–∞ –ë–î)**
```
BEGIN TRANSACTION
  INSERT INTO orders (...)
  UPDATE inventory SET qty = qty - 1
  INSERT INTO outbox (event_type, payload)
COMMIT
```
- –í—Å–µ side effects –≤ –ë–î ‚Äî –∞—Ç–æ–º–∞—Ä–Ω—ã
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí ROLLBACK, –≤—Å–µ –æ—Ç–º–µ–Ω–∏—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞: side effects –≤–Ω–µ –ë–î**
- –û—Ç–ø—Ä–∞–≤–∫–∞ email ‚Äî –Ω–µ–ª—å–∑—è –≤–∫–ª—é—á–∏—Ç—å –≤ DB —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
- –ï—Å–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ email, –∑–∞—Ç–µ–º ROLLBACK ‚Üí email –Ω–µ "–æ—Ç–∫–∞—Ç–∏—Ç—Å—è"

**–†–µ—à–µ–Ω–∏–µ: Outbox + async processor**
```
BEGIN TRANSACTION
  INSERT INTO orders (...)
  INSERT INTO outbox (type='SEND_EMAIL', payload='{...}')
COMMIT

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ:
  Read outbox ‚Üí send email ‚Üí mark as sent
```

### Side effects –≤ —Ä–∞–∑–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö

**Kafka**
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Kafka ‚Äî side effect
- Kafka Transactions: –∞—Ç–æ–º–∞—Ä–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ topics
- Exactly-once semantics: read from Kafka ‚Üí process ‚Üí write to Kafka (–≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)

**Postgres**
- INSERT/UPDATE/DELETE ‚Äî side effects
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- Triggers ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ side effects (–Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å)

**Redis**
- SET, DEL, INCR ‚Äî side effects (–∏–∑–º–µ–Ω—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- Lua scripts ‚Äî –º–æ–≥—É—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å side effects (–∞—Ç–æ–º–∞—Ä–Ω–æ)
- –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –º–µ–∂–¥—É Redis –∏ –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

**HTTP APIs**
- –ó–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º API ‚Äî side effects
- –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ Idempotency-Key (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

### –ö–æ–≥–¥–∞ side-effectful –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–±–µ–∂–Ω–∞

- ‚ùó –†–µ–∞–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ç—Ä–µ–±—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∑–∞–ø–∏—Å—å –≤ –ë–î, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π)
- ‚ùó –í–æ–ø—Ä–æ—Å –Ω–µ "–∏–∑–±–µ–≥–∞—Ç—å –ª–∏ side effects", –∞ "–∫–∞–∫ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–º–∏"

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò–∑–æ–ª–∏—Ä—É–π—Ç–µ side effects**
   - –û—Ç–¥–µ–ª–∏—Ç–µ —á–∏—Å—Ç—É—é –ª–æ–≥–∏–∫—É (side-effect-free) –æ—Ç side effects
   - Pure core ‚Üí imperative shell

2. **–î–µ–ª–∞–π—Ç–µ side effects –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏**
   - Deduplication, Idempotency-Key
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ retry

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ**
   - ACID –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö side effects (–ë–î)
   - Saga –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö

4. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ side effects —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è**
   - Outbox pattern
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

5. **–Ø–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–æ–º**
   - Kafka partitioning –¥–ª—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö side effects
   - –ò–∑–±–µ–≥–∞–π—Ç–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö side effects

6. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ side effects**
   - –í–∞–∂–Ω–æ –≤–∏–¥–µ—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏, retry, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

7. **–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ compensating actions**
   - –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–µ?
   - –ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å side effect (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)?

---

## 8. External Side-Effect Semantics (–°–µ–º–∞–Ω—Ç–∏–∫–∞ –í–Ω–µ—à–Ω–∏—Ö –ü–æ–±–æ—á–Ω—ã—Ö –≠—Ñ—Ñ–µ–∫—Ç–æ–≤)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**External side-effect semantics** (—Å–µ–º–∞–Ω—Ç–∏–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤) ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –≥–∞—Ä–∞–Ω—Ç–∏–π –∏ –ø–æ–ª–∏—Ç–∏–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–æ–≥–æ, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç side effects, –∫–æ—Ç–æ—Ä—ã–µ –≤–ª–∏—è—é—Ç –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–æ—Ç–ø—Ä–∞–≤–∫–∞ email, —Å–ø–∏—Å–∞–Ω–∏–µ –¥–µ–Ω–µ–≥, –≤—ã–∑–æ–≤—ã –≤–Ω–µ—à–Ω–∏—Ö API). –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤–Ω–µ—à–Ω–∏–µ side effects —á–∞—Å—Ç–æ –Ω–µ–æ–±—Ä–∞—Ç–∏–º—ã –∏ –≤–∏–¥–∏–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

–ö–ª—é—á–µ–≤–æ–π –≤–æ–ø—Ä–æ—Å: **"–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∏ –ø—Ä–∏ –∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –≤–Ω–µ—à–Ω–∏–π side effect?"**

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–º–∞–Ω—Ç–∏–∫–∏

**1. At-most-once (–Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞)**
- –ì–∞—Ä–∞–Ω—Ç–∏—è: side effect –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è 0 –∏–ª–∏ 1 —Ä–∞–∑, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–≤–∞–∂–¥—ã
- –ú–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å: –µ—Å–ª–∏ —É–ø–∞–¥–µ—Ç –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ù–µ –±—É–¥–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–º–µ—Ä: –æ—Ç–ø—Ä–∞–≤–∫–∞ email –±–µ–∑ retry

**2. At-least-once (—Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–∞–∑)**
- –ì–∞—Ä–∞–Ω—Ç–∏—è: side effect –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –º–∏–Ω–∏–º—É–º 1 —Ä–∞–∑, –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ
- –ù–µ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è, –Ω–æ –º–æ–∂–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è
- –¢—Ä–µ–±—É–µ—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- –ü—Ä–∏–º–µ—Ä: Kafka consumer —Å at-least-once delivery

**3. Exactly-once (—Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑)**
- –ì–∞—Ä–∞–Ω—Ç–∏—è: side effect –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ä–æ–≤–Ω–æ 1 —Ä–∞–∑
- –°–ª–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
- –ß–∞—Å—Ç–æ: "effectively exactly-once" (–±–ª–∞–≥–æ–¥–∞—Ä—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏)
- –ü—Ä–∏–º–µ—Ä: Kafka Transactions + –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫

**4. Best-effort (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)**
- –ù–µ—Ç —Å—Ç—Ä–æ–≥–∏—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π
- –ü–æ–ø—ã—Ç–∞–µ–º—Å—è, –Ω–æ –º–æ–∂–µ–º –ø–æ—Ç–µ—Ä—è—Ç—å –∏–ª–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å
- –î–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–∏–º–µ—Ä: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ monitoring —Å–∏—Å—Ç–µ–º—É

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–µ–º–∞–Ω—Ç–∏–∫

| –°–µ–º–∞–Ω—Ç–∏–∫–∞ | –ú–æ–∂–µ—Ç –ø–æ—Ç–µ—Ä—è—Ç—å? | –ú–æ–∂–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å? | –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | –¢–∏–ø–∏—á–Ω—ã–µ use cases |
|-----------|----------------|-------------------|---------------------|-------------------|
| At-most-once | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | –ù–∏–∑–∫–∞—è | –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| At-least-once | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | –°—Ä–µ–¥–Ω—è—è | –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º (+ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å) |
| Exactly-once | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | –í—ã—Å–æ–∫–∞—è | –§–∏–Ω–∞–Ω—Å—ã, –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| Best-effort | ‚úÖ –î–∞ | ‚úÖ –î–∞ | –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–µ—Ç—Ä–∏–∫–∏ |

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

**At-most-once: Fire-and-forget email**
- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º email
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ (network timeout) ‚Äî –Ω–µ retry
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–µ –ø–æ–ª—É—á–∏—Ç—å –ø–∏—Å—å–º–æ (0 —Ä–∞–∑)
- –ò–ª–∏ –ø–æ–ª—É—á–∏—Ç—å (1 —Ä–∞–∑)
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç
- Use case: –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∂–µ, —á–µ–º –ø–æ—Ç–µ—Ä—è –æ–¥–Ω–æ–≥–æ –ø–∏—Å—å–º–∞)

**At-least-once: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
- –û—Ç–ø—Ä–∞–≤–∫–∞ SMS —Å –∫–æ–¥–æ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- Retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ú–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ù–æ —Ç–æ—á–Ω–æ –Ω–µ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è
- Use case: –≤–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–ª—É—á—à–µ –¥—É–±–ª–∏–∫–∞—Ç, —á–µ–º –ø–æ—Ç–µ—Ä—è)

**Exactly-once: –°–ø–∏—Å–∞–Ω–∏–µ –¥–µ–Ω–µ–≥**
- –°–ø–∏—Å–∞—Ç—å 100‚ÇΩ —Å–æ —Å—á–µ—Ç–∞
- –î–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏ —Ä–æ–≤–Ω–æ 1 —Ä–∞–∑
- –ù–∏ 0 (–¥–µ–Ω—å–≥–∏ –Ω–µ —Å–ø–∏—Å–∞–ª–∏—Å—å), –Ω–∏ 2 (–¥–≤–æ–π–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ)
- –¢—Ä–µ–±—É–µ—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ + deduplication
- Use case: —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**Best-effort: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫**
- –ó–∞–ø–∏—Å–∞—Ç—å –º–µ—Ç—Ä–∏–∫—É "–∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω –∑–∞ 150ms"
- –ï—Å–ª–∏ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è ‚Äî –Ω–µ —Å—Ç—Ä–∞—à–Ω–æ (approximate –º–µ—Ç—Ä–∏–∫–∏)
- –ï—Å–ª–∏ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è ‚Äî –Ω–µ–±–æ–ª—å—à–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å
- Use case: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (approximate –¥–æ–ø—É—Å—Ç–∏–º–æ)

### –ü—Ä–æ–±–ª–µ–º—ã –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 1: –î–≤–æ–π–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ (at-least-once –±–µ–∑ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏)**
- –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å at-least-once —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç API –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞
- Network timeout –ø–æ—Å–ª–µ —Å–ø–∏—Å–∞–Ω–∏—è ‚Üí retry
- **–ü—Ä–æ–±–ª–µ–º–∞**: API –Ω–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–π, –Ω–µ—Ç Idempotency-Key
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¥–µ–Ω—å–≥–∏ —Å–ø–∏—Å–∞–Ω—ã –¥–≤–∞–∂–¥—ã
- **–†–µ—à–µ–Ω–∏–µ**: –¥–æ–±–∞–≤–∏—Ç—å Idempotency-Key –≤ –∑–∞–ø—Ä–æ—Å—ã (effectively exactly-once)

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 2: –ü–æ—Ç–µ—Ä—è –∫—Ä–∏—Ç–∏—á–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (at-most-once)**
- –°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å—Ç–∞—Ç—É—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏
- At-most-once —Å–µ–º–∞–Ω—Ç–∏–∫–∞ (–±–µ–∑ retry)
- –°–±–æ–π —Å–µ—Ç–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —É–∑–Ω–∞–ª –æ –¥–æ—Å—Ç–∞–≤–∫–µ
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –∂–∞–ª–æ–±—ã, –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –æ–ø—ã—Ç
- **–†–µ—à–µ–Ω–∏–µ**: –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ at-least-once + deduplication

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 3: –õ–∞–≤–∏–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è email (at-least-once –±–µ–∑ deduplication)**
- Email-—Å–µ—Ä–≤–∏—Å —Å at-least-once
- Kafka consumer rebalance ‚Üí –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ 10,000 —Å–æ–æ–±—â–µ–Ω–∏–π
- **–ü—Ä–æ–±–ª–µ–º–∞**: –Ω–µ—Ç deduplication
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª –ø–æ 2-3 –∫–æ–ø–∏–∏ –ø–∏—Å—å–º–∞
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**: –∂–∞–ª–æ–±—ã, —Å–Ω–∏–∂–µ–Ω–∏–µ engagement, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ SMTP –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º
- **–†–µ—à–µ–Ω–∏–µ**: deduplication table –ø–æ message ID

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 4: –ù–µ—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (exactly-once –Ω–∞—Ä—É—à–µ–Ω–∞)**
- –°–∏—Å—Ç–µ–º–∞ –æ–±–µ—â–∞–µ—Ç exactly-once –æ–±—Ä–∞–±–æ—Ç–∫—É
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è: (1) UPDATE –ë–î, (2) –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Kafka
- –ü–æ—Å–ª–µ (1) —É–ø–∞–ª —Å–µ—Ä–≤–∏—Å, (2) –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∞—Å—å
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ë–î –æ–±–Ω–æ–≤–ª–µ–Ω–∞, –Ω–æ —Å–æ–±—ã—Ç–∏–µ –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–µ —É–∑–Ω–∞–ª–∏ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏, –Ω–µ—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å
- **–†–µ—à–µ–Ω–∏–µ**: Outbox pattern (–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å)

### –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Å–µ–º–∞–Ω—Ç–∏–∫–∏

#### At-most-once

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –í—ã–ø–æ–ª–Ω–∏—Ç—å side effect
- –ù–µ –¥–µ–ª–∞—Ç—å retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å offset –≤ Kafka —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ø—ã—Ç–∫–∏ (–¥–∞–∂–µ –µ—Å–ª–∏ –æ—à–∏–±–∫–∞)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –≥–¥–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∂–µ –ø–æ—Ç–µ—Ä–∏
- –ü—Ä–∏–º–µ—Ä: –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ email, –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ª–æ–≥–∏

**–ü—Ä–∏–º–µ—Ä (–ø—Å–µ–≤–¥–æ–∫–æ–¥):**
```
message = kafka.poll()
try:
  sendEmail(message.email)
catch:
  log("Failed to send email, skipping")
finally:
  kafka.commit(message.offset)  // –ö–æ–º–º–∏—Ç–∏–º –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
```

#### At-least-once

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –í—ã–ø–æ–ª–Ω–∏—Ç—å side effect
- Retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ö–æ–º–º–∏—Ç–∏—Ç—å offset —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞
- **–í–∞–∂–Ω–æ**: side effect –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º!

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–ª—É—á–∞–µ–≤ (—Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é)
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä (–ø—Å–µ–≤–¥–æ–∫–æ–¥):**
```
message = kafka.poll()
success = false
while not success:
  try:
    processSideEffect(message)  // –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    success = true
  catch:
    sleep(exponentialBackoff)
    retry
kafka.commit(message.offset)
```

**–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (deduplication):**
```
function processSideEffect(message):
  if db.exists("processed_messages", message.id):
    return  // –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏

  // –í—ã–ø–æ–ª–Ω–∏—Ç—å side effect
  sendEmail(message.email)

  // –ó–∞–ø–∏—Å–∞—Ç—å, —á—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏
  db.insert("processed_messages", message.id)
```

#### Exactly-once

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –í–∞—Ä–∏–∞–Ω—Ç 1 ‚Äî Kafka Transactions (–¥–ª—è Kafka side effects)**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: read from Kafka ‚Üí process ‚Üí write to Kafka
- Atomic: read + write
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è Kafka-to-Kafka

**–ü—Ä–∏–º–µ—Ä (–ø—Å–µ–≤–¥–æ–∫–æ–¥):**
```
kafka.beginTransaction()
message = kafka.poll()
result = process(message)
kafka.send(outputTopic, result)
kafka.commitTransaction()  // Atomic: offset + –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –í–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî Database Transaction + Outbox**
- –î–ª—è side effects –≤ –ë–î + –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
- Outbox pattern: –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑–º–µ–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ + –ø–∏—à–µ–º –≤ outbox
- –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —á–∏—Ç–∞–µ—Ç outbox –∏ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è

**–ü—Ä–∏–º–µ—Ä (–ø—Å–µ–≤–¥–æ–∫–æ–¥):**
```
BEGIN TRANSACTION
  INSERT INTO orders (id, status) VALUES (123, 'CREATED')
  INSERT INTO outbox (event_type, payload) VALUES ('OrderCreated', '{...}')
COMMIT

// –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:
events = db.select("outbox WHERE sent = false")
for event in events:
  kafka.send(event.type, event.payload)
  db.update("outbox SET sent = true WHERE id = " + event.id)
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –í–∞—Ä–∏–∞–Ω—Ç 3 ‚Äî –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (effectively exactly-once)**
- At-least-once delivery + –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –ü—Ä–æ—â–µ, —á–µ–º –Ω–∞—Å—Ç–æ—è—â–∏–π exactly-once

**–ü—Ä–∏–º–µ—Ä:**
```
message = kafka.poll()
if alreadyProcessed(message.id):
  kafka.commit()
  return

processSideEffect(message)  // –ò–∑–º–µ–Ω—è–µ—Ç –ë–î
markAsProcessed(message.id)
kafka.commit()
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å exactly-once:**
- ‚úÖ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (inventory, billing)
- ‚úÖ –°–∏—Å—Ç–µ–º—ã —Å —Å—Ç—Ä–æ–≥–æ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é

#### Best-effort

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ü–æ–ø—ã—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å side effect
- –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî –ª–æ–≥–∏—Ä—É–µ–º, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º
- –ù–µ—Ç retry, –Ω–µ—Ç —Å—Ç—Ä–æ–≥–∏—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
- Cache warming
- –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–∏–º–µ—Ä:**
```
message = kafka.poll()
try:
  logMetric("message_processed", 1)
catch:
  // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
finally:
  kafka.commit()
```

### –í–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

**–ü—Ä–æ–±–ª–µ–º–∞**: –≤–Ω–µ—à–Ω–∏–µ API –º–æ–≥—É—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

**–†–µ—à–µ–Ω–∏–µ 1: Idempotency-Key**
- –ú–Ω–æ–≥–∏–µ API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç Idempotency-Key –∑–∞–≥–æ–ª–æ–≤–æ–∫
- –ü—Ä–∏–º–µ—Ä: Stripe API
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å —Ç–µ–º –∂–µ –∫–ª—é—á–æ–º ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–ü—Ä–∏–º–µ—Ä:**
```
POST /charges
Idempotency-Key: msg-abc-123
Body: {amount: 1000, currency: "USD"}

–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å —Ç–µ–º –∂–µ –∫–ª—é—á–æ–º ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ—Ç –∂–µ charge (–Ω–µ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π)
```

**–†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞**
- –ü–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º API –ø—Ä–æ–≤–µ—Ä—è–µ–º: "—É–∂–µ –¥–µ–ª–∞–ª–∏?"
- –•—Ä–∞–Ω–∏–º —Ç–∞–±–ª–∏—Ü—É –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–∏–º–µ—Ä:**
```
if db.exists("external_calls", message.id):
  return  // –£–∂–µ –≤—ã–∑–≤–∞–ª–∏ API

result = externalAPI.call(...)
db.insert("external_calls", {id: message.id, result: result})
```

**–†–µ—à–µ–Ω–∏–µ 3: Natural idempotency**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã –ø–æ –ø—Ä–∏—Ä–æ–¥–µ
- –ü—Ä–∏–º–µ—Ä: `PUT /users/123 {"name": "Ivan"}` ‚Äî —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–º—è (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ)
- –ü—Ä–∏–º–µ—Ä: `POST /users {"name": "Ivan"}` ‚Äî —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ù–ï –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ)

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥

**–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**

1. **Duplication rate** (—á–∞—Å—Ç–æ—Ç–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
   - –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–∏–¥–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã?
   - –í—ã—Å–æ–∫–∏–π rate ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ —Å –∫–æ–º–º–∏—Ç–∞–º–∏ offset

2. **Retry rate** (—á–∞—Å—Ç–æ—Ç–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤)
   - –ö–∞–∫ —á–∞—Å—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç retry?
   - –í—ã—Å–æ–∫–∏–π rate ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

3. **Deduplication hits** (–ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ deduplication)
   - –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç deduplication?
   - –ü–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–æ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

4. **External API errors** (–æ—à–∏–±–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö API)
   - –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –≤—ã–∑–æ–≤–∞—Ö –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–±–ª–µ–º —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

5. **Side effect latency** (–ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å side effects)
   - –ö–∞–∫ –¥–æ–ª–≥–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è side effects?
   - –ú–µ–¥–ª–µ–Ω–Ω—ã–µ side effects –º–æ–≥—É—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Ç–∞–π–º–∞—É—Ç–∞–º –∏ retry

**–ê–ª–µ—Ä—Ç—ã:**
- –í—ã—Å–æ–∫–∏–π duplication rate ‚Üí –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ —Å –∫–æ–º–º–∏—Ç–∞–º–∏
- –†–æ—Å—Ç deduplication hits ‚Üí –≤–æ–∑–º–æ–∂–Ω–æ, —á–∞—Å—Ç—ã–µ rebalances –∏–ª–∏ retries
- –û—à–∏–±–∫–∏ external API ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**1. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å–µ–º–∞–Ω—Ç–∏–∫—É –¥–ª—è use case**
- –§–∏–Ω–∞–Ω—Å—ã ‚Üí exactly-once (—á–µ—Ä–µ–∑ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Üí at-least-once + deduplication
- –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ª–æ–≥–∏ ‚Üí best-effort

**2. –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏ –ø—Ä–∏ at-least-once**
- Deduplication table –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞
- –ò–Ω–∞—á–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–∏–∑–±–µ–∂–Ω–æ

**3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Idempotency-Key –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API**
- –ï—Å–ª–∏ API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ
- –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É

**4. –û—Ç–¥–µ–ª—è–π—Ç–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ side effects**
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–ø–ª–∞—Ç–µ–∂–∏) ‚Üí exactly-once
- –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ (–ª–æ–≥–∏) ‚Üí best-effort
- –ù–µ —Å–º–µ—à–∏–≤–∞–π—Ç–µ –≤ –æ–¥–Ω–æ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ

**5. Outbox pattern –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ –ë–î + —Å–æ–±—ã—Ç–∏—è**
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ë–î –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤–º–µ—Å—Ç–µ
- –ò–∑–±–µ–≥–∞–µ—Ç –Ω–µ—Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

**6. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏ –∞–ª–µ—Ä—Ç—É–π—Ç–µ**
- –í–∏–¥–∏–º–æ—Å—Ç—å –≤ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—à–∏–±–∫–∏, retry
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

**7. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ edge cases**
- –ß—Ç–æ –±—É–¥–µ—Ç –ø—Ä–∏ network timeout?
- –ß—Ç–æ –ø—Ä–∏ consumer rebalance?
- –ß—Ç–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è?

**8. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–µ–º–∞–Ω—Ç–∏–∫—É**
- –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ, –∫–∞–∫—É—é —Å–µ–º–∞–Ω—Ç–∏–∫—É –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
- –ü–æ–º–æ–≥–∞–µ—Ç –∫–æ–º–∞–Ω–¥–µ –ø–æ–Ω–∏–º–∞—Ç—å –æ–∂–∏–¥–∞–Ω–∏—è –∏ —Ä–∏—Å–∫–∏

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ –í–∑–∞–∏–º–æ—Å–≤—è–∑–∏

### –¢–∞–±–ª–∏—Ü–∞ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π —Å–µ–º–∞–Ω—Ç–∏–∫

| –°–≤–æ–π—Å—Ç–≤–æ | –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å | –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º | Replayability | Side-effect-free |
|----------|----------------|-------------|---------------|------------------|
| **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** | ‚Äì | –ù–µ–∑–∞–≤–∏—Å–∏–º—ã | –ü–æ–º–æ–≥–∞–µ—Ç | –ù–µ–∑–∞–≤–∏—Å–∏–º—ã |
| **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º** | –ù–µ–∑–∞–≤–∏—Å–∏–º—ã | ‚Äì | –ù–µ–æ–±—Ö–æ–¥–∏–º | –£–ø—Ä–æ—â–∞–µ—Ç |
| **Replayability** | –ß–∞—Å—Ç–æ —Ç—Ä–µ–±—É–µ—Ç | –¢—Ä–µ–±—É–µ—Ç | ‚Äì | –£–ø—Ä–æ—â–∞–µ—Ç |
| **Side-effect-free** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–∞—ë—Ç | –£–ø—Ä–æ—â–∞–µ—Ç | –£–ø—Ä–æ—â–∞–µ—Ç | ‚Äì |

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
- **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** –∏ **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º** ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ (–º–æ–∂–Ω–æ –∏–º–µ—Ç—å –æ–¥–Ω–æ –±–µ–∑ –¥—Ä—É–≥–æ–≥–æ)
- **Replayability** —Ç—Ä–µ–±—É–µ—Ç **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞** (–∏–Ω–∞—á–µ replay –¥–∞—Å—Ç –¥—Ä—É–≥–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
- **Side-effect-free** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–∞—ë—Ç **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** (–Ω–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ ‚Üí –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
- **Side-effect-free** —É–ø—Ä–æ—â–∞–µ—Ç **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º** (–Ω–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

### –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

**Event Sourcing**
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Å–æ–±—ã—Ç–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ Replayable (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ —Å–æ–±—ã—Ç–∏–π)
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è (–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π)
- ‚ö†Ô∏è Side effects –æ—Ç–¥–µ–ª–µ–Ω—ã (—á–µ—Ä–µ–∑ projections)

**Kafka Streams**
- ‚úÖ Replayable (–º–æ–∂–Ω–æ replay —Ç–æ–ø–∏–∫–∏)
- ‚úÖ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–∞ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (–¥–ª—è exactly-once)
- ‚úÖ Stateless –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî side-effect-free
- ‚ö†Ô∏è Sinks ‚Äî side-effectful, —Ç—Ä–µ–±—É—é—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

**Microservices —Å Kafka**
- ‚úÖ At-least-once delivery ‚Üí —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- ‚ö†Ô∏è Side effects (–ë–î, API) ‚Üí –Ω—É–∂–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å
- ‚ö†Ô∏è –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º ‚Äî –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)

### –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

–ü—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∑–∞–¥–∞–π—Ç–µ —Å–µ–±–µ –≤–æ–ø—Ä–æ—Å—ã:

1. **–ö–∞–∫–∞—è delivery semantics —É –∏—Å—Ç–æ—á–Ω–∏–∫–∞?**
   - At-least-once ‚Üí –Ω—É–∂–Ω–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
   - Exactly-once ‚Üí –º–æ–∂–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É

2. **–ï—Å—Ç—å –ª–∏ side effects?**
   - –î–∞ ‚Üí –Ω—É–∂–µ–Ω –ø–ª–∞–Ω —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
   - –ù–µ—Ç ‚Üí —É–ø—Ä–æ—â–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ replay

3. **–ù—É–∂–Ω–∞ –ª–∏ replayability?**
   - –î–∞ ‚Üí –Ω—É–∂–µ–Ω –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º, —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
   - –ù–µ—Ç ‚Üí –º–æ–∂–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å

4. **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∞ –ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞?**
   - –ù–µ—Ç ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å replay, –æ—Ç–ª–∞–¥–∫–æ–π
   - –î–∞ ‚Üí —É–ø—Ä–æ—â–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

5. **–ö–∞–∫–∏–µ –≤–Ω–µ—à–Ω–∏–µ side effects?**
   - Email, SMS ‚Üí deduplication
   - –ü–ª–∞—Ç–µ–∂–∏ ‚Üí exactly-once (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)
   - –õ–æ–≥–∏ ‚Üí best-effort

6. **–ö–∞–∫–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ç—Ä–µ–±—É–µ—Ç—Å—è?**
   - Strict ‚Üí —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, exactly-once
   - Eventual ‚Üí at-least-once + –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã

**1. Delivery ‚â† Processing**
- Delivery semantics (—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ) ‚â† Processing semantics (–∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ)
- At-least-once delivery —Ç—Ä–µ–±—É–µ—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**2. –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å ‚Äî –∫–ª—é—á –∫ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏**
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º ‚Äî at-least-once delivery
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

**3. –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º ‚Äî –∫–ª—é—á –∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏**
- –ù–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è replay, –æ—Ç–ª–∞–¥–∫–∏, –∞—É–¥–∏—Ç–∞
- –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –≤ —Å–æ–±—ã—Ç–∏—è—Ö (–≤—Ä–µ–º—è, —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å, –≤–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ)

**4. –ò–∑–æ–ª–∏—Ä—É–π—Ç–µ side effects**
- –ß–∏—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç IO
- –£–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—Ç–ª–∞–¥–∫—É, –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

**5. –í—ã–±–∏—Ä–∞–π—Ç–µ —Å–µ–º–∞–Ω—Ç–∏–∫—É –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ**
- –§–∏–Ω–∞–Ω—Å—ã ‚Üí exactly-once
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Üí at-least-once + deduplication
- –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ ‚Üí best-effort

**6. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ edge cases**
- Network timeouts, crashes, rebalances
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –≤–µ–¥–µ—Ç —Å–µ–±—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**7. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏ –∞–ª–µ—Ä—Ç—É–π—Ç–µ**
- –í–∏–¥–∏–º–æ—Å—Ç—å –≤ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—à–∏–±–∫–∏, retry
- –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

**1. Deduplication Table (—Ç–∞–±–ª–∏—Ü–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏)**
- –•—Ä–∞–Ω–∏—Ç ID –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

**2. Outbox Pattern**
- –ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å: –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö + –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è
- –û–¥–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤ –ë–î
- –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø—É–±–ª–∏–∫—É–µ—Ç –∏–∑ outbox

**3. Saga Pattern**
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ

**4. Event Sourcing**
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî —Å–æ–±—ã—Ç–∏—è
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏–∑ —Å–æ–±—ã—Ç–∏–π
- Replayability, –∞—É–¥–∏—Ç

**5. CQRS (Command Query Responsibility Segregation)**
- Commands (–∏–∑–º–µ–Ω–µ–Ω–∏—è) –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç Queries (—á—Ç–µ–Ω–∏–µ)
- Commands ‚Äî side-effectful, Queries ‚Äî side-effect-free
- –†–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è

**6. Two-Phase Commit (2PC)**
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- Prepare + Commit —Ñ–∞–∑—ã
- –ú–µ–¥–ª–µ–Ω–Ω–æ, —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–ª—É—á—à–µ —Å–∞–≥–∏)

### –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã (—á–µ–≥–æ –∏–∑–±–µ–≥–∞—Ç—å)

**‚ùå –ù–µ–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å at-least-once delivery**
- –ü—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –†–µ—à–µ–Ω–∏–µ: –¥–æ–±–∞–≤–∏—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

**‚ùå –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ Event Sourcing**
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å replay
- –†–µ—à–µ–Ω–∏–µ: –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–±—ã—Ç–∏—è—Ö

**‚ùå Side effects –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ë–î –±–µ–∑ Outbox**
- –†–∏—Å–∫ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ (–ë–î –æ–±–Ω–æ–≤–ª–µ–Ω–∞, email –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω)
- –†–µ—à–µ–Ω–∏–µ: Outbox pattern

**‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ deduplication –¥–ª—è external side effects**
- –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è email, –ø–ª–∞—Ç–µ–∂–∏
- –†–µ—à–µ–Ω–∏–µ: deduplication table –∏–ª–∏ Idempotency-Key

**‚ùå –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —Å–æ–±—ã—Ç–∏–π**
- Race conditions, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –†–µ—à–µ–Ω–∏–µ: Kafka partitioning, sequence numbers

**‚ùå –°–º–µ—à–∏–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö side effects**
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –†–µ—à–µ–Ω–∏–µ: —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

---

**–ü–æ–º–Ω–∏—Ç–µ**: –≤—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–µ–º–∞–Ω—Ç–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∞ –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏–µ, –≤–ª–∏—è—é—â–µ–µ –Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å —É—Å—Ç–æ–π—á–∏–≤—ã–µ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã.
