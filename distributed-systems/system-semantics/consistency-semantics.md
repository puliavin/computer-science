# Consistency Semantics (–°–µ–º–∞–Ω—Ç–∏–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö)

## –í–≤–µ–¥–µ–Ω–∏–µ

–ö–æ–≥–¥–∞ —Ç—ã —Ä–∞–±–æ—Ç–∞–µ—à—å —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, –æ–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è: **–∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —É–∑–ª–∞–º–∏?** –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ç—Ä–∏ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞—Ö. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä, –∫–æ–≥–¥–∞ –¥—Ä—É–≥–∏–µ –∫–ª–∏–µ–Ω—Ç—ã —É–≤–∏–¥—è—Ç —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è? –ò —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ ‚Äî **—á—Ç–æ –æ–Ω–∏ —É–≤–∏–¥—è—Ç?**

–ú–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ (consistency models) ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª –∏ –≥–∞—Ä–∞–Ω—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–µ–¥—ë—Ç —Å–µ–±—è –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏. –≠—Ç–æ —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ "–∫–æ–Ω—Ç—Ä–∞–∫—Ç" –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–æ–π –∏ –µ—ë –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

### –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?

–ë–µ–∑ —á—ë—Ç–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ —Ç—ã –º–æ–∂–µ—à—å —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Å —Ç–∞–∫–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏:

- üí∏ **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–∞ —Å—á—ë—Ç–µ 1000‚ÇΩ, —Å–ø–∏—Å—ã–≤–∞–µ—Ç 500‚ÇΩ, –Ω–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ –µ—â—ë –æ–¥–Ω–æ —Å–ø–∏—Å–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –æ–Ω –Ω–µ –≤–∏–¥–µ–ª.
- üîÑ **–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –î–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∏–∑ –Ω–∏—Ö –±–µ—Å—Å–ª–µ–¥–Ω–æ –∏—Å—á–µ–∑–∞—é—Ç.
- üìä **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –û—Ç—á—ë—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫, —Å–æ–∑–¥–∞–≤–∞—è –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –±–æ–ª—å—à–µ, —á–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤).
- üêõ **–ù–µ–æ–±—ä—è—Å–Ω–∏–º—ã–µ –±–∞–≥–∏**: "–ù–æ —É –º–µ–Ω—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ!" ‚Äî –∫–ª–∞—Å—Å–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —á–∞—Å—Ç–æ —Å–≤—è–∑–∞–Ω–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –≤ dev –∏ prod –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö.

### –°–ø–µ–∫—Ç—Ä –º–æ–¥–µ–ª–µ–π: –æ—Ç —Å—Ç—Ä–æ–≥–∏—Ö –∫ —Å–ª–∞–±—ã–º

–ú–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –Ω–∞ —à–∫–∞–ª–µ –æ—Ç **—Å–∞–º—ã—Ö —Å—Ç—Ä–æ–≥–∏—Ö** (–¥–∞—é—Ç –º–∞–∫—Å–∏–º—É–º –≥–∞—Ä–∞–Ω—Ç–∏–π, –Ω–æ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –∑–∞—Ç—Ä–∞—Ç) –¥–æ **—Å–∞–º—ã—Ö —Å–ª–∞–±—ã—Ö** (–¥–∞—é—Ç –º–∏–Ω–∏–º—É–º –≥–∞—Ä–∞–Ω—Ç–∏–π, –Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –±—ã—Å—Ç—Ä–µ–µ).

```
–°–¢–†–û–ì–ò–ï                                                    –°–õ–ê–ë–´–ï
(–º–µ–¥–ª–µ–Ω–Ω—ã–µ, –≥–∞—Ä–∞–Ω—Ç–∏–∏)                           (–±—ã—Å—Ç—Ä—ã–µ, –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏–π)
    |                                                           |
    v                                                           v
[Linearizability] ‚Üí [Sequential] ‚Üí [Serializable] ‚Üí [Causal] ‚Üí [Eventual]
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å**: –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç "–ª—É—á—à–µ–π" –º–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏. –í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π —Ç–≤–æ–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö trade-offs –º–µ–∂–¥—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å—é, –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.

---

## Global Consistency Models (–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏)

–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å–∏–ª—å–Ω—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –æ —Ç–æ–º, –∫–∞–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã –≤–æ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–µ. –û–Ω–∏ —Å–æ–∑–¥–∞—é—Ç –∏–ª–ª—é–∑–∏—é –µ–¥–∏–Ω–æ–≥–æ, —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö, –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã.

---

### Strict Consistency (–°—Ç—Ä–æ–≥–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å)

**Strict Consistency** ‚Äî —ç—Ç–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –≤ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ–º–∞ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–õ—é–±–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è —á—Ç–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç **—Å–∞–º–æ–π –ø–æ—Å–ª–µ–¥–Ω–µ–π** –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –≤ –∞–±—Å–æ–ª—é—Ç–Ω–æ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

–ü—Ä–µ–¥—Å—Ç–∞–≤—å –∏–¥–µ–∞–ª—å–Ω—ã–π –º–∏—Ä, –≥–¥–µ:
1. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (–∫–∞–∫ –±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∞—Å—ã –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π)
2. –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
3. –õ—é–±–æ–µ —á—Ç–µ–Ω–∏–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤–∏–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–∏–∑–æ—à–ª–∞ —Ä–∞–Ω—å—à–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è ‚Üí

–ö–ª–∏–µ–Ω—Ç A:  ----W(x=1)-------------------------R(x)‚Üí–¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 2
–ö–ª–∏–µ–Ω—Ç B:  ---------------W(x=2)------------------------
–ö–ª–∏–µ–Ω—Ç C:  -------------------------------R(x)‚Üí–¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 2
```

–ï—Å–ª–∏ –ö–ª–∏–µ–Ω—Ç B –∑–∞–ø–∏—Å–∞–ª `x=2` –≤ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ T2, —Ç–æ **–ª—é–±–æ–µ** —á—Ç–µ–Ω–∏–µ –ø–æ—Å–ª–µ T2 (–¥–∞–∂–µ —á–µ—Ä–µ–∑ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥—É) **–æ–±—è–∑–∞–Ω–æ** –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 2, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –Ω–∞ –∫–∞–∫–æ–º —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á—Ç–µ–Ω–∏–µ.

#### –ü–æ—á–µ–º—É —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏?

1. **–ù–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏**: –¢–µ–æ—Ä–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≠–π–Ω—à—Ç–µ–π–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞–º, —á—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –í —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –ø—Ä–æ–±–ª–µ–º–∞ –µ—â—ë –æ—Å—Ç—Ä–µ–µ ‚Äî —á–∞—Å—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö –∏–¥—É—Ç —Å —Ä–∞–∑–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞ (–æ–±—ã—á–Ω–æ —Ç–æ—á–Ω–æ—Å—Ç—å ¬±100–º—Å –¥–∞–∂–µ —Å NTP).

2. **–°–∫–æ—Ä–æ—Å—Ç—å —Å–≤–µ—Ç–∞ –∫–æ–Ω–µ—á–Ω–∞**: –î–∞–∂–µ –µ—Å–ª–∏ –±—ã –º—ã –º–æ–≥–ª–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ —É–∑–ª—ã —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏. –°–∏–≥–Ω–∞–ª –º–µ–∂–¥—É –ú–æ—Å–∫–≤–æ–π –∏ –°–∞–Ω-–§—Ä–∞–Ω—Ü–∏—Å–∫–æ –∏–¥—ë—Ç –º–∏–Ω–∏–º—É–º ~60–º—Å (–∏ —ç—Ç–æ —Ç–æ–ª—å–∫–æ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–≤–µ—Ç–∞ –≤ –æ–ø—Ç–æ–≤–æ–ª–æ–∫–Ω–µ, –±–µ–∑ —É—á—ë—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏).

3. **–°–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã**: –î–∞–∂–µ –≤ –æ–¥–Ω–æ–º –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã.

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

Strict Consistency –≤–∞–∂–Ω–∞ –∫–∞–∫ **—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π —ç—Ç–∞–ª–æ–Ω** ‚Äî –æ–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É —Ç–æ–≥–æ, —á—Ç–æ –≤–æ–æ–±—â–µ –≤–æ–∑–º–æ–∂–Ω–æ. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ ‚Äî —ç—Ç–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å–ª–∞–±–ª—è—é—Ç —ç—Ç–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã —Å–∏—Å—Ç–µ–º–∞ –º–æ–≥–ª–∞ —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å.

üí° **–ö–ª—é—á–µ–≤–∞—è –º—ã—Å–ª—å**: –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –∏—Ö —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç strict consistency –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å—Ä–µ–¥–µ ‚Äî –æ–Ω–∏ –ª–∏–±–æ –æ—à–∏–±–∞—é—Ç—Å—è, –ª–∏–±–æ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

---

### Linearizability (–õ–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç—å / Strong Consistency / Atomic Consistency)

**Linearizability** ‚Äî —ç—Ç–æ —Å–∞–º–∞—è —Å–∏–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∞–ª–∏–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏. –ï—ë —Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞—é—Ç **Strong Consistency** –∏–ª–∏ **Atomic Consistency**.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å **–∞—Ç–æ–º–∞—Ä–Ω–æ** –≤ **–Ω–µ–∫–æ—Ç–æ—Ä–æ–º** –≥–ª–æ–±–∞–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≥–ª–∞—Å—É–µ—Ç—Å—è —Å —Ä–µ–∞–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π.

–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Strict Consistency: –º—ã –Ω–µ —Ç—Ä–µ–±—É–µ–º, —á—Ç–æ–±—ã —ç—Ç–æ—Ç –ø–æ—Ä—è–¥–æ–∫ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–æ–≤–ø–∞–¥–∞–ª —Å –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –≥–ª–æ–±–∞–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º. –ú—ã —Ç—Ä–µ–±—É–µ–º –ª–∏—à—å, —á—Ç–æ–±—ã:

1. **–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è (–ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –æ–¥–Ω–æ–π —Ç–æ—á–∫–µ –≤—Ä–µ–º–µ–Ω–∏)
2. **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º**: –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è A –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Ä–∞–Ω—å—à–µ, —á–µ–º –Ω–∞—á–∞–ª–∞—Å—å –æ–ø–µ—Ä–∞—Ü–∏—è B (–ø–æ –Ω–∞—Å—Ç–æ—è—â–∏–º —á–∞—Å–∞–º), —Ç–æ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ A –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–µ—Ä–µ–¥ B
3. **–ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫**: –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤–∏–¥—è—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è ‚Üí

–ö–ª–∏–µ–Ω—Ç A:  [----W(x=1)----]                    [R(x)‚Üí?]
–ö–ª–∏–µ–Ω—Ç B:                    [----W(x=2)----]
–ö–ª–∏–µ–Ω—Ç C:                                          [R(x)‚Üí?]

–õ–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫: W_A(x=1) ‚Üí W_B(x=2) ‚Üí R_A(x)‚Üí2 ‚Üí R_C(x)‚Üí2
```

–ü–æ—Å–∫–æ–ª—å–∫—É `W(x=2)` –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –¥–æ –Ω–∞—á–∞–ª–∞ `R(x)`, –≤—Å–µ —á—Ç–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å 2.

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: –±–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å—á—ë—Ç

–ü—Ä–µ–¥—Å—Ç–∞–≤—å –±–∞–Ω–∫–æ–≤—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
  10:00:00.000  –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤–∏–¥–∏—Ç –±–∞–ª–∞–Ω—Å: 1000‚ÇΩ
  10:00:05.000  –ü–µ—Ä–µ–≤–æ–¥–∏—Ç 500‚ÇΩ –¥—Ä—É–≥—É
  10:00:05.500  –ó–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à—ë–Ω —É—Å–ø–µ—à–Ω–æ ‚úì
  10:00:06.000  –û–±–Ω–æ–≤–ª—è–µ—Ç —ç–∫—Ä–∞–Ω
  10:00:06.100  –í–∏–¥–∏—Ç –±–∞–ª–∞–Ω—Å: 500‚ÇΩ

–î—Ä—É–≥:
  10:00:05.600  –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
  10:00:05.700  –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∏–¥–∏—Ç –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è: 500‚ÇΩ
```

Linearizability –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç: –µ—Å–ª–∏ —Ç–≤–æ—è –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å (—Ç—ã –ø–æ–ª—É—á–∏–ª –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞), –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–≤–∏–¥—è—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–≤–æ–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: Kafka –±–µ–∑ linearizability

**–í–∞–∂–Ω–æ**: –æ–±—ã—á–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Kafka **–Ω–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç** linearizability –¥–ª—è —á—Ç–µ–Ω–∏—è.

–°—Ü–µ–Ω–∞—Ä–∏–π:
1. Producer –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ M1 –≤ —Ç–æ–ø–∏–∫
2. Producer –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (acks=all)
3. Consumer1 —á–∏—Ç–∞–µ—Ç –∏–∑ partition leader ‚Äî –≤–∏–¥–∏—Ç M1 ‚úì
4. Consumer2 —á–∏—Ç–∞–µ—Ç –∏–∑ follower replica (—Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º Fetch from Follower) ‚Äî –º–æ–∂–µ—Ç **–Ω–µ –≤–∏–¥–µ—Ç—å** M1, –µ—Å–ª–∏ —Ä–µ–ø–ª–∏–∫–∞ –æ—Ç—Å—Ç–∞—ë—Ç

```
Timeline:

Producer:  [--publish(M1)--]‚Üíack
                                  ‚Üì
Leader:    [------M1 –∑–∞–ø–∏—Å–∞–Ω–æ-------][M2][M3]...
Follower:  [–ø—É—Å—Ç–æ]...[–æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ]...[M1 —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è]

Consumer1: (—á–∏—Ç–∞–µ—Ç leader)                [read‚ÜíM1] ‚úì
Consumer2: (—á–∏—Ç–∞–µ—Ç follower)  [read‚Üí–ø—É—Å—Ç–æ] ‚úó  ‚Üê –Ω–∞—Ä—É—à–µ–Ω–∏–µ linearizability!
```

#### –ö–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è Linearizability?

–¢–∏–ø–∏—á–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:

1. **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∑–∞–ø–∏—Å–∏**: –í—Å–µ –∑–∞–ø–∏—Å–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ –æ–¥–∏–Ω —É–∑–µ–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, leader –≤ Raft/Paxos)
   - –ü—Ä–∏–º–µ—Ä: PostgreSQL primary-replica, –≥–¥–µ –∑–∞–ø–∏—Å–∏ –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ –≤ primary

2. **Consensus –ø—Ä–æ—Ç–æ–∫–æ–ª—ã**: Raft, Paxos, Zab
   - –ü—Ä–∏–º–µ—Ä: etcd, Consul, ZooKeeper

3. **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è** —Å –∫–≤–æ—Ä—É–º–æ–º
   - –ü—Ä–∏–º–µ—Ä: PostgreSQL —Å synchronous_commit –∏ synchronous_standby_names

4. **Compare-and-Swap (CAS)** –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –ü—Ä–∏–º–µ—Ä: Redis —Å WATCH/MULTI/EXEC, Memcached CAS

#### –¶–µ–Ω–∞ Linearizability

‚ö†Ô∏è **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
- –í—ã—Å–æ–∫–∞—è latency, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –≥–µ–æ—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ (–Ω—É–∂–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —É–∑–ª–æ–≤)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ leader)

‚ö†Ô∏è **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**:
- –°–æ–≥–ª–∞—Å–Ω–æ CAP —Ç–µ–æ—Ä–µ–º–µ, linearizability –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö
- –ï—Å–ª–∏ leader –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ—Ç –∫–≤–æ—Ä—É–º–∞ ‚Äî —Å–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

#### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Linearizability?

‚úÖ –û–ø–µ—Ä–∞—Ü–∏–∏ –∞—Ç–æ–º–∞—Ä–Ω—ã –∏ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã
‚úÖ –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —á—Ç–µ–Ω–∏—è –µ—ë –≤–∏–¥—è—Ç
‚úÖ –ù–µ—Ç "–æ—Ç–∫–∞—Ç–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏" (–ø–æ—Å–ª–µ —á—Ç–µ–Ω–∏—è —Å–≤–µ–∂–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —É–≤–∏–¥–∏—à—å —Å—Ç–∞—Ä–æ–µ)
‚úÖ –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –≤–∏–¥—è—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç?

‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –Ω–∏–∑–∫—É—é latency
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞

#### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 1: –î–≤–æ–π–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ –¥–µ–Ω–µ–≥**

–°–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ Cassandra —Å eventual consistency –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–æ–º –±–æ–Ω—É—Å–Ω—ã—Ö –±–∞–ª–ª–æ–≤. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫—Ä—ã–ª –¥–≤–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –ø–æ–ø—ã—Ç–∞–ª—Å—è –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –±–∞–ª–ª—ã –¥–≤–∞–∂–¥—ã. –û–±–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–æ—à–ª–∏, —Ç–∞–∫ –∫–∞–∫ –∫–∞–∂–¥–∞—è —Ä–µ–ø–ª–∏–∫–∞ –≤–∏–¥–µ–ª–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–ª–æ–≤, –Ω–æ –Ω–µ –≤–∏–¥–µ–ª–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–æ–π —Ä–µ–ø–ª–∏–∫–∏.

**–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ PostgreSQL –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–∞–ª–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å linearizable reads.

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 2: Lost update –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

–î–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω—è–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Redis –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –û–±–∞ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –≤–µ—Ä—Å–∏—é, –∏–∑–º–µ–Ω–∏–ª–∏ —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—è –∏ –∑–∞–ø–∏—Å–∞–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ. –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –±—ã–ª–∏ –ø–æ—Ç–µ—Ä—è–Ω—ã.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis WATCH/MULTI/EXEC –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è linearizable compare-and-swap –æ–ø–µ—Ä–∞—Ü–∏–π.

---

### Sequential Consistency (–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å)

**Sequential Consistency** ‚Äî —ç—Ç–æ –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è —Å–ª–∞–±–µ–µ linearizability, –Ω–æ –≤—Å—ë –µ—â—ë –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–∏–ª—å–Ω—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ **–Ω–µ–∫–æ—Ç–æ—Ä–æ–º** –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∏ —ç—Ç–æ—Ç –ø–æ—Ä—è–¥–æ–∫ –æ–¥–∏–Ω–∞–∫–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ü—Ä–∏ —ç—Ç–æ–º –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è –≤ —ç—Ç–æ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –±—ã–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —ç—Ç–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Linearizability**: –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –ù–ï –æ–±—è–∑–∞–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
–ü—Ä–æ—Ü–µ—Å—Å P1:  W(x=1)  W(x=2)
–ü—Ä–æ—Ü–µ—Å—Å P2:  R(x)    R(x)

Linearizability —Ç—Ä–µ–±—É–µ—Ç:
  –ï—Å–ª–∏ R1 –Ω–∞—á–∞–ª–æ—Å—å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è W(x=2) –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏,
  —Ç–æ R1 –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 2.

Sequential Consistency –ø–æ–∑–≤–æ–ª—è–µ—Ç:
  W(x=1) ‚Üí W(x=2) ‚Üí R(x)‚Üí2 ‚Üí R(x)‚Üí2  ‚úì
  W(x=1) ‚Üí R(x)‚Üí1 ‚Üí W(x=2) ‚Üí R(x)‚Üí2  ‚úì (–µ—Å–ª–∏ R1 –Ω–µ –±—ã–ª–æ —Ç–æ—á–Ω–æ "–ø–æ—Å–ª–µ" W2)
  W(x=1) ‚Üí R(x)‚Üí1 ‚Üí R(x)‚Üí1 ‚Üí W(x=2)  ‚ùå (–Ω–∞—Ä—É—à–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π P1)
```

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å

–ü—Ä–µ–¥—Å—Ç–∞–≤—å –ª–µ–Ω—Ç—É –Ω–æ–≤–æ—Å—Ç–µ–π –≤ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏:

```
–ê–ª–∏—Å–∞ (–ø—Ä–æ—Ü–µ—Å—Å A):
  1. –ü—É–±–ª–∏–∫—É–µ—Ç –ø–æ—Å—Ç: "–ò–¥—É –≤ –∫–∏–Ω–æ"
  2. –ü—É–±–ª–∏–∫—É–µ—Ç –ø–æ—Å—Ç: "–§–∏–ª—å–º –æ—Ç–ª–∏—á–Ω—ã–π!"

–ë–æ–± (–ø—Ä–æ—Ü–µ—Å—Å B):
  1. –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–µ–Ω—Ç—É
  2. –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–µ–Ω—Ç—É —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É

Sequential Consistency –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç:
  - –ë–æ–± –í–°–ï–ì–î–ê —É–≤–∏–¥–∏—Ç –ø–æ—Å—Ç—ã –ê–ª–∏—Å—ã –≤ –ø–æ—Ä—è–¥–∫–µ: —Å–Ω–∞—á–∞–ª–∞ "–ò–¥—É –≤ –∫–∏–Ω–æ", –ø–æ—Ç–æ–º "–§–∏–ª—å–º –æ—Ç–ª–∏—á–Ω—ã–π"
  - –ë–æ–± –ù–ï —É–≤–∏–¥–∏—Ç —Å–Ω–∞—á–∞–ª–∞ "–§–∏–ª—å–º –æ—Ç–ª–∏—á–Ω—ã–π", –∞ –ø–æ—Ç–æ–º "–ò–¥—É –≤ –∫–∏–Ω–æ" (—ç—Ç–æ –±—ã–ª–æ –±—ã –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º)

Sequential Consistency –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç:
  - –ß—Ç–æ –ë–æ–± —É–≤–∏–¥–∏—Ç –≤—Ç–æ—Ä–æ–π –ø–æ—Å—Ç –ê–ª–∏—Å—ã –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ—Å–ª–µ –µ–≥–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
  - –ß—Ç–æ –¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–≤–∏–¥—è—Ç –ø–æ—Å—Ç—ã –≤ —Ç–æ—Ç –∂–µ –º–æ–º–µ–Ω—Ç, —á—Ç–æ –∏ –ë–æ–±
```

–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –ø–æ—Å—Ç—ã –ê–ª–∏—Å—ã –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, –Ω–æ **–º–æ–º–µ–Ω—Ç –ø–æ—è–≤–ª–µ–Ω–∏—è** –º–æ–∂–µ—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è.

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Linearizability

| –ê—Å–ø–µ–∫—Ç | Linearizability | Sequential Consistency |
|--------|----------------|----------------------|
| –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ | ‚úÖ –ï—Å—Ç—å | ‚úÖ –ï—Å—Ç—å |
| –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | ‚ùå –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| –û–ø–µ—Ä–∞—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ | –ë—ã—Å—Ç—Ä–µ–µ |

#### –ü—Ä–∏–º–µ—Ä: —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```
–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è ‚Üí

–ü—Ä–æ—Ü–µ—Å—Å 1: [--W(x=1)--]                  [--W(y=1)--]
–ü—Ä–æ—Ü–µ—Å—Å 2:              [--W(x=2)--]
–ü—Ä–æ—Ü–µ—Å—Å 3:                                          [R(x)‚Üí?][R(y)‚Üí?]

Linearizability —Ç—Ä–µ–±—É–µ—Ç:
  W(x=1) ‚Üí W(x=2) ‚Üí W(y=1) ‚Üí R(x)‚Üí2, R(y)‚Üí1
  (–ø–æ—Ç–æ–º—É —á—Ç–æ W(x=2) –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –¥–æ –Ω–∞—á–∞–ª–∞ W(y=1))

Sequential Consistency —Ä–∞–∑—Ä–µ—à–∞–µ—Ç:
  W(x=1) ‚Üí W(y=1) ‚Üí W(x=2) ‚Üí R(x)‚Üí2, R(y)‚Üí1  ‚úì
  (–ø–æ—Ä—è–¥–æ–∫ –º–µ–∂–¥—É W(x=2) –∏ W(y=1) –Ω–µ –≤–∞–∂–µ–Ω, –µ—Å–ª–∏ –æ–Ω–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)
```

#### –ö–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è Sequential Consistency?

1. **–õ–æ–≥–∏—á–µ—Å–∫–∏–µ —á–∞—Å—ã (Lamport timestamps)**
   - –ö–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫—É—é –º–µ—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏
   - –û–ø–µ—Ä–∞—Ü–∏–∏ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞—é—Ç—Å—è –ø–æ —ç—Ç–∏–º –º–µ—Ç–∫–∞–º

2. **Total Order Broadcast**
   - –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ–º —É–∑–ª–∞–º –≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º –ø–æ—Ä—è–¥–∫–µ

3. **–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä**
   - –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫

#### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Sequential Consistency?

‚úÖ –ï—Å—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
‚úÖ –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤–∏–¥—è—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
‚úÖ –ü–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
‚úÖ –ù–µ—Ç "–ø—Ä–∏—á–∏–Ω–Ω—ã—Ö –ø–∞—Ä–∞–¥–æ–∫—Å–æ–≤" –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

#### –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç?

‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∑–∞–ø–∏—Å—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤–∏–¥–Ω–∞ –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º
‚ùå –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç "—É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —á—Ç–µ–Ω–∏–π" –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

Sequential Consistency —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:
- –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª—è–µ–º—ã—Ö –ø–∞–º—è—Ç—è—Ö (DSM)
- –ù–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤
- –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª—è—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

–í —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–Ω–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Ä–µ–∂–µ, —Ç–∞–∫ –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü–∞ —Å linearizability –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–ø—Ä–∞–≤–¥—ã–≤–∞–µ—Ç –≤—ã–≥–æ–¥—É –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

### Serializable Consistency (–°–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–æ—Å—Ç—å)

**Serializability** ‚Äî —ç—Ç–æ –º–æ–¥–µ–ª—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ **—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö**, –∞ –Ω–µ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–∫–∏–º –∂–µ, –∫–∞–∫ –ø—Ä–∏ **–Ω–µ–∫–æ—Ç–æ—Ä–æ–º** –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —ç—Ç–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏: –Ω–µ–≤–∞–∂–Ω–æ, –∫–∞–∫ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø–µ—Ä–µ–º–µ—à–∞–ª–∏—Å—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–∑–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π ‚Äî –∫–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–∫–∏–º, –∫–∞–∫ –±—É–¥—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –æ–¥–Ω–∞ –∑–∞ –¥—Ä—É–≥–æ–π –≤ –∫–∞–∫–æ–º-—Ç–æ –ø–æ—Ä—è–¥–∫–µ.

#### –ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Linearizability

**Linearizability** –≥–æ–≤–æ—Ä–∏—Ç –æ–± –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏.
**Serializability** –≥–æ–≤–æ—Ä–∏—Ç –æ –≥—Ä—É–ø–ø–∞—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö).

–í–∞–∂–Ω–æ: –º–æ–∂–Ω–æ –∏–º–µ—Ç—å serializability –±–µ–∑ linearizability, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç!

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T1:
  READ(x)  ‚Üí –ø–æ–ª—É—á–∞–µ—Ç 100
  READ(y)  ‚Üí –ø–æ–ª—É—á–∞–µ—Ç 200
  WRITE(x = x + 10)

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T2:
  READ(x)  ‚Üí –ø–æ–ª—É—á–∞–µ—Ç 100
  READ(y)  ‚Üí –ø–æ–ª—É—á–∞–µ—Ç 200
  WRITE(y = y + 20)

–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (interleaving):
  T1: READ(x)‚Üí100
  T2: READ(x)‚Üí100
  T2: READ(y)‚Üí200
  T1: READ(y)‚Üí200
  T1: WRITE(x=110)
  T2: WRITE(y=220)

–≠—Ç–æ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–æ, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: T1, –∑–∞—Ç–µ–º T2 (–∏–ª–∏ T2, –∑–∞—Ç–µ–º T1).
–†–µ–∑—É–ª—å—Ç–∞—Ç: x=110, y=220 ‚úì
```

–¢–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ—Ä –ù–ï—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```
–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç: x + y = 300 (–≤—Å–µ–≥–¥–∞!)

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T1: –ø–µ—Ä–µ–≤–æ–¥–∏—Ç 10 —Å x –Ω–∞ y
  READ(x)  ‚Üí 100
  READ(y)  ‚Üí 200
  WRITE(x = 90)
  WRITE(y = 210)

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T2: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç
  READ(x)
  READ(y)
  CHECK(x + y == 300)

–ù–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
  T1: READ(x)‚Üí100
  T1: WRITE(x=90)
  T2: READ(x)‚Üí90        ‚Üê T2 –≤–∏–¥–∏—Ç –Ω–æ–≤—ã–π x
  T2: READ(y)‚Üí200       ‚Üê –Ω–æ —Å—Ç–∞—Ä—ã–π y!
  T2: CHECK(90+200==300) ‚Üí FALSE ‚ùå
  T1: WRITE(y=210)

–ù–µ—Ç —Ç–∞–∫–æ–≥–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ T1,T2 –∏–ª–∏ T2,T1, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–ª –±—ã —Ç–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!
```

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: –±–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥

```
–°—á—ë—Ç Alice: 1000‚ÇΩ
–°—á—ë—Ç Bob:   500‚ÇΩ

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T1: Alice ‚Üí Bob: 200‚ÇΩ
  BEGIN
  SELECT balance FROM accounts WHERE name='Alice'  ‚Üí 1000
  UPDATE accounts SET balance=800 WHERE name='Alice'
  UPDATE accounts SET balance=700 WHERE name='Bob'
  COMMIT

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞
  BEGIN
  SELECT SUM(balance) FROM accounts  ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 1500‚ÇΩ!
  COMMIT
```

**–°–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**:
- –ï—Å–ª–∏ T2 –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –¥–æ T1: —Å—É–º–º–∞ = 1500‚ÇΩ ‚úì
- –ï—Å–ª–∏ T2 –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –ø–æ—Å–ª–µ T1: —Å—É–º–º–∞ = 1500‚ÇΩ ‚úì

**–ù–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**:
- T2 —á–∏—Ç–∞–µ—Ç –±–∞–ª–∞–Ω—Å Alice (800‚ÇΩ) –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è T1
- –ù–æ —á–∏—Ç–∞–µ—Ç –±–∞–ª–∞–Ω—Å Bob (500‚ÇΩ) –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è T1
- –°—É–º–º–∞ = 1300‚ÇΩ ‚ùå (–¥–µ–Ω—å–≥–∏ "–∏—Å—á–µ–∑–ª–∏"!)

#### –£—Ä–æ–≤–Ω–∏ –∏–∑–æ–ª—è—Ü–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ SQL

–ù–µ –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –∏–∑–æ–ª—è—Ü–∏–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç serializability!

| –£—Ä–æ–≤–µ–Ω—å –∏–∑–æ–ª—è—Ü–∏–∏ | Dirty Reads | Non-Repeatable Reads | Phantom Reads | Serializable? |
|-----------------|-------------|---------------------|---------------|---------------|
| READ UNCOMMITTED | ‚ùå –í–æ–∑–º–æ–∂–Ω—ã | ‚ùå –í–æ–∑–º–æ–∂–Ω—ã | ‚ùå –í–æ–∑–º–æ–∂–Ω—ã | ‚ùå –ù–ï–¢ |
| READ COMMITTED | ‚úÖ –ù–µ—Ç | ‚ùå –í–æ–∑–º–æ–∂–Ω—ã | ‚ùå –í–æ–∑–º–æ–∂–Ω—ã | ‚ùå –ù–ï–¢ |
| REPEATABLE READ | ‚úÖ –ù–µ—Ç | ‚úÖ –ù–µ—Ç | ‚ùå –í–æ–∑–º–æ–∂–Ω—ã | ‚ùå –ù–ï–¢ (–≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ) |
| SERIALIZABLE | ‚úÖ –ù–µ—Ç | ‚úÖ –ù–µ—Ç | ‚úÖ –ù–µ—Ç | ‚úÖ –î–ê |

**–í–∞–∂–Ω–æ**: –≤ PostgreSQL REPEATABLE READ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç serializability –±–ª–∞–≥–æ–¥–∞—Ä—è Serializable Snapshot Isolation (SSI), –Ω–æ —ç—Ç–æ –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ SQL.

#### –ö–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è Serializability?

1. **Two-Phase Locking (2PL)**
   - –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥
   - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±–µ—Ä—ë—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–µ—Ä–µ–¥ –∏—Ö –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ–º
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ MySQL InnoDB —Å SERIALIZABLE

2. **Serializable Snapshot Isolation (SSI)**
   - –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥
   - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —Å–Ω–∏–º–∫–∞—Ö (snapshots), –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ PostgreSQL

3. **Optimistic Concurrency Control (OCC)**
   - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
   - –ü—Ä–∏ –∫–æ–º–º–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
   - –ü—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ ‚Äî rollback –∏ retry

4. **Timestamp Ordering**
   - –ö–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π timestamp
   - –û–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ timestamps

#### –ü—Ä–∏–º–µ—Ä: PostgreSQL Serialization Failure

```
–°–µ—Å—Å–∏—è 1:
BEGIN TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SELECT * FROM accounts WHERE id=1;  ‚Üí balance=1000
-- ... –¥—É–º–∞–µ—Ç 10 —Å–µ–∫—É–Ω–¥ ...
UPDATE accounts SET balance=900 WHERE id=1;

–°–µ—Å—Å–∏—è 2:
BEGIN TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SELECT * FROM accounts WHERE id=1;  ‚Üí balance=1000
UPDATE accounts SET balance=800 WHERE id=1;
COMMIT;  ‚úì –£—Å–ø–µ—à–Ω–æ

–°–µ—Å—Å–∏—è 1 (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ):
COMMIT;
ERROR: could not serialize access due to concurrent update
```

PostgreSQL –æ–±–Ω–∞—Ä—É–∂–∏–ª, —á—Ç–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –Ω–∏ –æ–¥–Ω–æ–º—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É, –∏ –æ—Ç–∫–∞—Ç–∏–ª –æ–¥–Ω—É –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

#### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Serializability?

‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤–µ–¥—É—Ç —Å–µ–±—è —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
‚úÖ –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
‚úÖ –ù–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π —á—Ç–µ–Ω–∏—è (dirty reads, non-repeatable reads, phantom reads)
‚úÖ –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏

#### –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç?

‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ (–∫–∞–∫ linearizability)
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —É—Å–ø–µ—à–Ω—ã–π commit (–º–æ–≥—É—Ç –±—ã—Ç—å serialization failures)
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### –°–µ—Äializ–∞—Ü–∏—è vs Linear–∏–∑–∞—Ü–∏—è

–ú–æ–∂–Ω–æ –ª–∏ –∏–º–µ—Ç—å –æ–¥–Ω–æ –±–µ–∑ –¥—Ä—É–≥–æ–≥–æ?

**–î–∞!**

- **Serializable, –Ω–æ –Ω–µ Linearizable**: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T1 –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ T2 –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –Ω–æ –≤ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–æ–º –ø–æ—Ä—è–¥–∫–µ T1 –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è "–¥–æ" T2. –≠—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è serializability.

- **Linearizable, –Ω–æ –Ω–µ Serializable**: –û—Ç–¥–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –∞—Ç–æ–º–∞—Ä–Ω—ã –∏ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã, –Ω–æ –Ω–µ—Ç –ø–æ–Ω—è—Ç–∏—è "—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏" ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

–ò–¥–µ–∞–ª: **Strict Serializability** = Serializability + Linearizability
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º—ã
- –ò –ø–æ—Ä—è–¥–æ–∫ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏

–ü—Ä–∏–º–µ—Ä—ã: Google Spanner, CockroachDB (—á–∞—Å—Ç–∏—á–Ω–æ).

#### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 1: READ COMMITTED –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º–µ—Ä—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ PostgreSQL —Å –∏–∑–æ–ª—è—Ü–∏–µ–π READ COMMITTED –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ü—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞:

1. –ß–∏—Ç–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ ‚Üí 5 —à—Ç
2. –ü—Ä–æ–≤–µ—Ä–∫–∞: 5 >= 3 (–∑–∞–∫–∞–∑—ã–≤–∞–µ–º 3 —à—Ç) ‚úì
3. –°–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–∫–∞–∑
4. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –æ—Å—Ç–∞—Ç–æ–∫: 5 - 3 = 2 —à—Ç

–ü—Ä–æ–±–ª–µ–º–∞: –º–µ–∂–¥—É —á—Ç–µ–Ω–∏–µ–º (—à–∞–≥ 1) –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º (—à–∞–≥ 4) –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –º–æ–≥–ª–∞ –∏–∑–º–µ–Ω–∏—Ç—å –æ—Å—Ç–∞—Ç–æ–∫. –í –∏—Ç–æ–≥–µ –æ—Å—Ç–∞—Ç–æ–∫ —Å—Ç–∞–ª –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º (overselling).

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ REPEATABLE READ –∏–ª–∏ SERIALIZABLE, –ª–∏–±–æ SELECT FOR UPDATE –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å—Ç—Ä–æ–∫–∏.

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 2: –ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –ø–æ–∑–≤–æ–ª—è–ª–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏. –î–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª–∏ –æ–¥–Ω—É –∑–∞–¥–∞—á—É:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A:
  BEGIN;
  SELECT * FROM tasks WHERE id=42;  ‚Üí {title: "Fix bug", assignee: "Alice"}
  -- –ò–∑–º–µ–Ω—è–µ—Ç title
  UPDATE tasks SET title="Fix critical bug" WHERE id=42;
  COMMIT;

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B:
  BEGIN;
  SELECT * FROM tasks WHERE id=42;  ‚Üí {title: "Fix bug", assignee: "Alice"}
  -- –ò–∑–º–µ–Ω—è–µ—Ç assignee
  UPDATE tasks SET assignee="Bob" WHERE id=42;
  COMMIT;
```

–° –∏–∑–æ–ª—è—Ü–∏–µ–π READ COMMITTED –∏–∑–º–µ–Ω–µ–Ω–∏–µ title –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è A –±—ã–ª–æ –ø–æ—Ç–µ—Ä—è–Ω–æ! –û–±–∞ UPDATE –≤—ã–ø–æ–ª–Ω–∏–ª–∏—Å—å, –Ω–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–ª –≤—Å—é —Å—Ç—Ä–æ–∫—É.

**–†–µ—à–µ–Ω–∏–µ**: Optimistic locking —Å –ø–æ–ª–µ–º version –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SERIALIZABLE.

---

## Weaker Consistency Models (–°–ª–∞–±—ã–µ –º–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏)

–°–ª–∞–±—ã–µ –º–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –æ—Ç–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π –≤ –ø–æ–ª—å–∑—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏. –û–Ω–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω—ã –≤ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, –≥–¥–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ—Ç–Ω–∏ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥.

---

### Causal Consistency (–ü—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å)

**Causal Consistency** ‚Äî –æ–¥–Ω–∞ –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã—Ö —Å–ª–∞–±—ã—Ö –º–æ–¥–µ–ª–µ–π. –û–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π –∏–¥–µ–µ: –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏—á–∏–Ω–Ω–æ —Å–≤—è–∑–∞–Ω—ã, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∏–¥–Ω—ã –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è B –ø—Ä–∏—á–∏–Ω–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ A (–æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è A ‚Üí B), —Ç–æ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å A –ø–µ—Ä–µ–¥ B. –û–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–≤—è–∑–∞–Ω—ã –ø—Ä–∏—á–∏–Ω–Ω–æ, –º–æ–≥—É—Ç –±—ã—Ç—å –≤–∏–¥–Ω—ã –≤ —Ä–∞–∑–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.

**–ü—Ä–∏—á–∏–Ω–Ω–∞—è —Å–≤—è–∑—å** –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ —Ç—Ä—ë—Ö —Å–ª—É—á–∞—è—Ö:

1. **–ü–æ—Ä—è–¥–æ–∫ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ**: –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç A, –∑–∞—Ç–µ–º B, —Ç–æ A ‚Üí B
2. **–ß—Ç–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏**: –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å —á–∏—Ç–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Å–∏ A, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç B, —Ç–æ A ‚Üí B
3. **–¢—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ï—Å–ª–∏ A ‚Üí B –∏ B ‚Üí C, —Ç–æ A ‚Üí C

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
–ü—Ä–æ—Ü–µ—Å—Å 1:  W(x=1) ----------------‚Üí W(y=1)
                |                        |
                | reads                  |
                ‚Üì                        |
–ü—Ä–æ—Ü–µ—Å—Å 2:  R(x)‚Üí1 ‚Üí W(z=1)             |
                         |               |
                         | reads         | reads
                         ‚Üì               ‚Üì
–ü—Ä–æ—Ü–µ—Å—Å 3:           R(z)‚Üí1          R(y)‚Üí?

–ü—Ä–∏—á–∏–Ω–Ω–∞—è —Å–≤—è–∑—å:
  W(x=1) ‚Üí R(x)‚Üí1 ‚Üí W(z=1) ‚Üí R(z)‚Üí1
  W(x=1) ‚Üí W(y=1) ‚Üí R(y)‚Üí1

–°–ª–µ–¥—Å—Ç–≤–∏–µ:
  R(z)‚Üí1 –ø—Ä–∏—á–∏–Ω–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç W(x=1)
  R(y)‚Üí1 –ø—Ä–∏—á–∏–Ω–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç W(x=1)

Causal consistency –ù–ï —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Ä—è–¥–∫–∞ –º–µ–∂–¥—É R(z) –∏ R(y),
–ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –Ω–µ —Å–≤—è–∑–∞–Ω—ã –ø—Ä–∏—á–∏–Ω–Ω–æ –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º!
```

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: —á–∞—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```
–ê–ª–∏—Å–∞:  "–ö—Ç–æ –ø–æ–π–¥—ë—Ç –Ω–∞ –≤—Å—Ç—Ä–µ—á—É?"        [—Å–æ–æ–±—â–µ–Ω–∏–µ M1]
–ë–æ–±:    (—á–∏—Ç–∞–µ—Ç M1) "–Ø –ø–æ–π–¥—É!"          [—Å–æ–æ–±—â–µ–Ω–∏–µ M2]
–í–µ—Ä–∞:   (—á–∏—Ç–∞–µ—Ç M1) "–ò —è —Ç–æ–∂–µ!"         [—Å–æ–æ–±—â–µ–Ω–∏–µ M3]

–ü—Ä–∏—á–∏–Ω–Ω—ã–µ —Å–≤—è–∑–∏:
  M1 ‚Üí M2 (–ë–æ–± –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –≤–æ–ø—Ä–æ—Å –ê–ª–∏—Å—ã)
  M1 ‚Üí M3 (–í–µ—Ä–∞ –æ—Ç–≤–µ—Ç–∏–ª–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å –ê–ª–∏—Å—ã)
  M2 –∏ M3 –Ω–µ —Å–≤—è–∑–∞–Ω—ã –ø—Ä–∏—á–∏–Ω–Ω–æ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã)
```

**Causal Consistency –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç**:
- –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞ —É–≤–∏–¥—è—Ç M1 –ø–µ—Ä–µ–¥ M2
- –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —É–≤–∏–¥—è—Ç M1 –ø–µ—Ä–µ–¥ M3
- –ü–æ—Ä—è–¥–æ–∫ M2 –∏ M3 –º–æ–∂–µ—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

–£—á–∞—Å—Ç–Ω–∏–∫ 1 –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å:  M1, M2, M3
–£—á–∞—Å—Ç–Ω–∏–∫ 2 –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å:  M1, M3, M2  ‚Üê —ç—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ!

–û–±–∞ –ø–æ—Ä—è–¥–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ M2 –∏ M3 –Ω–µ —Å–≤—è–∑–∞–Ω—ã –ø—Ä–∏—á–∏–Ω–Ω–æ.

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏

| –ú–æ–¥–µ–ª—å | –¢—Ä–µ–±—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞? | –¢—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏? | –¢—Ä–µ–±—É–µ—Ç –ø—Ä–∏—á–∏–Ω–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞? |
|--------|----------------------------|---------------------------|---------------------------|
| Linearizability | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ (–∫–∞–∫ —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π) |
| Sequential | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ (–∫–∞–∫ —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π) |
| Causal | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏

Facebook –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —á—Ç–æ-—Ç–æ –ø–æ—Ö–æ–∂–µ–µ –Ω–∞ causal consistency –¥–ª—è –Ω–æ–≤–æ—Å—Ç–Ω–æ–π –ª–µ–Ω—Ç—ã:

```
–°–∏—Ç—É–∞—Ü–∏—è:
  10:00  –ê–ª–∏—Å–∞ —Å–æ–∑–¥–∞—ë—Ç –ø–æ—Å—Ç: "–ù–∞—à–ª–∞ –∫–æ—Ç—ë–Ω–∫–∞!"           [P1]
  10:01  –ë–æ–± –∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç: "–ö–∞–∫–æ–π –º–∏–ª—ã–π!"               [C1 ‚Üí –∑–∞–≤–∏—Å–∏—Ç –æ—Ç P1]
  10:02  –í–µ—Ä–∞ –ª–∞–π–∫–∞–µ—Ç –ø–æ—Å—Ç P1                           [L1 ‚Üí –∑–∞–≤–∏—Å–∏—Ç –æ—Ç P1]

Causal consistency –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç:
  ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –≤–∏–¥—è—â–∏–µ C1, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∏–¥—è—Ç P1
  ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –≤–∏–¥—è—â–∏–µ L1, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∏–¥—è—Ç P1
  ‚ùå –ü–æ—Ä—è–¥–æ–∫ –º–µ–∂–¥—É C1 –∏ L1 –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ú–æ—Å–∫–≤–µ –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å:    P1, C1, L1
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ù—å—é-–ô–æ—Ä–∫–µ –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å: P1, L1, C1
```

–≠—Ç–æ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: –≤–∞–∂–Ω–æ –Ω–µ –≤–∏–¥–µ—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–∞–Ω—å—à–µ —Å–∞–º–æ–≥–æ –ø–æ—Å—Ç–∞, –Ω–æ –Ω–µ–≤–∞–∂–Ω–æ, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ä–µ–∞–∫—Ü–∏–∏.

#### –ö–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è Causal Consistency?

1. **Vector Clocks (–í–µ–∫—Ç–æ—Ä–Ω—ã–µ —á–∞—Å—ã)**
   - –ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —á–∞—Å–æ–≤
   - –ü—Ä–∏ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤–µ–∫—Ç–æ—Ä–∞
   - –ú–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω–Ω—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, —Å—Ä–∞–≤–Ω–∏–≤–∞—è –≤–µ–∫—Ç–æ—Ä—ã

2. **Dependency Tracking (–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)**
   - –ö–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç, –æ—Ç –∫–∞–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –æ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç
   - –û–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

3. **Consistent Hashing + Gossip**
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ gossip –ø—Ä–æ—Ç–æ–∫–æ–ª
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏—á–∏–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö

#### –ü—Ä–∏–º–µ—Ä—ã —Å–∏—Å—Ç–µ–º

- **Cassandra** (—Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏)
- **Riak** (—Å dotted version vectors)
- **Azure Cosmos DB** (Eventual Consistency –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –±–ª–∏–∂–µ –∫ causal –¥–ª—è session)
- **MongoDB** (Causal Consistency sessions)

#### MongoDB: Causal Consistency Sessions

MongoDB –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç causal consistency —á–µ—Ä–µ–∑ **client sessions**:

```
–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:
  Session 1:
    write(x=1)  ‚Üí operation time T1
    write(y=1)  ‚Üí operation time T2 (T2 > T1)

  Session 2 (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–º –∫–ª–∏–µ–Ω—Ç–µ):
    read(y)‚Üí1 at time T2
    read(x)‚Üí?  ‚Üí –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤–µ—Ä–Ω—ë—Ç 1, –ø–æ—Ç–æ–º—É —á—Ç–æ T2 >= T1
```

–ö–ª–∏–µ–Ω—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç "operation time" –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –µ–≥–æ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø—Ä–∏—á–∏–Ω–Ω—É—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å.

#### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Causal Consistency?

‚úÖ –ü—Ä–∏—á–∏–Ω–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–Ω—ã –≤—Å–µ–º–∏ –≤ –æ–¥–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
‚úÖ –ù–µ—Ç "–ø—Ä–∏—á–∏–Ω–Ω—ã—Ö –ø–∞—Ä–∞–¥–æ–∫—Å–æ–≤" (—ç—Ñ—Ñ–µ–∫—Ç –Ω–µ –≤–∏–¥–µ–Ω –¥–æ –ø—Ä–∏—á–∏–Ω—ã)
‚úÖ –ß–∏—Ç–∞—Ç—å —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏ (read-your-writes) ‚Äî —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π –ø—Ä–∏—á–∏–Ω–Ω–æ—Å—Ç–∏
‚úÖ Monotonic reads ‚Äî –µ—Å–ª–∏ –ø—Ä–æ—á–∏—Ç–∞–ª –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–µ —É–≤–∏–¥–∏—à—å —Å—Ç–∞—Ä–æ–µ
‚úÖ Monotonic writes ‚Äî –∑–∞–ø–∏—Å–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–∏–¥–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ –∑–∞–ø–∏—Å–∏

#### –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç?

‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤–∏–¥—è—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤ –æ–¥–∏–Ω –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏
‚ùå –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∑–∞–ø–∏—Å–µ–π (–Ω—É–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤)

#### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 1: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–∞–Ω—å—à–µ –ø–æ—Å—Ç–∞**

–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ eventual consistency –±–µ–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–∏—á–∏–Ω–Ω—ã—Ö —Å–≤—è–∑–µ–π. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–ª –ø–æ—Å—Ç, –∑–∞—Ç–µ–º —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–∏–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π. –ò–∑-–∑–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥–µ–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–∞–Ω—å—à–µ —Å–∞–º–æ–≥–æ –ø–æ—Å—Ç–∞!

```
–ù–∞–±–ª—é–¥–µ–Ω–∏–µ:
  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç: "–°–æ–≥–ª–∞—Å–µ–Ω!" (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)
  –ù–æ –Ω–µ –≤–∏–¥–∏—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –ø–æ—Å—Ç
  ‚Üí –ü–æ–ª–Ω–∞—è –ø—É—Ç–∞–Ω–∏—Ü–∞
```

**–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ causal consistency –¥–ª—è —Å–≤—è–∑–∏ –ø–æ—Å—Ç–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 2: –ù–∞—Ä—É—à–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏**

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–ª–∞–¥–æ–º:

```
–û–ø–µ—Ä–∞—Ü–∏–∏:
  1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞—ë—Ç —Ç–æ–≤–∞—Ä ITEM-123
  2. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ü–µ–Ω—É 100‚ÇΩ
  3. –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ç–æ–≤–∞—Ä, –Ω–æ —Ü–µ–Ω–∞ –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ ‚Üí NULL
  4. –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∫—É–ø–∏—Ç—å ‚Äî –æ—à–∏–±–∫–∞ –∏–ª–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
```

–ë–µ–∑ causal consistency –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å —Ç–æ–≤–∞—Ä –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ —É–≤–∏–¥–∏—Ç –µ–≥–æ —Ü–µ–Ω—É, —á—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–ª–∏ causal consistency –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

---

### PRAM Consistency (Pipelined RAM)

**PRAM Consistency** (—Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **Processor Consistency**) ‚Äî —ç—Ç–æ –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è —Å–ª–∞–±–µ–µ causal consistency, –Ω–æ —Å–∏–ª—å–Ω–µ–µ eventual consistency.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤–∏–¥—è—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –±—ã–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –ù–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å –≤–∏–¥–Ω—ã –≤ —Ä–∞–∑–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.

–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:
- ‚úÖ –ü–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–π
- ‚ùå –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è

**–û—Ç–ª–∏—á–∏–µ –æ—Ç Causal Consistency**: PRAM –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏—á–∏–Ω–Ω—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (read-from –æ—Ç–Ω–æ—à–µ–Ω–∏—è).

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
–ü—Ä–æ—Ü–µ—Å—Å P1:  W(x=1) ‚Üí W(x=2)
–ü—Ä–æ—Ü–µ—Å—Å P2:  W(y=1) ‚Üí W(y=2)

–ü—Ä–æ—Ü–µ—Å—Å P3 –Ω–∞–±–ª—é–¥–∞–µ—Ç:
  W(x=1) ‚Üí W(x=2) ‚Üí W(y=1) ‚Üí W(y=2)  ‚úì OK

–ü—Ä–æ—Ü–µ—Å—Å P4 –Ω–∞–±–ª—é–¥–∞–µ—Ç:
  W(y=1) ‚Üí W(x=1) ‚Üí W(y=2) ‚Üí W(x=2)  ‚úì OK (–¥—Ä—É–≥–æ–π –ø–æ—Ä—è–¥–æ–∫ –º–µ–∂–¥—É P1 –∏ P2)

–ü—Ä–æ—Ü–µ—Å—Å P5 –Ω–∞–±–ª—é–¥–∞–µ—Ç:
  W(x=2) ‚Üí W(x=1) ‚Üí ...  ‚ùå –ù–ê–†–£–®–ï–ù–ò–ï! (–æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π P1)
```

–ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ P1 –∏ P2 –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã–º–∏ –ø–æ-—Å–≤–æ–µ–º—É, –Ω–æ –ø–æ—Ä—è–¥–æ–∫ –≤–Ω—É—Ç—Ä–∏ P1 –∏ –≤–Ω—É—Ç—Ä–∏ P2 –≤—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.

#### –û—Ç–ª–∏—á–∏–µ –æ—Ç Causal Consistency

```
–ü—Ä–æ—Ü–µ—Å—Å P1:  W(x=1)
–ü—Ä–æ—Ü–µ—Å—Å P2:  R(x)‚Üí1 ‚Üí W(y=1)
–ü—Ä–æ—Ü–µ—Å—Å P3:  R(y)‚Üí1 ‚Üí R(x)‚Üí?

Causal Consistency:
  R(y)‚Üí1 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç W(y=1), –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç W(x=1)
  –ü–æ—ç—Ç–æ–º—É R(x) –û–ë–Ø–ó–ê–ù–û –≤–µ—Ä–Ω—É—Ç—å 1 ‚úì

PRAM Consistency:
  –ù–µ—Ç –ø—Ä–∏—á–∏–Ω–Ω–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É W(x=1) –∏ W(y=1) (—Ä–∞–∑–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã!)
  R(x) –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å 0 (—Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ) ‚úì –î–æ–ø—É—Å—Ç–∏–º–æ!
```

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–µ–¥—Å—Ç–∞–≤—å primary-replica —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–æ–π:

```
Primary:
  10:00:00  UPDATE users SET name='Alice' WHERE id=1
  10:00:01  UPDATE users SET email='alice@example.com' WHERE id=1
  10:00:02  UPDATE products SET price=100 WHERE id=42

Replica 1 –ø–æ–ª—É—á–∞–µ—Ç:
  10:00:05  UPDATE users SET name='Alice' WHERE id=1
  10:00:06  UPDATE users SET email='alice@example.com' WHERE id=1
  10:00:07  UPDATE products SET price=100 WHERE id=42

Replica 2 –ø–æ–ª—É—á–∞–µ—Ç:
  10:00:04  UPDATE products SET price=100 WHERE id=42  ‚Üê —Ä–∞–Ω—å—à–µ!
  10:00:05  UPDATE users SET name='Alice' WHERE id=1
  10:00:06  UPDATE users SET email='alice@example.com' WHERE id=1
```

**PRAM –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç**:
- –ù–∞ –æ–±–µ–∏—Ö —Ä–µ–ø–ª–∏–∫–∞—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è `users.id=1` –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ: —Å–Ω–∞—á–∞–ª–∞ name, –ø–æ—Ç–æ–º email
- –ù–æ –º–æ–º–µ–Ω—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `products.id=42` –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π `users` –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –ª–µ–Ω—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Alice:
  1. –ü—É–±–ª–∏–∫—É–µ—Ç: "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!"
  2. –ü—É–±–ª–∏–∫—É–µ—Ç: "–ò–¥—É –Ω–∞ —Ä–∞–±–æ—Ç—É"

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Bob:
  1. –ü—É–±–ª–∏–∫—É–µ—Ç: "–û—Ç–ª–∏—á–Ω–∞—è –ø–æ–≥–æ–¥–∞"
  2. –ü—É–±–ª–∏–∫—É–µ—Ç: "–ö—É–ø–∏–ª –∫–æ—Ñ–µ"

–ü–æ–¥–ø–∏—Å—á–∏–∫ Charlie –≤–∏–¥–∏—Ç:
  Alice: "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!" ‚Üí Alice: "–ò–¥—É –Ω–∞ —Ä–∞–±–æ—Ç—É" ‚Üí Bob: "–û—Ç–ª–∏—á–Ω–∞—è –ø–æ–≥–æ–¥–∞" ‚Üí Bob: "–ö—É–ø–∏–ª –∫–æ—Ñ–µ"
  ‚úì –ü–æ—Ä—è–¥–æ–∫ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω

–ü–æ–¥–ø–∏—Å—á–∏–∫ Diana –≤–∏–¥–∏—Ç:
  Bob: "–û—Ç–ª–∏—á–Ω–∞—è –ø–æ–≥–æ–¥–∞" ‚Üí Alice: "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!" ‚Üí Bob: "–ö—É–ø–∏–ª –∫–æ—Ñ–µ" ‚Üí Alice: "–ò–¥—É –Ω–∞ —Ä–∞–±–æ—Ç—É"
  ‚úì –ü–æ—Ä—è–¥–æ–∫ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω, –Ω–æ –ø–µ—Ä–µ–º–µ—à–∞–Ω –º–µ–∂–¥—É –∞–≤—Ç–æ—Ä–∞–º–∏ –ø–æ-–¥—Ä—É–≥–æ–º—É
```

#### –ö–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è PRAM Consistency?

1. **FIFO –∫–∞–Ω–∞–ª—ã –¥–æ—Å—Ç–∞–≤–∫–∏**
   - –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –æ–¥–Ω–æ–≥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –ø–æ–ª—É—á–∞—Ç–µ–ª—é –≤ –ø–æ—Ä—è–¥–∫–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
   - –ù–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Ä–∞–∑–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π –º–æ–≥—É—Ç –æ–±–≥–æ–Ω—è—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞

2. **Per-process sequence numbers**
   - –ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –Ω—É–º–µ—Ä—É–µ—Ç —Å–≤–æ–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –ø–æ—Ä—è–¥–∫–µ sequence numbers –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

3. **Write buffers / Pipelines**
   - –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –±—É—Ñ–µ—Ä–∏–∑–∏—Ä—É—é—Ç—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ FIFO
   - –û—Ç—Å—é–¥–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ "Pipelined RAM"

#### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç PRAM Consistency?

‚úÖ Writes –æ—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–∏–¥–Ω—ã –≤—Å–µ–º –≤ –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
‚úÖ Monotonic writes –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
‚úÖ Read-your-writes –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
‚úÖ –î–µ—à–µ–≤–ª–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å, —á–µ–º causal consistency

#### –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç?

‚ùå –ù–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–∏—á–∏–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å read-from –æ—Ç–Ω–æ—à–µ–Ω–∏–π
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

#### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

PRAM Consistency —Ä–µ–¥–∫–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –≤–∞–∂–Ω–∞:

- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã–µ –∫–µ—à–∏**: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Alpha) –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–ª–∏ —á—Ç–æ-—Ç–æ –±–ª–∏–∑–∫–æ–µ –∫ PRAM
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è**: –ú–Ω–æ–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π –¥–µ-—Ñ–∞–∫—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç PRAM –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π, –∏–¥—É—â–∏—Ö —Å –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- **Event sourcing**: –°–æ–±—ã—Ç–∏—è –æ—Ç –æ–¥–Ω–æ–≥–æ –∞–≥—Ä–µ–≥–∞—Ç–∞ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã, –Ω–æ —Å–æ–±—ã—Ç–∏—è –æ—Ç —Ä–∞–∑–Ω—ã—Ö –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –º–æ–≥—É—Ç –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—Ç—å—Å—è

---

### Eventual Consistency (–ö–æ–Ω–µ—á–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å)

**Eventual Consistency** ‚Äî –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö —Å–ª–∞–±—ã—Ö –∏ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. –ï—ë –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ–≤–æ—Ä–∏—Ç —Å–∞–º–æ –∑–∞ —Å–µ–±—è: –¥–∞–Ω–Ω—ã–µ **–≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ** —Å—Ç–∞–Ω—É—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–º–∏.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–ï—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É –ø–µ—Ä–µ—Å—Ç–∞–Ω—É—Ç –ø–æ—Å—Ç—É–ø–∞—Ç—å –Ω–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —Ç–æ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –≤—Å–µ —Ä–µ–ø–ª–∏–∫–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

–ó–≤—É—á–∏—Ç –ø—Ä–æ—Å—Ç–æ, –Ω–æ –¥—å—è–≤–æ–ª –≤ –¥–µ—Ç–∞–ª—è—Ö:
- ‚è∞ "–ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è" ‚Äî –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ, —Å–∫–æ–ª—å–∫–æ –∏–º–µ–Ω–Ω–æ
- ü§∑ –í–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å—ã –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å —Ä–∞–∑–Ω—ã–µ, –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- üîÑ –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π –Ω–∞ –ø–æ—Ä—è–¥–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞–Ω—É—Ç –≤–∏–¥–Ω—ã

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
–í—Ä–µ–º—è ‚Üí

–†–µ–ø–ª–∏–∫–∞ A:  [x=1] ----‚Üí [x=2] ----------------‚Üí [x=3] (—Ñ–∏–Ω–∞–ª)
–†–µ–ø–ª–∏–∫–∞ B:  [x=1] ---------‚Üí [x=3] ------‚Üí [x=2] ‚Üí [x=3] (—Ñ–∏–Ω–∞–ª)
–†–µ–ø–ª–∏–∫–∞ C:  [x=1] ---------------------‚Üí [x=2] ‚Üí [x=3] (—Ñ–∏–Ω–∞–ª)

                     ‚Üë
                     –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –≤—Å–µ —Ä–µ–ø–ª–∏–∫–∏ –≤–∏–¥—è—Ç —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è!
                     A –≤–∏–¥–∏—Ç x=2
                     B –≤–∏–¥–∏—Ç x=1 (—Å—Ç–∞—Ä–æ–µ!)
                     C –≤–∏–¥–∏—Ç x=1 (—Å—Ç–∞—Ä–æ–µ!)

                                             ‚Üë
                                             –í –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –≤—Å–µ —Å—Ö–æ–¥—è—Ç—Å—è –∫ x=3
```

–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ: –†–µ–ø–ª–∏–∫–∞ B –≤–∏–¥–µ–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º" –ø–æ—Ä—è–¥–∫–µ (—Å–Ω–∞—á–∞–ª–∞ x=3, –ø–æ—Ç–æ–º x=2)! –≠—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è eventual consistency.

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: DNS

DNS (Domain Name System) ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä eventual consistency:

```
–°–∏—Ç—É–∞—Ü–∏—è:
  1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–∑–º–µ–Ω—è–µ—Ç A-–∑–∞–ø–∏—Å—å example.com: 1.2.3.4 ‚Üí 5.6.7.8
  2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–Ω–æ—Å–∏—Ç—Å—è –≤ authoritative DNS —Å–µ—Ä–≤–µ—Ä
  3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏—Ç—å—Å—è –Ω–∞ —Ç—ã—Å—è—á–∏ DNS —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
  - –ß–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É: 10% DNS —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤–∏–¥—è—Ç –Ω–æ–≤—ã–π IP
  - –ß–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç: 70% –≤–∏–¥—è—Ç –Ω–æ–≤—ã–π IP
  - –ß–µ—Ä–µ–∑ 1 —á–∞—Å: 95% –≤–∏–¥—è—Ç –Ω–æ–≤—ã–π IP
  - –ß–µ—Ä–µ–∑ 24-48 —á–∞—Å–æ–≤: ~100% –≤–∏–¥—è—Ç –Ω–æ–≤—ã–π IP (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç TTL)

–í —Ç–µ—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:
  - –ß–∞—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å–æ —Å—Ç–∞—Ä—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
  - –ß–∞—Å—Ç—å ‚Äî —Å –Ω–æ–≤—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
  - –≠—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏!
```

**–†–µ–∞–ª—å–Ω—ã–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç**: –ö–æ–º–ø–∞–Ω–∏—è –º–µ–Ω—è–ª–∞ IP-–∞–¥—Ä–µ—Å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–æ –∑–∞–±—ã–ª–∞, —á—Ç–æ –Ω–∞ —Å—Ç–∞—Ä–æ–º IP —É –Ω–∏—Ö –≤—Å—ë –µ—â—ë –±—ã–ª SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å –∏—Å—Ç–µ–∫–∞—é—â–∏–º —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è. –ò–∑-–∑–∞ eventual consistency DNS —á–∞—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –µ—â—ë –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø–æ–ª—É—á–∞–ª–∞ SSL-–æ—à–∏–±–∫–∏.

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: Amazon S3

Amazon S3 –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **read-after-write consistency** –¥–ª—è PUT –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–æ **eventual consistency** –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ (overwrite) –∏ DELETE:

```
–°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
  1. PUT /bucket/new-file.txt "Hello"
  2. GET /bucket/new-file.txt ‚Üí "Hello" ‚úì (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤–∏–¥–Ω–æ)

–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –æ–±—ä–µ–∫—Ç–∞
  1. PUT /bucket/existing-file.txt "Version 1"
  2. PUT /bucket/existing-file.txt "Version 2"
  3. GET /bucket/existing-file.txt ‚Üí –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å "Version 1" –∏–ª–∏ "Version 2"!
  4. GET —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É ‚Üí —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ "Version 2"

–°—Ü–µ–Ω–∞—Ä–∏–π 3: –£–¥–∞–ª–µ–Ω–∏–µ
  1. DELETE /bucket/file.txt
  2. GET /bucket/file.txt ‚Üí –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ!
  3. LIST /bucket/ ‚Üí –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ —Å–ø–∏—Å–∫–µ!
  4. –ß–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –æ–±—ä–µ–∫—Ç –∏—Å—á–µ–∑–Ω–µ—Ç –≤–µ–∑–¥–µ
```

**–†–µ–∞–ª—å–Ω—ã–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–ª–æ –≤ S3 —Ñ–∞–π–ª —Å –æ—Ç—á—ë—Ç–æ–º, –∑–∞—Ç–µ–º —Å—Ä–∞–∑—É –ø—ã—Ç–∞–ª–æ—Å—å –µ–≥–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ email. –ò–Ω–æ–≥–¥–∞ GET –≤–æ–∑–≤—Ä–∞—â–∞–ª 404, —Ç–∞–∫ –∫–∞–∫ –æ–±—ä–µ–∫—Ç –µ—â—ë –Ω–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏–ª—Å—è –Ω–∞ –≤—Å–µ —Ä–µ–ø–ª–∏–∫–∏. –†–µ—à–µ–Ω–∏–µ: retry –ª–æ–≥–∏–∫–∞ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff.

#### Amazon DynamoDB: —Ç–æ–Ω–∫–æ—Å—Ç–∏ Eventual Consistency

DynamoDB –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç eventually consistent reads:

```
–ó–∞–ø–∏—Å—å:
  PutItem(id=42, value="new data")
  ‚Üí –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ leader —Ä–µ–ø–ª–∏–∫—É
  ‚Üí –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 2 –¥—Ä—É–≥–∏–µ —Ä–µ–ø–ª–∏–∫–∏

–ß—Ç–µ–Ω–∏–µ (Eventually Consistent Read):
  GetItem(id=42)
  ‚Üí –ß–∏—Ç–∞–µ—Ç—Å—è —Å —Å–ª—É—á–∞–π–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∏
  ‚Üí –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –µ—Å–ª–∏ —Ä–µ–ø–ª–∏–∫–∞ –µ—â—ë –Ω–µ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å
  ‚Üí –î–µ—à–µ–≤–ª–µ (0.5x —Å—Ç–æ–∏–º–æ—Å—Ç–∏ strongly consistent read)

–ß—Ç–µ–Ω–∏–µ (Strongly Consistent Read):
  GetItem(id=42, ConsistentRead=true)
  ‚Üí –ß–∏—Ç–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û —Å leader —Ä–µ–ø–ª–∏–∫–∏
  ‚Üí –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  ‚Üí –î–æ—Ä–æ–∂–µ (1x —Å—Ç–æ–∏–º–æ—Å—Ç–∏)
```

#### –¢–∏–ø–∏—á–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏ Eventual Consistency

**1. –ß—Ç–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö (Stale Reads)**

```
10:00:00  –ö–ª–∏–µ–Ω—Ç A –ø–∏—à–µ—Ç x=1 –≤ —Ä–µ–ø–ª–∏–∫—É R1
10:00:01  –†–µ–ø–ª–∏–∫–∞ R1 –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –Ω–∞ R2, R3
10:00:02  –ö–ª–∏–µ–Ω—Ç B —á–∏—Ç–∞–µ—Ç —Å —Ä–µ–ø–ª–∏–∫–∏ R2 ‚Üí x=0 (—Å—Ç–∞—Ä–æ–µ!)
10:00:05  –†–µ–ø–ª–∏–∫–∞ R2 –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí x=1
10:00:06  –ö–ª–∏–µ–Ω—Ç B —á–∏—Ç–∞–µ—Ç —Å —Ä–µ–ø–ª–∏–∫–∏ R2 ‚Üí x=1 (—Å–≤–µ–∂–µ–µ)
```

**2. –ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —á—Ç–µ–Ω–∏—è (Non-monotonic Reads)**

–¢—ã –º–æ–∂–µ—à—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∞ –∑–∞—Ç–µ–º —Å—Ç–∞—Ä–æ–µ:

```
–ö–ª–∏–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç —Å —Ä–µ–ø–ª–∏–∫–∏ R1 ‚Üí x=2 (—Å–≤–µ–∂–µ–µ)
–ö–ª–∏–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç —Å —Ä–µ–ø–ª–∏–∫–∏ R2 ‚Üí x=1 (—Å—Ç–∞—Ä—à–µ!)
```

–≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏, –µ—Å–ª–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–ø—Ä–∞–≤–∏–ª –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ä–µ–ø–ª–∏–∫–∏.

**3. –ù–∞—Ä—É—à–µ–Ω–∏–µ read-your-writes**

–¢—ã –∑–∞–ø–∏—Å–∞–ª –¥–∞–Ω–Ω—ã–µ, –Ω–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —á—Ç–µ–Ω–∏—è –Ω–µ –≤–∏–¥–∏—à—å –∏—Ö:

```
–ö–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç x=1 –≤ —Ä–µ–ø–ª–∏–∫—É R1
–ö–ª–∏–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç —Å —Ä–µ–ø–ª–∏–∫–∏ R2 ‚Üí x=0 (–Ω–µ –≤–∏–¥–∏—Ç —Å–≤–æ—é –∑–∞–ø–∏—Å—å!)
```

**4. –ö–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**

–î–≤–∞ –∫–ª–∏–µ–Ω—Ç–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–∏—à—É—Ç —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```
–ö–ª–∏–µ–Ω—Ç A –ø–∏—à–µ—Ç x=1 –≤ —Ä–µ–ø–ª–∏–∫—É R1
–ö–ª–∏–µ–Ω—Ç B –ø–∏—à–µ—Ç x=2 –≤ —Ä–µ–ø–ª–∏–∫—É R2

–ö–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ "–ø–æ–±–µ–¥–∏—Ç"?
‚Üí –ó–∞–≤–∏—Å–∏—Ç –æ—Ç conflict resolution —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏!
```

#### –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (Conflict Resolution)

–ü—Ä–∏ eventual consistency –Ω–µ–∏–∑–±–µ–∂–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã. –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:

**1. Last-Write-Wins (LWW)**

–ü–æ–±–µ–∂–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å —Å —Å–∞–º—ã–º –ø–æ–∑–¥–Ω–∏–º timestamp'–æ–º.

```
–ó–∞–ø–∏—Å—å A: x=1, timestamp=10:00:00.000
–ó–∞–ø–∏—Å—å B: x=2, timestamp=10:00:00.001

–†–µ–∑—É–ª—å—Ç–∞—Ç: x=2 (LWW –Ω–∞ –æ—Å–Ω–æ–≤–µ timestamp)
```

‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —á–∞—Å–æ–≤! –ï—Å–ª–∏ —á–∞—Å—ã —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã, –º–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å –±–æ–ª–µ–µ —Å–≤–µ–∂–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.

**–ü—Ä–∏–º–µ—Ä**: Riak, Cassandra (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

**2. Vector Clocks / Version Vectors**

–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.

```
–†–µ–ø–ª–∏–∫–∞ R1: x=1, version=[R1:1, R2:0]
–†–µ–ø–ª–∏–∫–∞ R2: x=2, version=[R1:0, R2:1]

–ü—Ä–∏ —Å–ª–∏—è–Ω–∏–∏: –ö–û–ù–§–õ–ò–ö–¢!
‚Üí –û–±–∞ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É
‚Üí –ö–ª–∏–µ–Ω—Ç —Ä–µ—à–∞–µ—Ç, –∫–∞–∫ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å (merge)
```

**–ü—Ä–∏–º–µ—Ä**: Riak —Å allow_mult=true, Voldemort.

**3. CRDTs (Conflict-free Replicated Data Types)**

–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å–µ–≥–¥–∞ –∏–º–µ—é—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ.

```
G-Counter (Grow-only Counter):
  –†–µ–ø–ª–∏–∫–∞ R1: increment() ‚Üí {R1:1, R2:0, R3:0}, value=1
  –†–µ–ø–ª–∏–∫–∞ R2: increment() ‚Üí {R1:0, R2:1, R3:0}, value=1

  –ü–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è: {R1:1, R2:1, R3:0}, value=2 ‚úì
  –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Ä–∞–∑—Ä–µ—à—ë–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
```

**–ü—Ä–∏–º–µ—Ä—ã**: Redis Sorted Sets (—á–∞—Å—Ç–∏—á–Ω–æ), Riak Data Types, Akka Distributed Data.

#### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Eventual Consistency?

‚úÖ –í –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤—Å–µ —Ä–µ–ø–ª–∏–∫–∏ —Å–æ–π–¥—É—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
‚úÖ –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (–º–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å –∏ –ø–∏—Å–∞—Ç—å –¥–∞–∂–µ –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö)
‚úÖ –ù–∏–∑–∫–∞—è latency (–Ω–µ –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
‚úÖ –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å

#### –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç?

‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—è
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç read-your-writes
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç monotonic reads
‚ùå –ù–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

#### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 1: –ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑-–∑–∞ LWW**

E-commerce –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ Cassandra –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–ª —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –Ω–æ—É—Ç–±—É–∫–∞:

```
–¢–µ–ª–µ—Ñ–æ–Ω:  –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä A, timestamp=10:00:00.100
–ù–æ—É—Ç–±—É–∫:  –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä B, timestamp=10:00:00.050

LWW resolution ‚Üí –í—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –¢–µ–ª–µ—Ñ–æ–Ω
–†–µ–∑—É–ª—å—Ç–∞—Ç: –∫–æ—Ä–∑–∏–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä A!
–¢–æ–≤–∞—Ä B –ø–æ—Ç–µ—Ä—è–Ω.
```

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ set-—Å–µ–º–∞–Ω—Ç–∏–∫–∏ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã (union –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π) –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ CRDT (ORSet).

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 2: –£–¥–∞–ª—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–æ—Å–∫—Ä–µ—Å–ª–∏**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–ª–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ Cassandra. –ù–æ –∏–∑-–∑–∞ eventual consistency –∏ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º:

```
1. –ó–∞–ø–∏—Å—å x —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ –≤—Å–µ—Ö —Ä–µ–ø–ª–∏–∫–∞—Ö
2. –ó–∞–ø–∏—Å—å x —É–¥–∞–ª–µ–Ω–∞ ‚Üí tombstone –Ω–∞ —Ä–µ–ø–ª–∏–∫–∞—Ö R1, R2
3. –†–µ–ø–ª–∏–∫–∞ R3 –±—ã–ª–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–∞ tombstone
4. –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç anti-entropy repair –º–µ–∂–¥—É R3 –∏ R1
5. R3 —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ x –∞–∫—Ç—É–∞–ª–µ–Ω, R1 —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ x —É–¥–∞–ª—ë–Ω
6. –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –≤ –ø–æ–ª—å–∑—É —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
7. x "–≤–æ—Å–∫—Ä–µ—Å–∞–µ—Ç" –Ω–∞ –≤—Å–µ—Ö —Ä–µ–ø–ª–∏–∫–∞—Ö!
```

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ tombstones —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º TTL (gc_grace_seconds –≤ Cassandra).

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 3: –ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**

Reporting —Å–∏—Å—Ç–µ–º–∞ —á–∏—Ç–∞–ª–∞ –¥–∞–Ω–Ω—ã–µ –∏–∑ DynamoDB —Å eventually consistent reads –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ—Ç—á—ë—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏:

```
–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: 100,000‚ÇΩ
–°—É–º–º–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
  - –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞: 40,000‚ÇΩ
  - –û–¥–µ–∂–¥–∞: 35,000‚ÇΩ
  - –ö–Ω–∏–≥–∏: 20,000‚ÇΩ
  –ò—Ç–æ–≥–æ: 95,000‚ÇΩ  ‚Üê –ù–µ —Å—Ö–æ–¥–∏—Ç—Å—è!
```

–ü—Ä–∏—á–∏–Ω–∞: –†–∞–∑–Ω—ã–µ read –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ø–∞–¥–∞–ª–∏ –Ω–∞ —Ä–µ–ø–ª–∏–∫–∏ —Å —Ä–∞–∑–Ω–æ–π —Å—Ç–µ–ø–µ–Ω—å—é –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ strongly consistent reads –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (ETL –≤ Data Warehouse).

---

### Strong Eventual Consistency (SEC)

**Strong Eventual Consistency** ‚Äî —ç—Ç–æ —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è eventual consistency, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–±–∞–≤–ª—è–µ—Ç –≤–∞–∂–Ω—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –≤ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

Strong Eventual Consistency –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–≤–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–≤–æ–π—Å—Ç–≤–∞:

1. **Eventual Consistency**: –†–µ–ø–ª–∏–∫–∏, –ø–æ–ª—É—á–∏–≤—à–∏–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –Ω–∞–±–æ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π, –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (–∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—è)

2. **Strong Convergence**: –†–µ–ø–ª–∏–∫–∏, –ø–æ–ª—É—á–∏–≤—à–∏–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –Ω–∞–±–æ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π, –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ **–±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤**

–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ: –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ**.

#### CRDTs: –æ—Å–Ω–æ–≤–∞ SEC

**CRDTs (Conflict-free Replicated Data Types)** ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç strong eventual consistency.

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è: –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—ã, –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã, –ø–æ—ç—Ç–æ–º—É –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–µ –≤–∞–∂–µ–Ω.

**–¢–∏–ø—ã CRDTs:**

**1. State-based CRDTs (CvRDTs)**
- –†–µ–ø–ª–∏–∫–∏ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –ø–æ–ª–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- –°–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ merge —Ñ—É–Ω–∫—Ü–∏—é
- Merge –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω–æ–π, –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–π –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–π

**2. Operation-based CRDTs (CmRDTs)**
- –†–µ–ø–ª–∏–∫–∏ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- –û–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∫–æ–º–º—É—Ç–∏—Ä–æ–≤–∞—Ç—å

#### –ü—Ä–∏–º–µ—Ä—ã CRDT —Å—Ç—Ä—É–∫—Ç—É—Ä

**1. G-Counter (Grow-only Counter)**

–°—á—ë—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è.

```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
  {replica1: 5, replica2: 3, replica3: 2}

–û–ø–µ—Ä–∞—Ü–∏—è increment –Ω–∞ replica1:
  {replica1: 6, replica2: 3, replica3: 2}

–ó–Ω–∞—á–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞: sum = 6 + 3 + 2 = 11

Merge –¥–≤—É—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π:
  State A: {r1: 5, r2: 3, r3: 2}
  State B: {r1: 4, r2: 5, r3: 2}

  Merged: {r1: max(5,4), r2: max(3,5), r3: max(2,2)}
        = {r1: 5, r2: 5, r3: 2}

  –ò—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 12
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç**: max() –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–µ–Ω –∏ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–µ–Ω, –ø–æ—ç—Ç–æ–º—É –ø–æ—Ä—è–¥–æ–∫ merge –Ω–µ –≤–∞–∂–µ–Ω.

**2. PN-Counter (Positive-Negative Counter)**

–°—á—ë—Ç—á–∏–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞ –∏ –¥–µ–∫—Ä–µ–º–µ–Ω—Ç–∞.

```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
  P (positive): {r1: 10, r2: 5, r3: 3}
  N (negative): {r1: 2,  r2: 1, r3: 0}

–ó–Ω–∞—á–µ–Ω–∏–µ: sum(P) - sum(N) = 18 - 3 = 15

Increment –Ω–∞ r1: P.r1 += 1
Decrement –Ω–∞ r1: N.r1 += 1
```

**3. G-Set (Grow-only Set)**

–ú–Ω–æ–∂–µ—Å—Ç–≤–æ, –≤ –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã.

```
–†–µ–ø–ª–∏–∫–∞ R1: {"apple", "banana"}
–†–µ–ø–ª–∏–∫–∞ R2: {"banana", "cherry"}

Merge: union
Result: {"apple", "banana", "cherry"}
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.

**4. OR-Set (Observed-Remove Set)**

–ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —É–¥–∞–ª–µ–Ω–∏—è (—Å–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π CRDT).

```
–ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏–π:

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ:
  add("apple") ‚Üí add("apple", unique_id_1)

–£–¥–∞–ª–µ–Ω–∏–µ:
  remove("apple") ‚Üí remove –≤—Å–µ—Ö observed —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö ID –¥–ª—è "apple"

Merge:
  Elements: union –≤—Å–µ—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–π
  Tombstones: union –≤—Å–µ—Ö —É–¥–∞–ª–µ–Ω–∏–π
  Result: elements \ tombstones
```

**–ü–æ—á–µ–º—É —Å–ª–æ–∂–Ω–æ**: –ù—É–∂–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å "—É–¥–∞–ª–∏–ª–∏ —Å—Ç–∞—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ" –æ—Ç "–¥–æ–±–∞–≤–∏–ª–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è".

```
–°—Ü–µ–Ω–∞—Ä–∏–π:
  R1: add("apple")     ‚Üí {"apple"#1}
  R2: (replicated)     ‚Üí {"apple"#1}
  R2: remove("apple")  ‚Üí tombstone#1
  R1: add("apple")     ‚Üí {"apple"#1, "apple"#2}

  Merge:
    Elements: {"apple"#1, "apple"#2}
    Tombstones: {#1}
    Result: {"apple"#2} ‚úì

  "apple" –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ #2 –Ω–µ –±—ã–ª–æ observed –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏!
```

**5. LWW-Element-Set (Last-Write-Wins Set)**

–£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ OR-Set, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è timestamps.

```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
  Adds: {("apple", timestamp=100), ("banana", timestamp=200)}
  Removes: {("apple", timestamp=150)}

Element –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –µ—Å–ª–∏:
  max(add_timestamp) > max(remove_timestamp)

–î–ª—è "apple": max(100) < max(150) ‚Üí –£–¥–∞–ª—ë–Ω
–î–ª—è "banana": max(200) > 0 ‚Üí –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —á–∞—Å–æ–≤.

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: Google Docs

Google Docs –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º—ã, —Å—Ö–æ–∂–∏–µ —Å CRDT (—Ö–æ—Ç—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —ç—Ç–æ Operational Transformation):

```
–î–æ–∫—É–º–µ–Ω—Ç: "Hello world"

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A (–æ—Ñ—Ñ–ª–∞–π–Ω):
  –í—Å—Ç–∞–≤–ª—è–µ—Ç "beautiful " –≤ –ø–æ–∑–∏—Ü–∏—é 6
  ‚Üí "Hello beautiful world"

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B (–æ—Ñ—Ñ–ª–∞–π–Ω):
  –í—Å—Ç–∞–≤–ª—è–µ—Ç "wonderful " –≤ –ø–æ–∑–∏—Ü–∏—é 6
  ‚Üí "Hello wonderful world"

–ö–æ–≥–¥–∞ –æ–±–∞ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è:
  –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
  ‚Üí "Hello beautiful wonderful world" (–∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç, –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ)

  –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Ä–∞–∑—Ä–µ—à—ë–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!
```

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: Redis CRDT (Redis Enterprise)

Redis Enterprise –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç CRDT –¥–ª—è –≥–µ–æ—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏:

```
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
  - –†–µ–ø–ª–∏–∫–∞ –≤ –ú–æ—Å–∫–≤–µ
  - –†–µ–ø–ª–∏–∫–∞ –≤ –ù—å—é-–ô–æ—Ä–∫–µ
  - Active-Active —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
  –ú–æ—Å–∫–≤–∞:   INCRBY counter 5
  –ù—å—é-–ô–æ—Ä–∫: INCRBY counter 3

  –û–±–µ —Ä–µ–ø–ª–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä–≥–∏—Ä—É—é—Ç –∫: counter = 8 (–±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤!)

  –ú–æ—Å–∫–≤–∞:   SADD tags "redis" "database"
  –ù—å—é-–ô–æ—Ä–∫: SADD tags "cache" "database"

  –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –æ–±–µ–∏—Ö: tags = {"redis", "database", "cache"}
```

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è CRDTs

**1. –†–∞–∑–º–µ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö**

CRDTs —á–∞—Å—Ç–æ —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:

```
OR-Set –¥–ª—è 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å:
  - 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  - 10,000+ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö ID (–µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —á–∞—Å—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è/—É–¥–∞–ª—è—é—Ç—Å—è)
  - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ —Å–∞–º–∏—Ö –¥–∞–Ω–Ω—ã—Ö!
```

**2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**

–ù–µ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—ã–º–∏:

```
‚ùå "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ 0, –µ—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ > 100"
   (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–æ—Ä—è–¥–∫–∞ —Å –¥—Ä—É–≥–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏)

‚ùå "–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ X –≤ –ø–æ–∑–∏—Ü–∏—é Y"
   (—Å–ª–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—ã–º)

‚úÖ "Increment"
‚úÖ "Add to set"
‚úÖ "Merge registers with LWW"
```

**3. Garbage collection**

Tombstones –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è:

```
OR-Set:
  1 million —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–æ
  999,999 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–¥–∞–ª–µ–Ω–æ

  –í –ø–∞–º—è—Ç–∏:
    - 1 –∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
    - 999,999 tombstones ‚Üê –ù—É–∂–Ω–æ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—Ç—å!
```

#### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Strong Eventual Consistency?

‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—è
‚úÖ –†–∞–±–æ—Ç–∞ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
‚úÖ –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
‚úÖ –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ consensus –ø—Ä–æ—Ç–æ–∫–æ–ª–∞—Ö

#### –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç?

‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –Ω–∏–∑–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö (–∏–∑-–∑–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö)
‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—ã–µ)
‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç "–∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ" —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç merge –º–æ–∂–µ—Ç —É–¥–∏–≤–ª—è—Ç—å)

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

**–ì–¥–µ SEC –∏ CRDTs —Ä–∞–±–æ—Ç–∞—é—Ç —Ö–æ—Ä–æ—à–æ:**
- üìù –ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Google Docs, Figma)
- üõí –ö–æ—Ä–∑–∏–Ω—ã –ø–æ–∫—É–ø–æ–∫ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤)
- üë• –°–ø–∏—Å–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Ç–µ–≥–∏
- üìä –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—á—ë—Ç—á–∏–∫–∏ (increment-only)
- üåç –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–æ–º

**–ì–¥–µ SEC –∏ CRDTs –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç:**
- üí∞ –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–Ω—É–∂–Ω—ã —Å—Ç—Ä–æ–≥–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏)
- üîê –°–∏—Å—Ç–µ–º—ã —Å –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ ("–±–∞–ª–∞–Ω—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º")
- üìã –û–ø–µ—Ä–∞—Ü–∏–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ (–≤—ã–±–æ—Ä—ã –ª–∏–¥–µ—Ä–∞, —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å)

---

### Timeline Consistency

**Timeline Consistency** (—Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–∞ –∫–∞–∫ **Time-based Consistency**) ‚Äî —ç—Ç–æ –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–Ω—è—Ç–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π, –Ω–æ –≤ –±–æ–ª–µ–µ —Å–ª–∞–±–æ–º —Å–º—ã—Å–ª–µ, —á–µ–º linearizability.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–û–ø–µ—Ä–∞—Ü–∏–∏ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–º –≥–ª–æ–±–∞–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º (wall-clock time), –Ω–æ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞ (clock skew bound).

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:
- –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è A –ø—Ä–æ–∏–∑–æ—à–ª–∞ **–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–∞–Ω—å—à–µ** –æ–ø–µ—Ä–∞—Ü–∏–∏ B (—Å —É—á—ë—Ç–æ–º –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ —á–∞—Å–æ–≤), —Ç–æ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤–∏–¥—è—Ç A –ø–µ—Ä–µ–¥ B
- –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∏ "–ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ" (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏), –ø–æ—Ä—è–¥–æ–∫ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è

#### –û—Ç–ª–∏—á–∏–µ –æ—Ç Linearizability

```
Linearizability:
  –ï—Å–ª–∏ op_A –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –¥–æ –Ω–∞—á–∞–ª–∞ op_B –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏,
  —Ç–æ op_A –ø–µ—Ä–µ–¥ op_B –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.
  (–¢—Ä–µ–±—É–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏)

Timeline Consistency:
  –ï—Å–ª–∏ timestamp(op_A) + clock_skew < timestamp(op_B) - clock_skew,
  —Ç–æ op_A –ø–µ—Ä–µ–¥ op_B.
  (–î–æ–ø—É—Å–∫–∞–µ—Ç –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å —á–∞—Å–æ–≤)
```

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
Clock skew bound = 100ms

–û–ø–µ—Ä–∞—Ü–∏—è A: timestamp = 10:00:00.000
–û–ø–µ—Ä–∞—Ü–∏—è B: timestamp = 10:00:00.050
–û–ø–µ—Ä–∞—Ü–∏—è C: timestamp = 10:00:00.250

Timeline Consistency:
  A –∏ B "—Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–∏" (—Ä–∞–∑–Ω–∏—Ü–∞ 50ms < 2*100ms)
  ‚Üí –ü–æ—Ä—è–¥–æ–∫ –º–µ–∂–¥—É A –∏ B –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω

  A –∏ C "–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–ª–µ–∫–æ" (—Ä–∞–∑–Ω–∏—Ü–∞ 250ms > 2*100ms)
  ‚Üí A –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–µ—Ä–µ–¥ C

  B –∏ C "–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–ª–µ–∫–æ" (—Ä–∞–∑–Ω–∏—Ü–∞ 200ms ‚âà 2*100ms)
  ‚Üí –í–æ–∑–º–æ–∂–Ω–æ B –ø–µ—Ä–µ–¥ C, –Ω–æ –Ω–∞ –≥—Ä–∞–Ω–∏
```

#### Google Spanner: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Timeline Consistency

Google Spanner –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **TrueTime API**, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ `[earliest, latest]` –≤–º–µ—Å—Ç–æ —Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:

```
TrueTime.now() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
  [earliest: 10:00:00.000, latest: 10:00:00.007]

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç: "–ù–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –≥–¥–µ-—Ç–æ –≤ —ç—Ç–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ"
–®–∏—Ä–∏–Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ ‚âà 2 * clock_skew (–æ–±—ã—á–Ω–æ 1-7ms)
```

**–ö–∞–∫ Spanner –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∏–µ:**

```
–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T1:
  1. –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏
  2. –ì–æ—Ç–æ–≤–∞ –∫ commit –≤ –º–æ–º–µ–Ω—Ç TrueTime = [10:00:00.000, 10:00:00.007]
  3. –í—ã–±–∏—Ä–∞–µ—Ç commit timestamp = 10:00:00.007 (latest)
  4. –ñ–î–Å–¢ –¥–æ –º–æ–º–µ–Ω—Ç–∞ 10:00:00.007, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—à–ª–æ
  5. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–µ–ª–∞–µ—Ç commit –≤–∏–¥–∏–º—ã–º

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è T2 (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ commit T1):
  1. –ù–∞—á–∏–Ω–∞–µ—Ç —á—Ç–µ–Ω–∏–µ –≤ –º–æ–º–µ–Ω—Ç TrueTime = [10:00:00.008, 10:00:00.015]
  2. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç timestamp 10:00:00.008
  3. –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤–∏–¥–∏—Ç T1, –ø–æ—Ç–æ–º—É —á—Ç–æ 10:00:00.008 > 10:00:00.007
```

–≠—Ç–∞ —Ç–µ—Ö–Ω–∏–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **Commit Wait**.

#### –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

```
–°—Ü–µ–Ω–∞—Ä–∏–π: –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Å–æ —Å–∫–ª–∞–¥–∞–º–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö

–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (linearizability):
  - –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä
  - Latency: ~100-300ms –¥–ª—è –º–µ–∂–∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

–ü–æ–¥—Ö–æ–¥ Spanner (timeline consistency):
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
  - Commit wait –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ ~7ms –∑–∞–¥–µ—Ä–∂–∫–∏
  - Latency: ~10-30ms –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

  –ö–ª–∏–µ–Ω—Ç –≤ –ï–≤—Ä–æ–ø–µ:
    BEGIN TRANSACTION
    UPDATE inventory SET quantity=quantity-1 WHERE warehouse='EU'
    -- –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–º –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–µ
    COMMIT
    -- –∂–¥—ë—Ç 7ms (commit wait), –∑–∞—Ç–µ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—Ö

  –ö–ª–∏–µ–Ω—Ç –≤ –ê–∑–∏–∏:
    BEGIN TRANSACTION
    SELECT quantity FROM inventory WHERE warehouse='EU'
    -- –í–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è TrueTime
```

#### Clock Synchronization: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ!

Timeline consistency —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —á–∞—Å–æ–≤:

```
–ë–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
  –°–µ—Ä–≤–µ—Ä A: 10:00:00.000 (—á–∞—Å—ã –æ—Ç—Å—Ç–∞—é—Ç –Ω–∞ 1 —Å–µ–∫—É–Ω–¥—É)
  –°–µ—Ä–≤–µ—Ä B: 10:00:01.000 (—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è)

  –û–ø–µ—Ä–∞—Ü–∏—è –Ω–∞ A: timestamp = 10:00:00.500
  –û–ø–µ—Ä–∞—Ü–∏—è –Ω–∞ B: timestamp = 10:00:00.300

  –í–∏–∑—É–∞–ª—å–Ω–æ –æ–ø–µ—Ä–∞—Ü–∏—è A "—Ä–∞–Ω—å—à–µ", –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ B –±—ã–ª–∞ —Ä–∞–Ω—å—à–µ!
  ‚Üí –ù–∞—Ä—É—à–µ–Ω–∏–µ timeline consistency

–° Google TrueTime:
  - GPS –∏ –∞—Ç–æ–º–Ω—ã–µ —á–∞—Å—ã –≤ –∫–∞–∂–¥–æ–º –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–µ
  - –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
  - –ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –æ–±—ã—á–Ω–æ < 7ms
  - –í —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ < 10ms
```

#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã TrueTime

–ù–µ —É –≤—Å–µ—Ö –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞—Ç–æ–º–Ω—ã–º —á–∞—Å–∞–º Google! –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:

**1. NTP (Network Time Protocol)**
- –î–æ—Å—Ç—É–ø–Ω–æ –≤–µ–∑–¥–µ
- –¢–æ—á–Ω–æ—Å—Ç—å: –æ–±—ã—á–Ω–æ ¬±100ms, –≤ –ª—É—á—à–µ–º —Å–ª—É—á–∞–µ ¬±10ms
- ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –Ω–∏–∑–∫–æ–≥–æ clock_skew_bound

**2. PTP (Precision Time Protocol)**
- –¢—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ hardware
- –¢–æ—á–Ω–æ—Å—Ç—å: ~1-10Œºs –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

**3. Hybrid Logical Clocks (HLC)**
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —á–∞—Å–æ–≤
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ CockroachDB, YugabyteDB

```
HLC:
  - Physical time: –æ–±—ã—á–Ω–æ–µ wall-clock –≤—Ä–µ–º—è
  - Logical counter: —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö

  –ï—Å–ª–∏ physical times –±–ª–∏–∑–∫–∏, logical counter –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫
```

#### CockroachDB: HLC –≤–º–µ—Å—Ç–æ TrueTime

```
Node A –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é:
  HLC = (physical: 10:00:00.100, logical: 0)

Node B –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å HLC_A:
  Local HLC = (physical: 10:00:00.098, logical: 0)

  –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤–æ–π HLC:
  New HLC = (physical: max(10:00:00.098, 10:00:00.100), logical: 0+1)
           = (physical: 10:00:00.100, logical: 1)

  –¢–µ–ø–µ—Ä—å B "–ø–æ—Å–ª–µ" A –≤ HLC-–ø–æ—Ä—è–¥–∫–µ
```

#### –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Timeline Consistency?

‚úÖ –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ä–∞–∑—Ä—ã–≤–æ–º —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã
‚úÖ –í–Ω–µ—à–Ω—è—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (external consistency): –µ—Å–ª–∏ A –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –¥–æ –Ω–∞—á–∞–ª–∞ B –ø–æ —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏, —Ç–æ A –ø–µ—Ä–µ–¥ B
‚úÖ Snapshot reads –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏
‚úÖ –ù–∏–∑–∫–∞—è latency –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å linearizability –≤ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

#### –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç?

‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö clock_skew
‚ùå –¢—Ä–µ–±—É–µ—Ç –Ω–∞–¥—ë–∂–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ (infrastructure –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å)
‚ùå –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–∏—Å—Ç–µ–º –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–æ—á–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
‚ùå Clock skew –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è –ø—Ä–∏ —Å–±–æ—è—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

#### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 1: NTP —Å–±–æ–π**

–ö–æ–º–ø–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ —Å–∏—Å—Ç–µ–º—É —Å timeline consistency, –ø–æ–ª–∞–≥–∞—è—Å—å –Ω–∞ NTP:

```
–°–æ–±—ã—Ç–∏–µ:
  - NTP —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
  - –ß–∞—Å—ã –Ω–∞ –æ–¥–Ω–æ–º –∏–∑ —Å–µ—Ä–≤–µ—Ä–æ–≤ –Ω–∞—á–∞–ª–∏ –¥—Ä–µ–π—Ñ–æ–≤–∞—Ç—å
  - –ß–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–≥–ª–æ 30 —Å–µ–∫—É–Ω–¥

–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:
  - –û–ø–µ—Ä–∞—Ü–∏–∏ –∏–∑ "–±—É–¥—É—â–µ–≥–æ" –ø–æ—è–≤–ª—è–ª–∏—Å—å —Ä–∞–Ω—å—à–µ –æ–ø–µ—Ä–∞—Ü–∏–π –∏–∑ "–ø—Ä–æ—à–ª–æ–≥–æ"
  - –ù–∞—Ä—É—à–µ–Ω–∏–µ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - –î–∞–Ω–Ω—ã–µ —Å—Ç–∞–ª–∏ inconsistent
  - –ü—Ä–∏—à–ª–æ—Å—å –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å —á–∞—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```

**–†–µ—à–µ–Ω–∏–µ**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ clock skew, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —É–∑–ª–æ–≤ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ threshold.

**–ò–Ω—Ü–∏–¥–µ–Ω—Ç 2: Commit wait –≤ Spanner**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–æ commit wait –∑–∞–¥–µ—Ä–∂–∫—É:

```
–ö–æ–¥:
  start = time.now()
  db.execute("BEGIN")
  db.execute("UPDATE accounts SET balance=balance-100")
  db.execute("COMMIT")  # ‚Üê –ñ–¥—ë—Ç commit wait (~7ms)
  end = time.now()

  latency_metric.record(end - start)

–ü—Ä–æ–±–ª–µ–º–∞:
  - –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ–∂–∏–¥–∞–ª–∏ latency ~1-2ms
  - –ü–æ–ª—É—á–∞–ª–∏ latency ~8-10ms
  - –°—á–∏—Ç–∞–ª–∏ —ç—Ç–æ "performance regression"

–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ:
  - –≠—Ç–æ —à—Ç–∞—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ Spanner
  - Commit wait ‚Äî –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–π
```

---

## –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–æ–¥–µ–ª–µ–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏

| –ú–æ–¥–µ–ª—å | –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ | Real-time order | –ü—Ä–∏—á–∏–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å |
|--------|-------------------|-----------------|-------------------|-------------------------------------|-------------------|-------------|
| **Strict** | ‚úÖ –î–∞ | ‚úÖ –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ | ‚úÖ –î–∞ | N/A | üî¥ –ù–µ–≤–æ–∑–º–æ–∂–Ω–∞ | ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–∞ |
| **Linearizability** | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | üü° –°—Ä–µ–¥–Ω—è—è | üü° –°—Ä–µ–¥–Ω—è—è |
| **Sequential** | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | üü° –°—Ä–µ–¥–Ω—è—è | üü° –°—Ä–µ–¥–Ω—è—è |
| **Serializable** | ‚úÖ –î–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π | ‚ùå –ù–µ—Ç | ‚úÖ –î–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π | ‚ùå Rollback/retry | üü° –°—Ä–µ–¥–Ω—è—è | üü° –°—Ä–µ–¥–Ω—è—è |
| **Causal** | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | ‚ùå –ù—É–∂–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | üü¢ –í—ã—Å–æ–∫–∞—è | üü¢ –í—ã—Å–æ–∫–∞—è |
| **PRAM** | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | ‚ùå –ù—É–∂–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | üü¢ –í—ã—Å–æ–∫–∞—è | üü¢ –í—ã—Å–æ–∫–∞—è |
| **Eventual** | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù—É–∂–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | üü¢ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è | üü¢ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è |
| **Strong Eventual** | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚úÖ CRDTs | üü¢ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è | üü¢ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è |
| **Timeline** | ‚ö†Ô∏è –° —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ clock skew | ‚ö†Ô∏è –° —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ clock skew | ‚úÖ –î–∞ | ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | üü¢ –í—ã—Å–æ–∫–∞—è | üü¢ –í—ã—Å–æ–∫–∞—è |

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: –∫–∞–∫ –≤—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏?

### –ó–∞–¥–∞–π —Å–µ–±–µ –∫–ª—é—á–µ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**1. –ï—Å—Ç—å –ª–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–∞–Ω–Ω—ã—Ö?**

```
–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã ‚Äî –ø—Ä–∞–≤–∏–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –í–°–ï–ì–î–ê –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è:
  - "–ë–∞–ª–∞–Ω—Å —Å—á—ë—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º"
  - "–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—à–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ"
  - "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –±–µ–∑ email"

–ï—Å–ª–∏ –î–ê ‚Üí –ù—É–∂–Ω–∞ Linearizability –∏–ª–∏ Serializability
–ï—Å–ª–∏ –ù–ï–¢ ‚Üí –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–∞–±—ã–µ –º–æ–¥–µ–ª–∏
```

**2. –ö—Ä–∏—Ç–∏—á–Ω–∞ –ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ latency?**

```
–ï—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞ –Ω–∏–∑–∫–∞—è latency (< 10ms):
  ‚Üí Eventual / Strong Eventual / Causal Consistency

–ï—Å–ª–∏ –¥–æ–ø—É—Å—Ç–∏–º–∞ —Å—Ä–µ–¥–Ω—è—è latency (10-100ms):
  ‚Üí Linearizability / Timeline Consistency

–ï—Å–ª–∏ latency –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ (> 100ms –¥–æ–ø—É—Å—Ç–∏–º–∞):
  ‚Üí –õ—é–±–∞—è –º–æ–¥–µ–ª—å
```

**3. –ù–∞—Å–∫–æ–ª—å–∫–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞?**

```
–û–¥–Ω–∞ –ª–æ–∫–∞—Ü–∏—è (–æ–¥–∏–Ω –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä):
  ‚Üí Linearizability / Serializability –¥–æ—Å—Ç—É–ø–Ω—ã —Å —Ö–æ—Ä–æ—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

–ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–≥–∏–æ–Ω–æ–≤ (geo-distributed):
  ‚Üí Timeline / Causal / Eventual / Strong Eventual
  ‚Üí Linearizability –±—É–¥–µ—Ç –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ–π
```

**4. –ù—É–∂–Ω–∞ –ª–∏ —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö?**

```
–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ "—Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –ø—Ä–∏ network partition":
  ‚Üí Eventual / Strong Eventual / Causal (AP –≤ CAP)
  ‚Üí Linearizability –ù–ï –ø–æ–¥—Ö–æ–¥–∏—Ç (CP –≤ CAP)
```

**5. –ú–æ–∂–Ω–æ –ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã?**

```
–û–ø–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—ã (add to set, increment counter):
  ‚Üí Strong Eventual Consistency (CRDTs) –∏–¥–µ–∞–ª—å–Ω–∞

–û–ø–µ—Ä–∞—Ü–∏–∏ –ù–ï –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—ã (set value, conditional update):
  ‚Üí –ù—É–∂–Ω–∞ Linearizability / Serializability
```

### –ú–∞—Ç—Ä–∏—Ü–∞ –≤—ã–±–æ—Ä–∞ –ø–æ —Ç–∏–ø—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

| –¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –º–æ–¥–µ–ª—å | –ü–æ—á–µ–º—É |
|---------------|---------------------|--------|
| **–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** | Serializable / Linearizability | –ö—Ä–∏—Ç–∏—á–Ω—ã –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (–±–∞–ª–∞–Ω—Å >= 0) |
| **E-commerce –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å** | Serializable | –ù–µ–ª—å–∑—è oversell —Ç–æ–≤–∞—Ä—ã |
| **E-commerce –∫–æ—Ä–∑–∏–Ω–∞** | Strong Eventual (OR-Set) | –ú–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å —Ç–æ–≤–∞—Ä—ã –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ |
| **–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å (–ª–µ–Ω—Ç–∞)** | Causal / Eventual | –í–∞–∂–µ–Ω –ø—Ä–∏—á–∏–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø–æ—Å—Ç–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ |
| **–ß–∞—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** | Causal | –û—Ç–≤–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ—Å–ª–µ –≤–æ–ø—Ä–æ—Å–æ–≤ |
| **–ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | Strong Eventual (CRDT) | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ merge –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—á—ë—Ç—á–∏–∫–∏** | Strong Eventual (PN-Counter) | Increment-only, –º–æ–∂–Ω–æ merge |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** | Linearizability | –í—Å–µ –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é |
| **DNS** | Eventual | –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ consistency |
| **–ö–µ—à** | Eventual | Stale –¥–∞–Ω–Ω—ã–µ –¥–æ–ø—É—Å—Ç–∏–º—ã |
| **–õ–æ–≥–∏ / —Å–æ–±—ã—Ç–∏—è** | Causal / PRAM | –ü–æ—Ä—è–¥–æ–∫ —Å–æ–±—ã—Ç–∏–π –æ—Ç –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤–∞–∂–µ–Ω |
| **–†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** | Linearizability | –ö—Ä–∏—Ç–∏—á–Ω–∞ –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å |

### –¢–∏–ø–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ best practices

**1. –†–∞–∑–¥–µ–ª—è–π –¥–∞–Ω–Ω—ã–µ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏**

```
–ù–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –º–æ–¥–µ–ª—å –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è!

–ü—Ä–∏–º–µ—Ä: E-commerce

–°—Ç—Ä–æ–≥–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (PostgreSQL):
  - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  - –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
  - –û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ —Å–∫–ª–∞–¥–µ

–°–ª–∞–±–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (Cassandra):
  - –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
  - –õ–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

Strong Eventual (Redis CRDT):
  - –ö–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
  - Wishlist
  - –°—á—ë—Ç—á–∏–∫–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
```

**2. –ò—Å–ø–æ–ª—å–∑—É–π Session Guarantees –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è UX**

–î–∞–∂–µ —Å eventual consistency –º–æ–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å:

```
Read Your Writes:
  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏—Ç —Å–≤–æ–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è

  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
    - "Sticky sessions" (–∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞ —Ç—É –∂–µ —Ä–µ–ø–ª–∏–∫—É)
    - Version tracking (–∫–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–¥–∞—ë—Ç –≤–µ—Ä—Å–∏—é –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–∏—Å–∏)

Monotonic Reads:
  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç "–æ—Ç–∫–∞—Ç –≤–æ –≤—Ä–µ–º–µ–Ω–∏"

  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
    - –ß–∏—Ç–∞—Ç—å —Å —Ç–æ–π –∂–µ —Ä–µ–ø–ª–∏–∫–∏
    - –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å timestamp –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —á—Ç–µ–Ω–∏—è

Monotonic Writes:
  –ó–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
    - –ü–∏—Å–∞—Ç—å –≤ –æ–¥–Ω—É —Ä–µ–ø–ª–∏–∫—É (primary)
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sequence numbers
```

**3. Compensating Transactions –¥–ª—è eventual consistency**

–ï—Å–ª–∏ –Ω–µ–ª—å–∑—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç, –º–æ–∂–Ω–æ –µ–≥–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:

```
–°—Ü–µ–Ω–∞—Ä–∏–π: –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∏–∞–±–∏–ª–µ—Ç–æ–≤

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ –º–µ—Å—Ç–æ (eventual consistency)
   ‚Üí –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ

2. –î—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç —Ç–æ –∂–µ –º–µ—Å—Ç–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   ‚Üí –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ

3. –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç (overbooking)

4. Compensating transaction:
   - –í—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –º–µ–Ω—å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
   - –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–ò–∑–≤–∏–Ω–∏—Ç–µ, –º–µ—Å—Ç –Ω–µ—Ç"
   - –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è (—Å–∫–∏–¥–∫–∞, –¥—Ä—É–≥–æ–π —Ä–µ–π—Å)
```

**4. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ Optimistic Locking**

```
Eventual consistency + optimistic locking:

–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö:
  {
    "id": "user-123",
    "name": "Alice",
    "email": "alice@example.com",
    "version": 5  ‚Üê –í–µ—Ä—Å–∏—è
  }

–û–ø–µ—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
  1. –ß–∏—Ç–∞–µ—à—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é: v=5
  2. –ò–∑–º–µ–Ω—è–µ—à—å –ª–æ–∫–∞–ª—å–Ω–æ
  3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—à—å UPDATE —Å —É—Å–ª–æ–≤–∏–µ–º:
     UPDATE users SET name='Alicia', version=6
     WHERE id='user-123' AND version=5

  4. –ï—Å–ª–∏ version –∏–∑–º–µ–Ω–∏–ª–∞—Å—å ‚Üí –∫–æ–Ω—Ñ–ª–∏–∫—Ç!
     Retry: —á–∏—Ç–∞–π –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é, merge –∏–∑–º–µ–Ω–µ–Ω–∏—è
```

**5. CQRS (Command Query Responsibility Segregation)**

```
–†–∞–∑–¥–µ–ª—è–π write –∏ read –º–æ–¥–µ–ª–∏:

Write side (Commands):
  - –°—Ç—Ä–æ–≥–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (Linearizability)
  - PostgreSQL / MySQL
  - –ú–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

Read side (Queries):
  - Eventual consistency
  - Elasticsearch / Cassandra
  - –ë—ã—Å—Ç—Ä–æ, –Ω–æ –º–æ–∂–µ—Ç –æ—Ç—Å—Ç–∞–≤–∞—Ç—å

–°–≤—è–∑—å:
  - Event stream (Kafka)
  - Write-side –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è
  - Read-side –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

–ü—Ä–∏–º–µ—Ä:
  –ö–æ–º–∞–Ω–¥–∞ "CreateOrder" ‚Üí –ü–∏—à–µ—Ç—Å—è –≤ PostgreSQL (linearizable)
  Query "SearchOrders" ‚Üí –ß–∏—Ç–∞–µ—Ç—Å—è –∏–∑ Elasticsearch (eventual)
```

---

## –¢–∏–ø–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ –∫–∞–∫ —Å –Ω–∏–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ë–∞–ª–∞–Ω—Å –Ω–µ –º–æ–∂–µ—Ç —É–π—Ç–∏ –≤ –º–∏–Ω—É—Å
- –î–µ–Ω—å–≥–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã "–∏—Å—á–µ–∑–∞—Ç—å" –∏–ª–∏ "–¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è"
- –û–ø–µ—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞—Ç–æ–º–∞—Ä–Ω–æ–π

**–†–µ—à–µ–Ω–∏–µ: Serializable Transactions**

```
–°–∏—Å—Ç–µ–º–∞: PostgreSQL —Å SERIALIZABLE isolation

BEGIN TRANSACTION ISOLATION LEVEL SERIALIZABLE;

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
SELECT balance FROM accounts WHERE id = sender_id FOR UPDATE;
-- FOR UPDATE –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –±–∞–ª–∞–Ω—Å –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω
IF balance >= amount THEN
  UPDATE accounts SET balance = balance - amount WHERE id = sender_id;
  UPDATE accounts SET balance = balance + amount WHERE id = recipient_id;
  COMMIT;
ELSE
  ROLLBACK;
END IF;
```

**–ü–æ—á–µ–º—É –Ω–µ eventual consistency?**
- –î–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–∞ –º–æ–≥—É—Ç —É–≤–∏–¥–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –±–∞–ª–∞–Ω—Å
- –û–±–∞ –ø—Ä–æ–π–¥—É—Ç –ø—Ä–æ–≤–µ—Ä–∫—É, –±–∞–ª–∞–Ω—Å —É–π–¥—ë—Ç –≤ –º–∏–Ω—É—Å
- –ù–µ–¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ú–∏–ª–ª–∏–æ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å—Ç–∞–≤—è—Ç –ª–∞–π–∫–∏
- –ù–∏–∑–∫–∞—è latency –∫—Ä–∏—Ç–∏—á–Ω–∞
- –¢–æ—á–Ω–æ–µ —á–∏—Å–ª–æ –ª–∞–π–∫–æ–≤ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ (¬±5% –¥–æ–ø—É—Å—Ç–∏–º–æ)

**–†–µ—à–µ–Ω–∏–µ: Strong Eventual Consistency (PN-Counter CRDT)**

```
–°–∏—Å—Ç–µ–º–∞: Redis CRDT –∏–ª–∏ Riak Counters

–û–ø–µ—Ä–∞—Ü–∏—è:
  INCRBY post:42:likes 1  (—Ä–µ–ø–ª–∏–∫–∞ –≤ –ï–≤—Ä–æ–ø–µ)
  INCRBY post:42:likes 1  (—Ä–µ–ø–ª–∏–∫–∞ –≤ –ê–∑–∏–∏)

  –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ merge ‚Üí post:42:likes = 2

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
  - Latency < 5ms (–ª–æ–∫–∞–ª—å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)
  - –ù–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
  - –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
```

**–ü–æ—á–µ–º—É –Ω–µ linearizability?**
- –ü–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∞ –±—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏ (100+ ms latency)
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏ network partition
- –ù–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –º–∏–ª–ª–∏–æ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–π/—Å–µ–∫

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ß–∞—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –°–æ–æ–±—â–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –ª–æ–≥–∏—á–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- –û—Ç–≤–µ—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è —Ä–∞–Ω—å—à–µ –≤–æ–ø—Ä–æ—Å–æ–≤
- –ù–∏–∑–∫–∞—è latency –≤–∞–∂–Ω–∞

**–†–µ—à–µ–Ω–∏–µ: Causal Consistency**

```
–°–∏—Å—Ç–µ–º–∞: MongoDB —Å Causal Consistency Sessions

–ê–ª–∏—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ M1:
  session.write({text: "–ö—Ç–æ –ø–æ–π–¥—ë—Ç –Ω–∞ –≤—Å—Ç—Ä–µ—á—É?", id: M1})
  ‚Üí operation_time = T1

–ë–æ–± —á–∏—Ç–∞–µ—Ç –∏ –æ—Ç–≤–µ—á–∞–µ—Ç:
  session.read(after_time: T1)  ‚Üê –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤–∏–¥–∏—Ç M1
  session.write({text: "–Ø –ø–æ–π–¥—É!", reply_to: M1, id: M2})
  ‚Üí operation_time = T2

–í–µ—Ä–∞ —á–∏—Ç–∞–µ—Ç:
  session.read(after_time: T2)
  ‚Üí –í–∏–¥–∏—Ç M1 –∏ M2 –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
  - –ù–µ—Ç "–ø–∞—Ä–∞–¥–æ–∫—Å–æ–≤" (–æ—Ç–≤–µ—Ç –¥–æ –≤–æ–ø—Ä–æ—Å–∞)
  - Latency ~10-20ms
  - –ù–µ —Ç—Ä–µ–±—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Å—Ç –≤ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–µ

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ù–µ–ª—å–∑—è –ø—Ä–æ–¥–∞—Ç—å –æ–¥–Ω–æ –º–µ—Å—Ç–æ –¥–≤–∞–∂–¥—ã
- –ù–∏–∑–∫–∞—è latency –∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞
- –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–∞

**–†–µ—à–µ–Ω–∏–µ: Optimistic Locking + Compensations**

```
–°–∏—Å—Ç–µ–º–∞: DynamoDB —Å conditional writes + SQS –¥–ª—è compensations

–ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è:
  1. –ß–∏—Ç–∞–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ—Å—Ç–∞:
     {seat: "A1", status: "available", version: 5}

  2. Conditional update:
     UPDATE seats
     SET status="reserved", user_id=123, version=6
     WHERE seat="A1" AND status="available" AND version=5

  3. –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ ‚Üí —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ ‚úì
     –ï—Å–ª–∏ failed ‚Üí –º–µ—Å—Ç–æ —É–∂–µ –∑–∞–Ω—è—Ç–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞

  4. –ß–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç (–µ—Å–ª–∏ –Ω–µ –æ–ø–ª–∞—Ç–∏–ª):
     Compensating transaction –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º–µ—Å—Ç–æ
```

**–ü–æ—á–µ–º—É –Ω–µ —Å—Ç—Ä–æ–≥–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞?**
- –í—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –º–æ–∂–µ—Ç "–∑–∞–≤–∏—Å–Ω—É—Ç—å" –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –æ—Ç–≤–∞–ª–∏–ª—Å—è
- –ù—É–∂–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ timeout –∏ cleanup
- Optimistic locking –ø—Ä–æ—â–µ –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ö–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ù—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –∫–æ—Ä–∑–∏–Ω—ã
- –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–†–µ—à–µ–Ω–∏–µ: Strong Eventual Consistency (OR-Set CRDT)**

```
–°–∏—Å—Ç–µ–º–∞: Riak —Å OR-Set data type

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞:
  add("product-42")
  ‚Üí –†–µ–ø–ª–∏–∫–∞ EU: {"product-42"#unique_id_1}

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä —Å –Ω–æ—É—Ç–±—É–∫–∞:
  add("product-99")
  ‚Üí –†–µ–ø–ª–∏–∫–∞ US: {"product-99"#unique_id_2}

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
  Merge ‚Üí {"product-42"#1, "product-99"#2}
  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –æ–±–∞ —Ç–æ–≤–∞—Ä–∞ ‚úì

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—è–µ—Ç product-42:
  remove("product-42")
  ‚Üí Tombstone –¥–ª—è #unique_id_1

–ò—Ç–æ–≥: {"product-99"#2}

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
  - –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ—Ñ–ª–∞–π–Ω
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ merge
  - –ù–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–π
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å, –Ω–æ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ç–≤–æ–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **–ù–µ—Ç —Å–µ—Ä–µ–±—Ä—è–Ω–æ–π –ø—É–ª–∏**: –ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å ‚Äî —ç—Ç–æ trade-off –º–µ–∂–¥—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å—é, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é.

2. **–ù–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã**: –ò—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç–µ–π —Å–∏—Å—Ç–µ–º—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π.

3. **CAP —Ç–µ–æ—Ä–µ–º–∞ —Ä–µ–∞–ª—å–Ω–∞**: –í —É—Å–ª–æ–≤–∏—è—Ö network partition –Ω—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–∂–¥—É Consistency –∏ Availability.

4. **–ü–æ–Ω–∏–º–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ**: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –±–∞–≥–æ–≤ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Å–≤—è–∑–∞–Ω–æ —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è–º–∏ –æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏.

5. **Session guarantees —Å–ø–∞—Å–∞—é—Ç UX**: –î–∞–∂–µ —Å eventual consistency –º–æ–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Ö–æ—Ä–æ—à–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç —á–µ—Ä–µ–∑ read-your-writes –∏ monotonic reads.

6. **CRDTs ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**: –î–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö strong eventual consistency —á–µ—Ä–µ–∑ CRDTs —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ.

### –û–±—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã–±–æ—Ä–∞

```
START

–ï—Å—Ç—å —Å—Ç—Ä–æ–≥–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–∞–Ω–Ω—ã—Ö?
‚îú‚îÄ –î–ê ‚Üí –ù—É–∂–Ω–∞ —Å–∏–ª—å–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å
‚îÇ        ‚îÇ
‚îÇ        –ù—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π?
‚îÇ        ‚îú‚îÄ –î–ê ‚Üí Serializability (PostgreSQL, MySQL)
‚îÇ        ‚îî‚îÄ –ù–ï–¢ ‚Üí Linearizability (etcd, Consul, Zookeeper)
‚îÇ
‚îî‚îÄ –ù–ï–¢ ‚Üí –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–∞–±—É—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å
         ‚îÇ
         –û–ø–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—ã?
         ‚îú‚îÄ –î–ê ‚Üí Strong Eventual Consistency (CRDTs)
         ‚îÇ        –ü—Ä–∏–º–µ—Ä—ã: —Å—á—ë—Ç—á–∏–∫–∏, sets, –∫–æ—Ä–∑–∏–Ω—ã
         ‚îÇ
         ‚îî‚îÄ –ù–ï–¢ ‚Üí –í–∞–∂–µ–Ω –ø—Ä–∏—á–∏–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫?
                  ‚îú‚îÄ –î–ê ‚Üí Causal Consistency
                  ‚îÇ        –ü—Ä–∏–º–µ—Ä—ã: —á–∞—Ç—ã, –ª–µ–Ω—Ç—ã –Ω–æ–≤–æ—Å—Ç–µ–π
                  ‚îÇ
                  ‚îî‚îÄ –ù–ï–¢ ‚Üí Eventual Consistency
                           –ü—Ä–∏–º–µ—Ä—ã: –∫–µ—à–∏, –ª–æ–≥–∏, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
```

### –ß—Ç–æ –¥–∞–ª—å—à–µ?

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å –º–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏:

1. **–ò–∑—É—á–∏ —Å–≤–æ—é —Ç–µ–∫—É—â—É—é —Å–∏—Å—Ç–µ–º—É**: –ö–∞–∫—É—é –º–æ–¥–µ–ª—å –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç? –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ —ç—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º?

2. **–ß–∏—Ç–∞–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**: –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∞–π consistency guarantees –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å.

3. **–¢–µ—Å—Ç–∏—Ä—É–π –Ω–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã**: –ü–∏—à–∏ —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–∏–º—É–ª–∏—Ä—É—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, network partitions, clock skew.

4. **–ú–æ–Ω–∏—Ç–æ—Ä—å –≤ production**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–π replication lag, clock skew, conflict resolution events.

5. **–ü—Ä–æ–µ–∫—Ç–∏—Ä—É–π —Å –∑–∞–ø–∞—Å–æ–º**: –î–∞–∂–µ –µ—Å–ª–∏ —Å–µ–π—á–∞—Å –æ–¥–Ω–∞ —Ä–µ–ø–ª–∏–∫–∞, –ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π –∫–∞–∫ –±—É–¥—Ç–æ –∏—Ö —Ç—Ä–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö.

–£–¥–∞—á–∏ –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –Ω–∞–¥—ë–∂–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º! üöÄ
